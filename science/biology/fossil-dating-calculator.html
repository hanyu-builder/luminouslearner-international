<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fossil Dating Calculator - LuminousLearner International</title>
    
    <!-- React & Tailwind -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Recharts -->
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>
    <script src="https://unpkg.com/recharts@2.12.7/umd/Recharts.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #e2e8f0; margin: 0; overflow: hidden; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Custom Slider */
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%; 
            background: #38bdf8; cursor: pointer; margin-top: -6px; 
            box-shadow: 0 0 8px rgba(56, 189, 248, 0.5);
            border: 2px solid white;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px;
        }

        /* Scanner Animation */
        .scanner-line {
            animation: scan 2s ease-in-out infinite;
        }
        @keyframes scan {
            0% { transform: translateY(0%); opacity: 0; }
            5% { opacity: 1; }
            95% { opacity: 1; }
            100% { transform: translateY(100%); opacity: 0; }
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;
        const { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, ReferenceLine, Label } = window.Recharts;

        const Icon = ({ name, className = "", size = 20 }) => {
            const [svgHtml, setSvgHtml] = useState('');
            useEffect(() => {
                if (window.lucide && window.lucide.icons) {
                    const pascalName = name.split('-').map(part => part.charAt(0).toUpperCase() + part.slice(1)).join('');
                    const iconData = window.lucide.icons[pascalName];
                    if (iconData && typeof window.lucide.createElement === 'function') {
                        const svgElement = window.lucide.createElement(iconData);
                        svgElement.setAttribute('class', className);
                        svgElement.setAttribute('width', size);
                        svgElement.setAttribute('height', size);
                        setSvgHtml(svgElement.outerHTML);
                    }
                }
            }, [name, className, size]);
            if (!svgHtml) return <span className={className} style={{ width: size, height: size, display: 'inline-block' }}></span>;
            return <span dangerouslySetInnerHTML={{ __html: svgHtml }} className="flex items-center justify-center" />;
        };

        // --- DATA ---
        const HALF_LIFE = 5730; // Carbon-14 half-life in years
        const DECAY_CONSTANT = Math.log(2) / HALF_LIFE;

        const FOSSILS = [
            { id: 'mammoth', name: 'Woolly Mammoth Tusk', c14: 25, year: 11460, desc: 'Extinct during the last Ice Age.' },
            { id: 'neanderthal', name: 'Neanderthal Bone', c14: 1.5, year: 34000, desc: 'Our closest extinct human relative.' }, // Approx
            { id: 'mummy', name: 'Egyptian Mummy', c14: 65, year: 3500, desc: 'Preserved remains from ancient Egypt.' },
            { id: 'tree', name: 'Ancient Redwood', c14: 88, year: 1000, desc: 'Tree ring dating confirms this age.' },
            { id: 'otzi', name: 'Ã–tzi the Iceman', c14: 53, year: 5300, desc: 'Found in the Alps, lived around 3300 BCE.' }
        ];

        // --- MAIN APP ---
        const App = () => {
            const [mode, setMode] = useState('calculator'); // calculator, scanner
            const [percentage, setPercentage] = useState(100); // 0-100%
            const [selectedFossil, setSelectedFossil] = useState(null);
            const [isScanning, setIsScanning] = useState(false);

            // Derived Values
            const years = useMemo(() => {
                if (percentage >= 100) return 0;
                if (percentage <= 0) return '> 50000'; // Carbon dating limit
                const t = -Math.log(percentage / 100) / DECAY_CONSTANT;
                return Math.round(t);
            }, [percentage]);

            const halfLivesPassed = typeof years === 'number' ? years / HALF_LIFE : 10;

            // Chart Data Generation
            const chartData = useMemo(() => {
                const data = [];
                // Plot up to 50,000 years (approx limit)
                for (let y = 0; y <= 40000; y += 1000) {
                    const remaining = 100 * Math.exp(-DECAY_CONSTANT * y);
                    data.push({ year: y, percentage: remaining });
                }
                return data;
            }, []);

            // Scanner Logic
            const startScan = (fossil) => {
                setSelectedFossil(fossil);
                setIsScanning(true);
                setMode('scanner');
                
                // Animation effect
                setTimeout(() => {
                    setIsScanning(false);
                    setPercentage(fossil.c14);
                }, 2000);
            };

            return (
                <div className="min-h-screen bg-[#0F172A] text-white flex flex-col md:flex-row overflow-hidden">
                    
                    {/* Sidebar */}
                    <div className="w-full md:w-80 bg-slate-900 border-r border-slate-800 flex flex-col z-10 shadow-xl h-screen shrink-0">
                        <div className="p-6 border-b border-slate-800">
                            <h1 className="text-xl font-bold flex items-center gap-2">
                                <Icon name="clock" className="text-blue-400" /> Carbon Dating
                            </h1>
                            <p className="text-xs text-slate-400 mt-1">Radiometric Dating (C-14)</p>
                        </div>

                        <div className="p-6 space-y-8 flex-1 overflow-y-auto custom-scrollbar">
                            
                            {/* Sample Selector */}
                            <div className="space-y-3">
                                <label className="text-xs font-bold text-slate-500 uppercase tracking-widest px-1">Sample Database</label>
                                <div className="grid grid-cols-1 gap-2">
                                    {FOSSILS.map(f => (
                                        <button 
                                            key={f.id}
                                            onClick={() => startScan(f)}
                                            className={`w-full text-left p-3 rounded-xl border transition-all flex items-center justify-between group
                                                ${selectedFossil?.id === f.id ? 'bg-slate-800 border-blue-500 text-white shadow-lg' : 'bg-slate-900/50 border-slate-700 text-slate-400 hover:bg-slate-800'}
                                            `}
                                        >
                                            <div className="flex items-center gap-3">
                                                <div className="p-2 bg-slate-800 rounded-lg text-slate-300 group-hover:text-white">
                                                    <Icon name={f.id === 'tree' ? 'tree-deciduous' : f.id === 'mammoth' ? 'bone' : f.id === 'mummy' ? 'package' : 'user'} size={18}/>
                                                </div>
                                                <div>
                                                    <div className="font-bold text-sm">{f.name}</div>
                                                    <div className="text-[10px] opacity-70 truncate w-32">{f.desc}</div>
                                                </div>
                                            </div>
                                            <Icon name="chevron-right" size={16} className="opacity-50"/>
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {/* Calculator Mode Toggle */}
                            <div className="pt-4 border-t border-slate-800">
                                <button 
                                    onClick={() => { setMode('calculator'); setSelectedFossil(null); setPercentage(100); }}
                                    className={`w-full py-3 rounded-xl font-bold flex items-center justify-center gap-2 transition-all border
                                        ${mode === 'calculator' ? 'bg-emerald-600 border-emerald-500 text-white' : 'bg-slate-800 border-slate-600 text-slate-300 hover:text-white'}
                                    `}
                                >
                                    <Icon name="calculator" size={18}/> Manual Calculator
                                </button>
                            </div>
                            
                            {/* Info */}
                            <div className="bg-slate-800/50 p-4 rounded-xl border border-slate-700 text-xs text-slate-300 space-y-2">
                                <div className="font-bold text-slate-400 uppercase mb-1">Key Facts</div>
                                <p><strong>Carbon-14 Half-life:</strong> 5,730 years</p>
                                <p>Living organisms constantly absorb C-14. After death, C-14 decays into Nitrogen-14, while C-12 remains stable.</p>
                                <p>By measuring the ratio of C-14 to C-12, we can estimate the time since death.</p>
                            </div>

                        </div>
                    </div>

                    {/* Main Stage */}
                    <div className="flex-1 bg-[#020617] relative flex flex-col p-8 overflow-y-auto">
                        
                        <div className="flex flex-col items-center w-full max-w-5xl mx-auto gap-8 h-full">

                            {/* Top Panel: Visualization / Scanner */}
                            <div className="w-full flex-1 min-h-[300px] bg-slate-900 rounded-3xl border border-slate-800 shadow-2xl relative overflow-hidden flex flex-col items-center justify-center p-8">
                                
                                {isScanning ? (
                                    <div className="flex flex-col items-center gap-4 animate-in fade-in">
                                        <div className="relative w-48 h-48 bg-slate-800 rounded-2xl border-4 border-blue-500/30 overflow-hidden flex items-center justify-center shadow-[0_0_50px_rgba(59,130,246,0.2)]">
                                            <Icon name="scan" size={64} className="text-blue-400 opacity-50"/>
                                            <div className="absolute inset-0 bg-gradient-to-b from-transparent via-blue-500/20 to-transparent h-1/2 scanner-line"></div>
                                        </div>
                                        <div className="text-blue-400 font-mono font-bold animate-pulse">Analyzing Isotope Ratio...</div>
                                    </div>
                                ) : (
                                    <div className="flex flex-col md:flex-row w-full h-full gap-8">
                                            
                                        {/* Left: Isotope Visual */}
                                        <div className="flex-1 flex flex-col items-center justify-center relative">
                                            {/* Atom Representation */}
                                            <div className="relative w-64 h-64">
                                                {/* Stable C-12 (Background) */}
                                                <div className="absolute inset-0 rounded-full border-4 border-slate-700 opacity-20 animate-[spin_20s_linear_infinite]"></div>
                                                <div className="absolute inset-4 rounded-full border-2 border-slate-700 opacity-20 animate-[spin_15s_linear_infinite_reverse]"></div>
                                                
                                                {/* Decaying C-14 */}
                                                <div className="absolute inset-0 flex items-center justify-center">
                                                    <div className="w-32 h-32 rounded-full bg-slate-800 relative overflow-hidden border border-slate-600">
                                                        <div 
                                                            className="absolute bottom-0 w-full bg-gradient-to-t from-blue-600 to-blue-400 transition-all duration-500"
                                                            style={{ height: `${percentage}%` }}
                                                        ></div>
                                                        <div className="absolute inset-0 flex items-center justify-center font-black text-2xl text-white drop-shadow-md">
                                                            C-14
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                {/* Labels - Moved to TOP */}
                                                <div className="absolute top-10 left-1/2 -translate-x-1/2 text-xs font-bold text-blue-400 bg-slate-900/90 px-3 py-1.5 rounded-full border border-blue-500/50 z-10 shadow-lg whitespace-nowrap">
                                                    {percentage.toFixed(1)}% Remaining
                                                </div>
                                            </div>
                                            
                                            <div className="mt-6 text-center">
                                                <div className="text-sm text-slate-400 uppercase font-bold mb-1">Estimated Age</div>
                                                <div className="text-4xl font-mono font-black text-white tabular-nums">
                                                    {typeof years === 'number' ? years.toLocaleString() : years} <span className="text-base font-normal text-slate-500">years</span>
                                                </div>
                                                <div className="text-xs text-emerald-500 mt-2 font-mono bg-emerald-900/20 px-3 py-1 rounded inline-block">
                                                    {halfLivesPassed.toFixed(2)} Half-lives passed
                                                </div>
                                            </div>
                                        </div>

                                        {/* Right: Info Panel (If Fossil Selected) */}
                                        {selectedFossil && (
                                            <div className="w-64 bg-slate-800/50 border-l border-slate-700 p-6 flex flex-col justify-center animate-in slide-in-from-right">
                                                <div className="text-xs font-bold text-blue-400 uppercase mb-2">Sample Analysis</div>
                                                <h3 className="text-xl font-bold text-white mb-2">{selectedFossil.name}</h3>
                                                <p className="text-sm text-slate-300 leading-relaxed mb-4">{selectedFossil.desc}</p>
                                                
                                                <div className="bg-slate-900 p-3 rounded-lg text-xs space-y-2 border border-slate-700">
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-500">C-14 Level:</span>
                                                        <span className="text-white font-mono">{selectedFossil.c14}%</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-500">Result:</span>
                                                        <span className="text-emerald-400 font-bold">~{selectedFossil.year} BP</span>
                                                    </div>
                                                </div>
                                            </div>
                                        )}

                                    </div>
                                )}
                            </div>

                            {/* Bottom Panel: Graph & Controls */}
                            <div className="w-full h-64 flex gap-8">
                                
                                {/* Decay Curve Graph */}
                                <div className="flex-1 bg-slate-900 rounded-2xl border border-slate-800 p-4 relative">
                                    <div className="text-xs font-bold text-slate-500 uppercase mb-2 absolute top-4 left-4 z-10">Radioactive Decay Curve</div>
                                    <ResponsiveContainer width="100%" height="100%">
                                        <AreaChart data={chartData} margin={{ top: 20, right: 20, bottom: 0, left: 0 }}>
                                            <defs>
                                                <linearGradient id="colorC14" x1="0" y1="0" x2="0" y2="1">
                                                    <stop offset="5%" stopColor="#3b82f6" stopOpacity={0.3}/>
                                                    <stop offset="95%" stopColor="#3b82f6" stopOpacity={0}/>
                                                </linearGradient>
                                            </defs>
                                            <CartesianGrid strokeDasharray="3 3" stroke="#334155" />
                                            <XAxis 
                                                dataKey="year" 
                                                stroke="#64748b" 
                                                fontSize={10} 
                                                tickFormatter={(val) => `${val/1000}k`}
                                                label={{ value: 'Years', position: 'insideBottom', offset: -5, fill: '#64748b', fontSize: 10 }}
                                            />
                                            <YAxis 
                                                stroke="#64748b" 
                                                fontSize={10} 
                                                unit="%" 
                                                width={30}
                                            />
                                            <Tooltip 
                                                contentStyle={{ backgroundColor: '#1e293b', borderColor: '#475569', fontSize: '12px' }}
                                                itemStyle={{ color: '#fff' }}
                                                formatter={(val) => `${val.toFixed(1)}%`}
                                                labelFormatter={(val) => `${val} years`}
                                            />
                                            <Area type="monotone" dataKey="percentage" stroke="#3b82f6" fill="url(#colorC14)" strokeWidth={2} />
                                            
                                            {/* Current Position Line */}
                                            {typeof years === 'number' && (
                                                <ReferenceLine x={years} stroke="#ef4444" strokeDasharray="3 3" label={{ value: 'Current', position: 'top', fill: '#ef4444', fontSize: 10 }} />
                                            )}
                                            
                                            {/* Half-life Markers */}
                                            <ReferenceLine x={5730} stroke="#10b981" strokeDasharray="3 3" />
                                            <ReferenceLine x={11460} stroke="#10b981" strokeDasharray="3 3" />
                                        </AreaChart>
                                    </ResponsiveContainer>
                                </div>

                                {/* Manual Slider Control (Only in Calculator Mode) */}
                                {mode === 'calculator' && (
                                    <div className="w-64 bg-slate-900 rounded-2xl border border-slate-800 p-6 flex flex-col justify-center gap-4 shrink-0">
                                        <div className="text-xs font-bold text-slate-500 uppercase flex items-center gap-2">
                                            <Icon name="sliders" size={14}/> Adjust Remaining C-14
                                        </div>
                                        
                                        <div className="relative h-10 flex items-center">
                                            <input 
                                                type="range" 
                                                min="0.1" 
                                                max="100" 
                                                step="0.1" 
                                                value={percentage} 
                                                onChange={(e) => setPercentage(parseFloat(e.target.value))}
                                                className="z-20 relative w-full"
                                            />
                                        </div>
                                        
                                        <div className="flex justify-between items-end bg-slate-800 p-3 rounded-lg border border-slate-700">
                                            <div className="text-xs text-slate-400">Remaining</div>
                                            <div className="text-2xl font-mono font-black text-blue-400">{percentage.toFixed(1)}%</div>
                                        </div>
                                        
                                        <div className="text-[10px] text-slate-500 text-center">
                                            Drag slider to simulate decay over time
                                        </div>
                                    </div>
                                )}

                            </div>

                        </div>

                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
