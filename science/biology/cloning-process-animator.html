<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloning Process Animator | LuminousLearner</title>
    
    <!-- React & Tailwind -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Framer Motion -->
    <script src="https://unpkg.com/framer-motion@10.12.16/dist/framer-motion.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1e293b', 
                            950: '#0F172A', // LuminousLearner Dark Mode Background
                        },
                        emerald: {
                            450: '#10b981',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #e2e8f0; margin: 0; overflow: hidden; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Electric Shock Animation */
        .zap { animation: zap-anim 0.2s linear 3; }
        @keyframes zap-anim {
            0% { opacity: 0; filter: brightness(1); }
            50% { opacity: 1; filter: brightness(2) drop-shadow(0 0 10px yellow); }
            100% { opacity: 0; filter: brightness(1); }
        }

        /* Cell Pulse */
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background-color: #334155; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background-color: #475569; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { motion, AnimatePresence } = window.Motion;

        const Icon = ({ name, className = "", size = 20 }) => {
            const [svgHtml, setSvgHtml] = useState('');
            useEffect(() => {
                if (window.lucide && window.lucide.icons) {
                    const pascalName = name.split('-').map(part => part.charAt(0).toUpperCase() + part.slice(1)).join('');
                    const iconData = window.lucide.icons[pascalName];
                    if (iconData && typeof window.lucide.createElement === 'function') {
                        const svgElement = window.lucide.createElement(iconData);
                        svgElement.setAttribute('class', className);
                        svgElement.setAttribute('width', size);
                        svgElement.setAttribute('height', size);
                        setSvgHtml(svgElement.outerHTML);
                    }
                }
            }, [name, className, size]);
            if (!svgHtml) return <span className={className} style={{ width: size, height: size, display: 'inline-block' }}></span>;
            return <span dangerouslySetInnerHTML={{ __html: svgHtml }} className="flex items-center justify-center" />;
        };

        // --- DATA ---
        const STEPS = [
            {
                id: 0,
                title: "Collection",
                desc: "Get a Somatic Cell from a White-faced Sheep and an Egg Cell from a Black-faced Sheep.",
                action: "Collect Cells"
            },
            {
                id: 1,
                title: "Enucleation",
                desc: "Remove the nucleus (genetic material) from the Egg Cell using a micropipette.",
                action: "Remove Nucleus"
            },
            {
                id: 2,
                title: "Fusion",
                desc: "Fuse the Somatic Cell (with nucleus) into the empty Egg Cell using electric shock.",
                action: "Apply Electric Shock"
            },
            {
                id: 3,
                title: "Division",
                desc: "The fused cell is stimulated to divide and develop into an embryo.",
                action: "Wait for Division"
            },
            {
                id: 4,
                title: "Implantation",
                desc: "Implant the embryo into the uterus of a Surrogate Mother (Black-faced).",
                action: "Implant Embryo"
            },
            {
                id: 5,
                title: "Birth",
                desc: "Dolly is born! She has a white face because her DNA came from the White-faced sheep.",
                action: "Finish"
            }
        ];

        // --- COMPONENTS ---

        // Simple Sheep Visual
        const Sheep = ({ faceColor, bodyColor = "#f1f5f9", label, size = 60, isBaby = false }) => (
            <div className="flex flex-col items-center gap-2">
                <div className="relative">
                    {/* Body (Wool) */}
                    <div className="rounded-full bg-slate-200 border-2 border-slate-300 relative" 
                         style={{ width: size, height: size * 0.7 }}>
                         {/* Fluff bumps could be added here */}
                    </div>
                    {/* Head */}
                    <div className={`absolute -left-2 top-0 w-1/2 h-2/3 rounded-full border-2 border-slate-800 flex items-center justify-center`}
                         style={{ backgroundColor: faceColor }}>
                         {/* Eyes */}
                         <div className="flex gap-1">
                            <div className="w-1 h-1 bg-white rounded-full"></div>
                            <div className="w-1 h-1 bg-white rounded-full"></div>
                         </div>
                         {/* Ears */}
                         <div className="absolute -top-1 -left-1 w-3 h-1 bg-slate-800 rounded rotate-[-30deg]"></div>
                         <div className="absolute -top-1 -right-1 w-3 h-1 bg-slate-800 rounded rotate-[30deg]"></div>
                    </div>
                    {/* Legs */}
                    <div className="absolute bottom-[-10px] left-2 w-2 h-4 bg-slate-800"></div>
                    <div className="absolute bottom-[-10px] right-2 w-2 h-4 bg-slate-800"></div>
                </div>
                {label && <div className="text-[10px] font-bold text-slate-400 bg-slate-900 px-2 rounded">{label}</div>}
            </div>
        );

        // Cell Visual
        const Cell = ({ type, hasNucleus, nucleusColor, scale = 1, isFused = false, label }) => {
            // type: 'somatic' (square-ish), 'egg' (round), 'embryo' (cluster)
            
            return (
                <div className="flex flex-col items-center gap-2" style={{ transform: `scale(${scale})` }}>
                    <div className={`relative flex items-center justify-center border-4 transition-all duration-500
                        ${type === 'somatic' ? 'w-20 h-20 rounded-xl bg-pink-100 border-pink-300' : 'w-24 h-24 rounded-full bg-yellow-100 border-yellow-300'}
                    `}>
                        {/* Cytoplasm */}
                        <div className="absolute inset-0 opacity-20 bg-current rounded-[inherit]"></div>
                        
                        {/* Nucleus */}
                        <AnimatePresence>
                            {hasNucleus && (
                                <motion.div 
                                    initial={{ scale: 0 }} 
                                    animate={{ scale: 1 }} 
                                    exit={{ scale: 0, opacity: 0 }}
                                    className="w-10 h-10 rounded-full border-2 border-slate-700 flex items-center justify-center text-[8px] font-bold shadow-inner z-10"
                                    style={{ backgroundColor: nucleusColor }}
                                >
                                    2n
                                </motion.div>
                            )}
                        </AnimatePresence>

                        {/* Fused Indicator */}
                        {isFused && <div className="absolute inset-0 border-4 border-blue-400 rounded-full animate-pulse opacity-50"></div>}
                    </div>
                    {label && <div className="text-xs font-bold text-slate-500">{label}</div>}
                </div>
            );
        };

        // Microscope Scene
        const MicroscopeScene = ({ step, isZapping }) => {
            return (
                <div className="w-full h-full relative bg-black rounded-full overflow-hidden border-8 border-slate-700 shadow-inner flex items-center justify-center">
                    
                    {/* Viewport Overlay (Vignette) */}
                    <div className="absolute inset-0 bg-radial-gradient pointer-events-none z-20" 
                         style={{ background: 'radial-gradient(circle, transparent 50%, black 100%)' }}></div>
                    
                    {/* Grid for scale */}
                    <div className="absolute inset-0 opacity-20 pointer-events-none" 
                         style={{ backgroundImage: 'linear-gradient(#333 1px, transparent 1px), linear-gradient(90deg, #333 1px, transparent 1px)', backgroundSize: '40px 40px' }}>
                    </div>

                    <div className="relative z-10 flex items-center justify-center gap-12">
                        
                        {/* Step 0: Collection */}
                        {step === 0 && (
                            <>
                                <motion.div initial={{ x: -100, opacity: 0 }} animate={{ x: 0, opacity: 1 }}>
                                    <Cell type="somatic" hasNucleus={true} nucleusColor="#ffffff" label="Mammary Cell (Donor A)" />
                                </motion.div>
                                <motion.div initial={{ x: 100, opacity: 0 }} animate={{ x: 0, opacity: 1 }}>
                                    <Cell type="egg" hasNucleus={true} nucleusColor="#000000" label="Egg Cell (Donor B)" />
                                </motion.div>
                            </>
                        )}

                        {/* Step 1: Enucleation */}
                        {step === 1 && (
                            <div className="relative">
                                <Cell type="egg" hasNucleus={false} nucleusColor="#000000" label="Enucleated Egg" />
                                {/* Pipette Animation removing nucleus */}
                                <motion.div 
                                    className="absolute -top-20 left-1/2 -translate-x-1/2 w-4 h-32 bg-slate-400 border border-slate-200 rounded-b-full flex flex-col items-center justify-end overflow-hidden"
                                    initial={{ y: -50 }}
                                    animate={{ y: 20 }}
                                    transition={{ duration: 2, repeat: Infinity, repeatType: "reverse" }}
                                >
                                    <div className="w-3 h-3 rounded-full bg-black mb-2"></div>
                                </motion.div>
                                <div className="absolute top-2 right-[-100px] text-xs text-red-400">Removing Nucleus B...</div>
                            </div>
                        )}

                        {/* Step 2: Fusion */}
                        {step === 2 && (
                            <div className="relative flex items-center">
                                {/* The Empty Egg */}
                                <Cell type="egg" hasNucleus={false} nucleusColor="#000000" />
                                {/* The Somatic Cell entering */}
                                <motion.div 
                                    className="absolute"
                                    initial={{ x: -150, opacity: 1 }}
                                    animate={{ x: 0, opacity: 0 }} // Merges in
                                    transition={{ duration: 2 }}
                                >
                                    <div className="w-16 h-16 rounded-full bg-pink-200 border-2 border-pink-400 flex items-center justify-center">
                                        <div className="w-8 h-8 bg-white rounded-full border border-slate-500">2n</div>
                                    </div>
                                </motion.div>
                                {/* Resulting Fused Cell */}
                                <motion.div 
                                    className="absolute inset-0 flex items-center justify-center"
                                    initial={{ opacity: 0 }}
                                    animate={{ opacity: 1 }}
                                    transition={{ delay: 2 }}
                                >
                                    <Cell type="egg" hasNucleus={true} nucleusColor="#ffffff" isFused={true} label="Fused Cell (2n)" />
                                </motion.div>
                                
                                {/* Electric Shock Overlay */}
                                {isZapping && (
                                    <div className="absolute inset-0 bg-yellow-400/50 zap z-50 mix-blend-screen"></div>
                                )}
                                {isZapping && <div className="absolute -top-10 left-1/2 -translate-x-1/2 text-yellow-300 font-black text-xl zap">ZAP!</div>}
                            </div>
                        )}

                        {/* Step 3: Division */}
                        {step === 3 && (
                            <motion.div 
                                className="grid grid-cols-2 gap-1"
                                animate={{ rotate: 90 }}
                                transition={{ duration: 5, repeat: Infinity, ease: "linear" }}
                            >
                                <Cell type="egg" hasNucleus={true} nucleusColor="#ffffff" scale={0.6} />
                                <Cell type="egg" hasNucleus={true} nucleusColor="#ffffff" scale={0.6} />
                                <Cell type="egg" hasNucleus={true} nucleusColor="#ffffff" scale={0.6} />
                                <Cell type="egg" hasNucleus={true} nucleusColor="#ffffff" scale={0.6} />
                            </motion.div>
                        )}

                        {/* Step 4: Implantation */}
                        {step === 4 && (
                            <div className="flex items-center gap-8">
                                <div className="p-4 bg-red-900/20 rounded-xl border border-red-500/30 text-center">
                                    <div className="text-[10px] text-red-300 mb-2">Embryo</div>
                                    <div className="grid grid-cols-2 gap-0.5 w-12 h-12">
                                        <div className="bg-yellow-200 rounded-tl-lg"></div>
                                        <div className="bg-yellow-200 rounded-tr-lg"></div>
                                        <div className="bg-yellow-200 rounded-bl-lg"></div>
                                        <div className="bg-yellow-200 rounded-br-lg"></div>
                                    </div>
                                </div>
                                <Icon name="arrow-right" className="text-slate-500 animate-pulse"/>
                                <div className="opacity-50">
                                    <Sheep faceColor="#000000" label="Surrogate" />
                                </div>
                            </div>
                        )}

                        {/* Step 5: Birth */}
                        {step === 5 && (
                            <div className="flex flex-col items-center">
                                <motion.div 
                                    initial={{ scale: 0, rotate: -180 }} 
                                    animate={{ scale: 1, rotate: 0 }}
                                    transition={{ type: "spring", bounce: 0.5 }}
                                >
                                    <Sheep faceColor="#ffffff" size={80} label="Dolly" isBaby={true} />
                                </motion.div>
                                <div className="mt-4 text-center">
                                    <div className="text-emerald-400 font-bold">Success!</div>
                                    <div className="text-xs text-slate-400">Genetically identical to Donor A</div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // --- MAIN APP ---
        const App = () => {
            const [step, setStep] = useState(0);
            const [isZapping, setIsZapping] = useState(false);

            const currentStepData = STEPS[step];

            const handleNext = () => {
                if (step === 2) { // Fusion Step needs zap effect
                    setIsZapping(true);
                    setTimeout(() => {
                        setIsZapping(false);
                        setStep(prev => prev + 1);
                    }, 1000);
                } else {
                    setStep(prev => Math.min(prev + 1, STEPS.length - 1));
                }
            };

            const handlePrev = () => {
                setStep(prev => Math.max(0, prev - 1));
            };

            const handleReset = () => {
                setStep(0);
            };

            return (
                <div className="min-h-screen bg-[#0F172A] text-white flex flex-col md:flex-row overflow-hidden font-sans">
                    
                    {/* Sidebar */}
                    <div className="w-full md:w-96 bg-slate-900 border-r border-slate-800 flex flex-col z-10 shadow-xl h-screen shrink-0">
                        <div className="p-6 border-b border-slate-800">
                            <h1 className="text-xl font-bold flex items-center gap-2">
                                <Icon name="copy" className="text-pink-400" /> Cloning Lab
                            </h1>
                            <p className="text-xs text-slate-400 mt-1">SCNT: The Dolly Project</p>
                        </div>

                        <div className="p-6 flex-1 overflow-y-auto custom-scrollbar space-y-6">
                            
                            {/* Progress */}
                            <div className="space-y-2">
                                <div className="flex justify-between text-xs font-bold text-slate-500 uppercase">
                                    <span>Process</span>
                                    <span>Step {step + 1} / {STEPS.length}</span>
                                </div>
                                <div className="w-full h-2 bg-slate-800 rounded-full overflow-hidden">
                                    <div 
                                        className="h-full bg-pink-500 transition-all duration-500" 
                                        style={{ width: `${((step + 1) / STEPS.length) * 100}%` }}
                                    ></div>
                                </div>
                            </div>

                            {/* Cast of Characters (Legend) */}
                            <div className="bg-slate-800/50 p-4 rounded-xl border border-slate-700 space-y-4">
                                <div className="text-xs font-bold text-slate-400 uppercase">The Participants</div>
                                <div className="flex justify-between items-end">
                                    <Sheep faceColor="#ffffff" size={40} label="Donor A" />
                                    <div className="text-[10px] text-slate-500 mb-6">+</div>
                                    <Sheep faceColor="#000000" size={40} label="Donor B" />
                                    <div className="text-[10px] text-slate-500 mb-6">&rarr;</div>
                                    <Sheep faceColor="#000000" size={40} label="Surrogate" />
                                </div>
                                <div className="text-[10px] text-slate-400 text-center border-t border-slate-700 pt-2">
                                    White Face = Nucleus Donor<br/>Black Face = Egg Donor / Surrogate
                                </div>
                            </div>

                            {/* Instruction Card */}
                            <AnimatePresence mode='wait'>
                                <motion.div 
                                    key={step}
                                    initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -20 }}
                                    className="bg-slate-800 p-5 rounded-2xl border border-slate-700 shadow-lg"
                                >
                                    <div className="text-xs font-bold text-blue-400 uppercase mb-2">Current Step</div>
                                    <h2 className="text-xl font-black text-white mb-2">{currentStepData.title}</h2>
                                    <p className="text-sm text-slate-300 leading-relaxed">
                                        {currentStepData.desc}
                                    </p>
                                </motion.div>
                            </AnimatePresence>

                            {/* Controls */}
                            <div className="flex gap-3 pt-4 border-t border-slate-800">
                                <button onClick={handlePrev} disabled={step === 0} className="p-3 bg-slate-800 hover:bg-slate-700 rounded-xl text-slate-300 border border-slate-600 disabled:opacity-50 transition-all">
                                    <Icon name="chevron-left" />
                                </button>
                                {step < STEPS.length - 1 ? (
                                    <button 
                                        onClick={handleNext} 
                                        disabled={isZapping}
                                        className="flex-1 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2 transition-all active:scale-95 disabled:opacity-70"
                                    >
                                        {isZapping ? 'Fusing...' : currentStepData.action} <Icon name="arrow-right" size={18}/>
                                    </button>
                                ) : (
                                    <button onClick={handleReset} className="flex-1 py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl font-bold shadow-lg transition-all">
                                        Restart Process
                                    </button>
                                )}
                            </div>

                        </div>
                    </div>

                    {/* Main Stage */}
                    <div className="flex-1 bg-[#020617] relative flex flex-col p-6 overflow-hidden gap-6">
                        
                        <div className="flex-1 bg-slate-900 rounded-3xl border border-slate-800 shadow-xl relative overflow-hidden flex flex-col items-center justify-center p-8">
                            <div className="w-[500px] h-[500px] relative">
                                <MicroscopeScene step={step} isZapping={isZapping} />
                            </div>
                            
                            {/* Context Label */}
                            <div className="absolute top-6 left-6 bg-black/60 px-3 py-1.5 rounded-lg border border-white/10 text-xs font-mono text-slate-300">
                                View: Microscope (400x)
                            </div>
                        </div>

                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
