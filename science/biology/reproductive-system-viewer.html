<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reproductive System Viewer | LuminousLearner</title>
    
    <!-- React & Tailwind -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Framer Motion -->
    <script src="https://unpkg.com/framer-motion@10.12.16/dist/framer-motion.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1e293b', 
                            950: '#0F172A', // LuminousLearner Dark Mode Background
                        },
                        emerald: {
                            450: '#10b981',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #e2e8f0; margin: 0; overflow: hidden; }
        canvas { outline: none; }
        
        /* Interactive Parts */
        .organ-part { cursor: pointer; transition: all 0.3s ease; }
        .organ-part:hover { filter: brightness(1.2) drop-shadow(0 0 5px rgba(255,255,255,0.5)); }
        .organ-part.active { filter: brightness(1.3) drop-shadow(0 0 10px #f472b6); stroke: #f472b6; stroke-width: 2px; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background-color: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background-color: #475569; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { motion, AnimatePresence } = window.Motion;

        const Icon = ({ name, className = "", size = 20 }) => {
            const [svgHtml, setSvgHtml] = useState('');
            useEffect(() => {
                if (window.lucide && window.lucide.icons) {
                    const pascalName = name.split('-').map(part => part.charAt(0).toUpperCase() + part.slice(1)).join('');
                    const iconData = window.lucide.icons[pascalName];
                    if (iconData && typeof window.lucide.createElement === 'function') {
                        const svgElement = window.lucide.createElement(iconData);
                        svgElement.setAttribute('class', className);
                        svgElement.setAttribute('width', size);
                        svgElement.setAttribute('height', size);
                        setSvgHtml(svgElement.outerHTML);
                    }
                }
            }, [name, className, size]);
            if (!svgHtml) return <span className={className} style={{ width: size, height: size, display: 'inline-block' }}></span>;
            return <span dangerouslySetInnerHTML={{ __html: svgHtml }} className="flex items-center justify-center" />;
        };

        // --- DATA ---
        const SYSTEMS = {
            male: {
                id: 'male', name: 'Male System',
                parts: {
                    testis: { name: 'Testis', desc: 'Produces sperm (male gametes) and testosterone.', func: 'Gamete Production', color: '#60a5fa' },
                    epididymis: { name: 'Epididymis', desc: 'Stores sperm temporarily while they mature.', func: 'Storage', color: '#3b82f6' },
                    vas_deferens: { name: 'Sperm Duct', desc: 'Transports sperm from the epididymis to the urethra.', func: 'Transport', color: '#2563eb' },
                    prostate: { name: 'Prostate Gland', desc: 'Secretes fluid that nourishes and protects sperm.', func: 'Secretion', color: '#a855f7' },
                    urethra: { name: 'Urethra', desc: 'Tube that carries urine and semen out of the body.', func: 'Excretion/Ejaculation', color: '#ef4444' },
                    penis: { name: 'Penis', desc: 'Organ for transferring sperm to the female.', func: 'Copulation', color: '#fca5a5' }
                }
            },
            female: {
                id: 'female', name: 'Female System',
                parts: {
                    ovary: { name: 'Ovary', desc: 'Produces ova (eggs) and female hormones (estrogen, progesterone).', func: 'Gamete Production', color: '#f472b6' },
                    oviduct: { name: 'Oviduct', desc: 'Site of fertilisation. Transports egg to uterus.', func: 'Fertilisation Site', color: '#ec4899' },
                    uterus: { name: 'Uterus', desc: 'Site where the embryo implants and develops into a foetus.', func: 'Development', color: '#db2777' },
                    cervix: { name: 'Cervix', desc: 'Ring of muscle at the lower end of the uterus.', func: 'Support', color: '#be185d' },
                    vagina: { name: 'Vagina', desc: 'Birth canal and site of sperm deposition.', func: 'Copulation/Birth', color: '#9d174d' }
                }
            }
        };

        // --- 3D COMPONENT ---
        const ReproductiveScene3D = ({ systemType, onSelect }) => {
            const mountRef = useRef(null);
            const sceneRef = useRef(null);
            
            useEffect(() => {
                if (!mountRef.current) return;
                const container = mountRef.current;

                // Wait for layout - use ResizeObserver to handle initial 0 size
                let width = container.clientWidth || 100;
                let height = container.clientHeight || 100;

                try {
                    const scene = new THREE.Scene();
                    scene.background = new THREE.Color(0x020617); 
                    scene.fog = new THREE.FogExp2(0x020617, 0.02);
                    sceneRef.current = scene;

                    const camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000);
                    camera.position.set(0, 5, 25);

                    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                    renderer.setSize(width, height);
                    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                    
                    while(container.firstChild) container.removeChild(container.firstChild);
                    container.appendChild(renderer.domElement);

                    const controls = new THREE.OrbitControls(camera, renderer.domElement);
                    controls.enableDamping = true;
                    controls.autoRotate = true;
                    controls.autoRotateSpeed = 1.0;

                    // Lights
                    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                    scene.add(ambientLight);
                    const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
                    dirLight.position.set(10, 10, 10);
                    scene.add(dirLight);
                    const pointLight = new THREE.PointLight(0xffaa00, 0.3);
                    pointLight.position.set(-5, 5, 5);
                    scene.add(pointLight);

                    // --- BUILD MODELS ---
                    const group = new THREE.Group();
                    
                    const createMat = (color) => new THREE.MeshStandardMaterial({ 
                        color: color, 
                        roughness: 0.4, 
                        metalness: 0.1,
                        transparent: true,
                        opacity: 0.9,
                        side: THREE.DoubleSide
                    });

                    if (systemType === 'male') {
                        const data = SYSTEMS.male.parts;
                        
                        // 1. Testes (2)
                        const testisGeo = new THREE.SphereGeometry(1.5, 32, 32);
                        const testisMat = createMat(data.testis.color);
                        const t1 = new THREE.Mesh(testisGeo, testisMat);
                        t1.position.set(-2.5, -5, 0);
                        t1.scale.set(1, 1.3, 1); // Elongated sphere
                        t1.userData = { id: 'testis' };
                        group.add(t1);

                        const t2 = t1.clone();
                        t2.position.set(2.5, -5, 0);
                        t2.userData = { id: 'testis' };
                        group.add(t2);

                        // 2. Epididymis (Caps on testes)
                        const epiGeo = new THREE.SphereGeometry(0.8, 32, 32);
                        const epiMat = createMat(data.epididymis.color);
                        const e1 = new THREE.Mesh(epiGeo, epiMat);
                        e1.position.set(-2.8, -3.5, -0.5);
                        e1.scale.set(1, 2, 1); 
                        e1.rotation.z = 0.4;
                        e1.userData = { id: 'epididymis' };
                        group.add(e1);

                        const e2 = e1.clone();
                        e2.position.set(2.8, -3.5, -0.5);
                        e2.rotation.z = -0.4;
                        e2.userData = { id: 'epididymis' };
                        group.add(e2);

                        // 3. Vas Deferens (Simplified Tubes)
                        const vdMat = createMat(data.vas_deferens.color);
                        const vdGeo = new THREE.CylinderGeometry(0.25, 0.25, 8);
                        
                        // Left vertical
                        const vd1 = new THREE.Mesh(vdGeo, vdMat);
                        vd1.position.set(-3.5, 1, 0);
                        vd1.userData = { id: 'vas_deferens' };
                        group.add(vd1);

                        // Right vertical
                        const vd2 = new THREE.Mesh(vdGeo, vdMat);
                        vd2.position.set(3.5, 1, 0);
                        vd2.userData = { id: 'vas_deferens' };
                        group.add(vd2);

                        // Horizontal connectors
                        const vdJoinGeo = new THREE.CylinderGeometry(0.25, 0.25, 4);
                        const vdJoin1 = new THREE.Mesh(vdJoinGeo, vdMat);
                        vdJoin1.position.set(-1.8, 4.5, 0);
                        vdJoin1.rotation.z = Math.PI / 2.5;
                        vdJoin1.userData = { id: 'vas_deferens' };
                        group.add(vdJoin1);

                        const vdJoin2 = new THREE.Mesh(vdJoinGeo, vdMat);
                        vdJoin2.position.set(1.8, 4.5, 0);
                        vdJoin2.rotation.z = -Math.PI / 2.5;
                        vdJoin2.userData = { id: 'vas_deferens' };
                        group.add(vdJoin2);

                        // 4. Prostate (Center)
                        const prosGeo = new THREE.SphereGeometry(1.5, 32, 32);
                        const prosMat = createMat(data.prostate.color);
                        const prostate = new THREE.Mesh(prosGeo, prosMat);
                        prostate.position.set(0, 1, 0);
                        prostate.userData = { id: 'prostate' };
                        group.add(prostate);

                        // 5. Penis (Cylinder)
                        const penisGeo = new THREE.CylinderGeometry(1, 1, 6, 32);
                        const penisMat = createMat(data.penis.color);
                        const penis = new THREE.Mesh(penisGeo, penisMat);
                        penis.position.set(0, -3, 2);
                        penis.rotation.x = Math.PI / 6;
                        penis.userData = { id: 'penis' };
                        group.add(penis);

                        // 6. Urethra (Tip)
                        const urethraTip = new THREE.Mesh(new THREE.SphereGeometry(0.4), createMat(data.urethra.color));
                        urethraTip.position.set(0, -5.8, 3.6);
                        urethraTip.userData = { id: 'urethra' };
                        group.add(urethraTip);

                    } else { // Female
                        const data = SYSTEMS.female.parts;

                        // 1. Uterus
                        const uterusGeo = new THREE.ConeGeometry(2.5, 5, 32);
                        const uterusMat = createMat(data.uterus.color);
                        const uterus = new THREE.Mesh(uterusGeo, uterusMat);
                        uterus.position.set(0, 1, 0);
                        uterus.rotation.z = Math.PI; 
                        uterus.scale.set(1, 1, 0.6);
                        uterus.userData = { id: 'uterus' };
                        group.add(uterus);
                        
                        // 2. Ovaries
                        const ovaryGeo = new THREE.SphereGeometry(1.2, 32, 32);
                        const ovaryMat = createMat(data.ovary.color);
                        const o1 = new THREE.Mesh(ovaryGeo, ovaryMat);
                        o1.position.set(-4, 2, 0);
                        o1.scale.set(1, 1.5, 1);
                        o1.userData = { id: 'ovary' };
                        group.add(o1);

                        const o2 = o1.clone();
                        o2.position.set(4, 2, 0);
                        o2.userData = { id: 'ovary' };
                        group.add(o2);

                        // 3. Oviducts (Simplified Cylinders)
                        const odMat = createMat(data.oviduct.color);
                        const odGeo = new THREE.CylinderGeometry(0.3, 0.3, 4);
                        
                        const od1 = new THREE.Mesh(odGeo, odMat);
                        od1.position.set(-2.5, 3.5, 0);
                        od1.rotation.z = Math.PI / 3;
                        od1.userData = { id: 'oviduct' };
                        group.add(od1);
                        
                        const od2 = new THREE.Mesh(odGeo, odMat);
                        od2.position.set(2.5, 3.5, 0);
                        od2.rotation.z = -Math.PI / 3;
                        od2.userData = { id: 'oviduct' };
                        group.add(od2);

                        // 4. Cervix
                        const cervixGeo = new THREE.CylinderGeometry(1, 1, 1.5, 32);
                        const cervixMat = createMat(data.cervix.color);
                        const cervix = new THREE.Mesh(cervixGeo, cervixMat);
                        cervix.position.set(0, -2, 0);
                        cervix.userData = { id: 'cervix' };
                        group.add(cervix);

                        // 5. Vagina
                        const vagGeo = new THREE.CylinderGeometry(1.2, 1.2, 4, 32);
                        const vagMat = createMat(data.vagina.color);
                        const vagina = new THREE.Mesh(vagGeo, vagMat);
                        vagina.position.set(0, -4.5, 0);
                        vagina.userData = { id: 'vagina' };
                        group.add(vagina);
                    }

                    scene.add(group);

                    // Interaction
                    const raycaster = new THREE.Raycaster();
                    const mouse = new THREE.Vector2();
                    let hoveredObj = null;

                    const onMouseMove = (event) => {
                        event.preventDefault();
                        const rect = renderer.domElement.getBoundingClientRect();
                        mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                        mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

                        raycaster.setFromCamera(mouse, camera);
                        const intersects = raycaster.intersectObjects(group.children);

                        if (intersects.length > 0) {
                            const obj = intersects[0].object;
                            if (hoveredObj !== obj) {
                                if (hoveredObj) hoveredObj.material.emissive.setHex(0x000000);
                                hoveredObj = obj;
                                hoveredObj.material.emissive.setHex(0x444444);
                                document.body.style.cursor = 'pointer';
                            }
                        } else {
                            if (hoveredObj) {
                                hoveredObj.material.emissive.setHex(0x000000);
                                hoveredObj = null;
                            }
                            document.body.style.cursor = 'default';
                        }
                    };

                    const onClick = () => {
                        if (hoveredObj && hoveredObj.userData.id) {
                            onSelect(hoveredObj.userData.id);
                        }
                    };

                    renderer.domElement.addEventListener('mousemove', onMouseMove);
                    renderer.domElement.addEventListener('click', onClick);

                    // Animation Loop
                    let frameId;
                    const animate = () => {
                        frameId = requestAnimationFrame(animate);
                        controls.update();
                        renderer.render(scene, camera);
                    };
                    animate();

                    // Resize Observer
                    const resizeObserver = new ResizeObserver(() => {
                        if (container.clientWidth && container.clientHeight) {
                            const w = container.clientWidth;
                            const h = container.clientHeight;
                            camera.aspect = w / h;
                            camera.updateProjectionMatrix();
                            renderer.setSize(w, h);
                        }
                    });
                    resizeObserver.observe(container);

                    return () => {
                        cancelAnimationFrame(frameId);
                        resizeObserver.disconnect();
                        renderer.domElement.removeEventListener('mousemove', onMouseMove);
                        renderer.domElement.removeEventListener('click', onClick);
                        if (container && renderer.domElement) {
                            container.removeChild(renderer.domElement);
                        }
                        renderer.dispose();
                    };
                } catch (e) {
                    console.error("Three.js Error:", e);
                }
            }, [systemType]);

            return <div ref={mountRef} className="w-full h-full" />;
        };

        // --- 2D SVG COMPONENTS ---
        const MaleSystemSVG = ({ selected, onSelect }) => (
            <svg viewBox="0 0 400 500" className="w-full h-full drop-shadow-xl">
                <path d="M 150 50 Q 200 20 250 50 L 250 100 Q 200 130 150 100 Z" fill="#e2e8f0" stroke="#cbd5e1" />
                <path 
                    d="M 120 350 L 120 100 Q 120 50 200 120 L 200 200" 
                    fill="none" stroke="#2563eb" strokeWidth="6"
                    className={`organ-part ${selected === 'vas_deferens' ? 'active' : ''}`}
                    onClick={() => onSelect('vas_deferens')}
                />
                <circle 
                    cx="200" cy="220" r="25" 
                    fill="#d8b4fe" stroke="#a855f7" strokeWidth="2"
                    className={`organ-part ${selected === 'prostate' ? 'active' : ''}`}
                    onClick={() => onSelect('prostate')}
                />
                <path 
                    d="M 170 250 L 170 400 Q 200 430 230 400 L 230 250" 
                    fill="#fecaca" stroke="#fca5a5" strokeWidth="2"
                    className={`organ-part ${selected === 'penis' ? 'active' : ''}`}
                    onClick={() => onSelect('penis')}
                />
                <line 
                    x1="200" y1="245" x2="200" y2="415" 
                    stroke="#ef4444" strokeWidth="4" strokeDasharray="5,5"
                    className={`organ-part ${selected === 'urethra' ? 'active' : ''}`}
                    onClick={() => onSelect('urethra')}
                />
                <path d="M 100 350 Q 100 450 160 400" fill="#fee2e2" stroke="#fca5a5" strokeWidth="2" />
                <ellipse 
                    cx="130" cy="380" rx="20" ry="30" 
                    fill="#93c5fd" stroke="#60a5fa" strokeWidth="2"
                    className={`organ-part ${selected === 'testis' ? 'active' : ''}`}
                    onClick={() => onSelect('testis')}
                />
                <path 
                    d="M 110 360 Q 130 340 150 360 C 160 380 150 390 130 380" 
                    fill="#60a5fa" stroke="#3b82f6" strokeWidth="2"
                    className={`organ-part ${selected === 'epididymis' ? 'active' : ''}`}
                    onClick={() => onSelect('epididymis')}
                />
            </svg>
        );

        const FemaleSystemSVG = ({ selected, onSelect }) => (
            <svg viewBox="0 0 400 500" className="w-full h-full drop-shadow-xl">
                <path 
                    d="M 120 150 Q 50 100 50 150 Q 50 200 80 180" 
                    fill="none" stroke="#ec4899" strokeWidth="8"
                    className={`organ-part ${selected === 'oviduct' ? 'active' : ''}`}
                    onClick={() => onSelect('oviduct')}
                />
                <path 
                    d="M 280 150 Q 350 100 350 150 Q 350 200 320 180" 
                    fill="none" stroke="#ec4899" strokeWidth="8"
                    className={`organ-part ${selected === 'oviduct' ? 'active' : ''}`}
                    onClick={() => onSelect('oviduct')}
                />
                <ellipse 
                    cx="60" cy="180" rx="20" ry="15" 
                    fill="#fbcfe8" stroke="#f472b6" strokeWidth="2"
                    className={`organ-part ${selected === 'ovary' ? 'active' : ''}`}
                    onClick={() => onSelect('ovary')}
                />
                <ellipse 
                    cx="340" cy="180" rx="20" ry="15" 
                    fill="#fbcfe8" stroke="#f472b6" strokeWidth="2"
                    className={`organ-part ${selected === 'ovary' ? 'active' : ''}`}
                    onClick={() => onSelect('ovary')}
                />
                <path 
                    d="M 120 150 L 280 150 L 250 300 L 150 300 Z" 
                    fill="#fce7f3" stroke="#db2777" strokeWidth="3"
                    className={`organ-part ${selected === 'uterus' ? 'active' : ''}`}
                    onClick={() => onSelect('uterus')}
                />
                <rect 
                    x="170" y="300" width="60" height="30" rx="5" 
                    fill="#f9a8d4" stroke="#be185d" strokeWidth="2"
                    className={`organ-part ${selected === 'cervix' ? 'active' : ''}`}
                    onClick={() => onSelect('cervix')}
                />
                <path 
                    d="M 170 330 L 170 450 L 230 450 L 230 330 Z" 
                    fill="#fbcfe8" stroke="#9d174d" strokeWidth="2"
                    className={`organ-part ${selected === 'vagina' ? 'active' : ''}`}
                    onClick={() => onSelect('vagina')}
                />
            </svg>
        );

        // --- MAIN APP ---
        const App = () => {
            const [system, setSystem] = useState('female'); 
            const [viewMode, setViewMode] = useState('2d'); 
            const [selectedPart, setSelectedPart] = useState(null);

            const currentData = SYSTEMS[system];
            const currentPartInfo = selectedPart ? currentData.parts[selectedPart] : null;

            return (
                <div className="min-h-screen bg-[#0F172A] text-white flex flex-col md:flex-row overflow-hidden font-sans">
                    
                    {/* Sidebar */}
                    <div className="w-full md:w-80 bg-slate-900 border-r border-slate-800 flex flex-col z-10 shadow-xl h-screen shrink-0">
                        <div className="p-6 border-b border-slate-800">
                            <h1 className="text-xl font-bold flex items-center gap-2">
                                <Icon name="heart" className="text-pink-400" /> Reproductive
                            </h1>
                            <p className="text-xs text-slate-400 mt-1">System Viewer</p>
                        </div>

                        <div className="p-6 space-y-8 flex-1 overflow-y-auto custom-scrollbar">
                            
                            {/* System Switch */}
                            <div className="bg-slate-800 p-1 rounded-xl flex">
                                <button 
                                    onClick={() => { setSystem('male'); setSelectedPart(null); }}
                                    className={`flex-1 py-2 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 ${system === 'male' ? 'bg-blue-600 text-white shadow' : 'text-slate-400 hover:text-white'}`}
                                >
                                    Male
                                </button>
                                <button 
                                    onClick={() => { setSystem('female'); setSelectedPart(null); }}
                                    className={`flex-1 py-2 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 ${system === 'female' ? 'bg-pink-600 text-white shadow' : 'text-slate-400 hover:text-white'}`}
                                >
                                    Female
                                </button>
                            </div>

                            {/* View Mode Switch */}
                            <div className="flex gap-2">
                                <button 
                                    onClick={() => setViewMode('2d')}
                                    className={`flex-1 py-2 border rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 
                                        ${viewMode === '2d' ? 'bg-slate-700 border-slate-500 text-white' : 'border-slate-700 text-slate-400 hover:bg-slate-800'}`}
                                >
                                    <Icon name="file-text" size={16}/> 2D Diagram
                                </button>
                                <button 
                                    onClick={() => setViewMode('3d')}
                                    className={`flex-1 py-2 border rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 
                                        ${viewMode === '3d' ? 'bg-slate-700 border-slate-500 text-white' : 'border-slate-700 text-slate-400 hover:bg-slate-800'}`}
                                >
                                    <Icon name="box" size={16}/> 3D Structure
                                </button>
                            </div>

                            {/* Parts List */}
                            <div className="space-y-2">
                                <label className="text-xs font-bold text-slate-500 uppercase tracking-widest px-1">Structures</label>
                                <div className="grid grid-cols-1 gap-2">
                                    {Object.entries(currentData.parts).map(([key, info]) => (
                                        <button 
                                            key={key}
                                            onClick={() => setSelectedPart(key)}
                                            className={`w-full text-left p-3 rounded-xl border transition-all flex items-center justify-between group
                                                ${selectedPart === key 
                                                    ? `bg-slate-800 border-[${info.color}] text-white shadow-lg` 
                                                    : 'bg-slate-900/50 border-slate-700 text-slate-400 hover:bg-slate-800'}
                                            `}
                                            style={selectedPart === key ? { borderColor: info.color } : {}}
                                        >
                                            <span className="text-sm font-bold">{info.name.split(' (')[0]}</span>
                                            {selectedPart === key && <Icon name="chevron-right" size={16} className="text-white"/>}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {/* Info Panel */}
                            <AnimatePresence mode='wait'>
                                {currentPartInfo ? (
                                    <motion.div 
                                        key={selectedPart}
                                        initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -10 }}
                                        className="bg-slate-800 p-4 rounded-xl border border-slate-700 shadow-lg"
                                    >
                                        <h2 className="text-lg font-bold mb-2" style={{ color: currentPartInfo.color }}>{currentPartInfo.name}</h2>
                                        <div className="space-y-2 text-xs text-slate-300">
                                            <p>{currentPartInfo.desc}</p>
                                            <div className="flex justify-between border-t border-slate-700 pt-2 mt-2">
                                                <span className="text-slate-500 font-bold">Function:</span>
                                                <span className="text-white font-mono">{currentPartInfo.func}</span>
                                            </div>
                                        </div>
                                    </motion.div>
                                ) : (
                                    <div className="text-center text-slate-500 text-xs italic p-4">
                                        Select a part on the diagram or list to see details.
                                    </div>
                                )}
                            </AnimatePresence>

                        </div>
                    </div>

                    {/* Main Stage */}
                    <div className="flex-1 bg-[#020617] relative flex flex-col p-6 overflow-hidden">
                        
                        <div className="flex-1 bg-slate-900 rounded-3xl border border-slate-800 shadow-xl relative overflow-hidden flex flex-col items-center justify-center p-8">
                            
                            <div className="w-full h-full max-w-lg">
                                {viewMode === '2d' ? (
                                    system === 'male' ? (
                                        <MaleSystemSVG selected={selectedPart} onSelect={setSelectedPart} />
                                    ) : (
                                        <FemaleSystemSVG selected={selectedPart} onSelect={setSelectedPart} />
                                    )
                                ) : (
                                    <ReproductiveScene3D systemType={system} onSelect={setSelectedPart} />
                                )}
                            </div>

                            <div className="absolute bottom-6 left-1/2 -translate-x-1/2 text-xs text-slate-500 font-mono bg-black/40 px-3 py-1 rounded-full border border-white/10 pointer-events-none">
                                {viewMode === '2d' ? 'Front View (Schematic)' : '3D View (Interactive)'}
                            </div>

                        </div>

                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
