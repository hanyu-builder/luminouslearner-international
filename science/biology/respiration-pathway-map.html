<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Respiration Pathway Map | LuminousLearner</title>
    
    <!-- React & Tailwind -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Framer Motion -->
    <script src="https://unpkg.com/framer-motion@10.12.16/dist/framer-motion.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1e293b', 
                            950: '#0F172A', // LuminousLearner Dark Mode Background
                        },
                        emerald: {
                            450: '#10b981',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #e2e8f0; margin: 0; overflow: hidden; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }

        /* Glowing Path Animation */
        .path-flow {
            stroke-dasharray: 10;
            animation: flow 1s linear infinite;
        }
        @keyframes flow {
            to { stroke-dashoffset: -20; }
        }
        
        /* ATP Counter Glow */
        .atp-counter {
            text-shadow: 0 0 10px rgba(250, 204, 21, 0.6);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { motion, AnimatePresence } = window.Motion;

        const Icon = ({ name, className = "", size = 20 }) => {
            const [svgHtml, setSvgHtml] = useState('');
            useEffect(() => {
                if (window.lucide && window.lucide.icons) {
                    const pascalName = name.split('-').map(part => part.charAt(0).toUpperCase() + part.slice(1)).join('');
                    const iconData = window.lucide.icons[pascalName];
                    if (iconData && typeof window.lucide.createElement === 'function') {
                        const svgElement = window.lucide.createElement(iconData);
                        svgElement.setAttribute('class', className);
                        svgElement.setAttribute('width', size);
                        svgElement.setAttribute('height', size);
                        setSvgHtml(svgElement.outerHTML);
                    }
                }
            }, [name, className, size]);
            if (!svgHtml) return <span className={className} style={{ width: size, height: size, display: 'inline-block' }}></span>;
            return <span dangerouslySetInnerHTML={{ __html: svgHtml }} className="flex items-center justify-center" />;
        };

        // --- DATA ---
        const STAGES = {
            glycolysis: {
                id: 'glycolysis', name: 'Glycolysis', location: 'Cytoplasm',
                desc: 'Glucose (6C) is broken down into two Pyruvate (3C) molecules. Does not require oxygen.',
                inputs: ['Glucose', '2 ATP', '2 NAD⁺'],
                outputs: ['2 Pyruvate', '4 ATP (Net 2)', '2 NADH'],
                color: 'bg-blue-500'
            },
            link: {
                id: 'link', name: 'Link Reaction', location: 'Mitochondrial Matrix',
                desc: 'Pyruvate enters mitochondrion and is converted to Acetyl-CoA.',
                inputs: ['2 Pyruvate', '2 NAD⁺', '2 CoA'],
                outputs: ['2 Acetyl-CoA', '2 CO₂', '2 NADH'],
                color: 'bg-purple-500'
            },
            krebs: {
                id: 'krebs', name: 'Krebs Cycle', location: 'Mitochondrial Matrix',
                desc: 'Acetyl-CoA is fully oxidized to CO₂. Energy is captured in NADH and FADH₂.',
                inputs: ['2 Acetyl-CoA', '6 NAD⁺', '2 FAD', '2 ADP'],
                outputs: ['4 CO₂', '6 NADH', '2 FADH₂', '2 ATP'],
                color: 'bg-orange-500'
            },
            etc: {
                id: 'etc', name: 'Oxidative Phosphorylation', location: 'Inner Membrane (Cristae)',
                desc: 'Electrons from NADH/FADH₂ power the ETC to pump protons. ATP Synthase uses the gradient to make ATP.',
                inputs: ['10 NADH', '2 FADH₂', '6 O₂', '34 ADP'],
                outputs: ['34 ATP', '6 H₂O'],
                color: 'bg-emerald-500',
                breakdown: [
                    { type: 'NADH Source', detail: '2 (Gly) + 2 (Link) + 6 (Krebs) = 10 NADH' },
                    { type: 'FADH₂ Source', detail: '2 (Krebs) = 2 FADH₂' },
                    { type: 'Conversion', detail: '10 NADH × 3 = 30 ATP' },
                    { type: 'Conversion', detail: '2 FADH₂ × 2 = 4 ATP' },
                    { type: 'Total Yield', detail: '30 + 4 = 34 ATP', highlight: true }
                ]
            }
        };

        const TOTALS = {
            atp: 38,
            nadh: 10,
            fadh2: 2,
            co2: 6
        };

        // --- MAP COMPONENT ---
        const PathwayMap = ({ activeStage, onStageClick }) => {
            // New Layout Coordinates to fix ETC placement
            // Canvas Width: 800, Height: 500
            // Boundary between Cytoplasm and Mitochondria around x=300
            
            return (
                <svg viewBox="0 0 800 500" className="w-full h-full drop-shadow-2xl">
                    {/* Zones */}
                    <rect x="0" y="0" width="300" height="500" fill="#1e293b" opacity="0.5" />
                    <text x="20" y="30" fill="#64748b" fontSize="12" fontWeight="bold">CYTOPLASM</text>
                    
                    <path d="M 300 0 L 800 0 L 800 500 L 300 500 Q 250 250 300 0" fill="#334155" opacity="0.5" />
                    <text x="350" y="30" fill="#94a3b8" fontSize="12" fontWeight="bold">MITOCHONDRION</text>

                    {/* Connectors (Animated if stage active) */}
                    
                    {/* Glycolysis (50, 200) -> Link (320, 100) */}
                    <path d="M 200 250 C 250 250 250 140 320 140" stroke="#475569" strokeWidth="4" fill="none" className={activeStage === 'glycolysis' ? 'path-flow stroke-blue-400' : ''} />
                    
                    {/* Link (320, 100) -> Krebs (550, 200) */}
                    <path d="M 480 140 L 550 200" stroke="#475569" strokeWidth="4" className={activeStage === 'link' ? 'path-flow stroke-purple-400' : ''} />
                    
                    {/* Krebs (550, 200) -> ETC (350, 350) */}
                    {/* NADH path */}
                    <path d="M 550 280 C 550 350 450 390 400 390" stroke="#475569" strokeWidth="4" strokeDasharray="5,5" fill="none" className={activeStage === 'krebs' ? 'path-flow stroke-orange-400' : ''} />
                    
                    {/* Glycolysis NADH -> ETC */}
                    <path d="M 200 250 C 250 250 250 390 350 390" stroke="#475569" strokeWidth="2" strokeDasharray="5,5" fill="none" opacity="0.3" />


                    {/* Nodes */}
                    
                    {/* Glycolysis Node */}
                    <g transform="translate(20, 200)" onClick={() => onStageClick('glycolysis')} className="cursor-pointer hover:opacity-80 transition-opacity">
                        <rect width="180" height="100" rx="10" fill="#1e40af" stroke={activeStage === 'glycolysis' ? '#60a5fa' : '#1e3a8a'} strokeWidth="3" />
                        <text x="90" y="40" textAnchor="middle" fill="white" fontWeight="bold" fontSize="16">Glycolysis</text>
                        <text x="90" y="70" textAnchor="middle" fill="#93c5fd" fontSize="12">Glucose → Pyruvate</text>
                        {/* Badge */}
                        <circle cx="160" cy="20" r="12" fill="#fbbf24" />
                        <text x="160" y="24" textAnchor="middle" fill="#78350f" fontSize="10" fontWeight="bold">2 ATP</text>
                    </g>

                    {/* Link Reaction Node */}
                    <g transform="translate(320, 100)" onClick={() => onStageClick('link')} className="cursor-pointer hover:opacity-80 transition-opacity">
                        <rect width="160" height="80" rx="10" fill="#6b21a8" stroke={activeStage === 'link' ? '#c084fc' : '#581c87'} strokeWidth="3" />
                        <text x="80" y="35" textAnchor="middle" fill="white" fontWeight="bold" fontSize="14">Link Reaction</text>
                        <text x="80" y="60" textAnchor="middle" fill="#e9d5ff" fontSize="10">Pyruvate → Acetyl-CoA</text>
                    </g>

                    {/* Krebs Cycle Node */}
                    <g transform="translate(550, 200)" onClick={() => onStageClick('krebs')} className="cursor-pointer hover:opacity-80 transition-opacity">
                        <circle cx="80" cy="80" r="80" fill="#c2410c" stroke={activeStage === 'krebs' ? '#fb923c' : '#9a3412'} strokeWidth="3" strokeDasharray="8,4" />
                        <text x="80" y="70" textAnchor="middle" fill="white" fontWeight="bold" fontSize="16">Krebs Cycle</text>
                        <text x="80" y="95" textAnchor="middle" fill="#fdba74" fontSize="12">Citric Acid Cycle</text>
                         {/* Badge */}
                        <circle cx="140" cy="40" r="12" fill="#fbbf24" />
                        <text x="140" y="44" textAnchor="middle" fill="#78350f" fontSize="10" fontWeight="bold">2 ATP</text>
                    </g>

                    {/* ETC Node (Moved to correct position inside Mitochondria) */}
                    <g transform="translate(350, 350)" onClick={() => onStageClick('etc')} className="cursor-pointer hover:opacity-80 transition-opacity">
                        {/* Cristae folds representation */}
                        <path d="M 0 40 Q 20 0 40 40 T 80 40 T 120 40" stroke="#065f46" strokeWidth="2" fill="none" opacity="0.5" />
                        <rect width="250" height="100" rx="10" fill="#047857" stroke={activeStage === 'etc' ? '#34d399' : '#065f46'} strokeWidth="3" />
                        
                        <text x="125" y="40" textAnchor="middle" fill="white" fontWeight="bold" fontSize="16">Oxidative Phosphorylation</text>
                        <text x="125" y="65" textAnchor="middle" fill="#6ee7b7" fontSize="12">(Electron Transport Chain)</text>
                         {/* Badge */}
                        <circle cx="230" cy="20" r="15" fill="#fbbf24" className="animate-pulse" />
                        <text x="230" y="24" textAnchor="middle" fill="#78350f" fontSize="10" fontWeight="bold">34 ATP</text>
                    </g>

                </svg>
            );
        };

        // --- MAIN APP ---
        const App = () => {
            const [activeStageId, setActiveStageId] = useState('glycolysis');
            const currentStage = STAGES[activeStageId];

            return (
                <div className="min-h-screen bg-[#0F172A] text-white flex flex-col md:flex-row overflow-hidden font-sans">
                    
                    {/* Sidebar */}
                    <div className="w-full md:w-80 bg-slate-900 border-r border-slate-800 flex flex-col z-10 shadow-xl h-screen shrink-0">
                        <div className="p-6 border-b border-slate-800">
                            <h1 className="text-xl font-bold flex items-center gap-2">
                                <Icon name="network" className="text-emerald-400" /> Respiration Map
                            </h1>
                            <p className="text-xs text-slate-400 mt-1">Aerobic Respiration Pathway</p>
                        </div>

                        <div className="p-6 space-y-6 flex-1 overflow-y-auto">
                            
                            {/* Stage Selector List */}
                            <div className="space-y-2">
                                {Object.values(STAGES).map(stage => (
                                    <button 
                                        key={stage.id}
                                        onClick={() => setActiveStageId(stage.id)}
                                        className={`w-full text-left p-4 rounded-xl border transition-all flex items-center gap-3 relative overflow-hidden
                                            ${activeStageId === stage.id 
                                                ? `${stage.color.replace('bg-', 'border-')} bg-slate-800 shadow-lg` 
                                                : 'bg-slate-900/50 border-slate-700 hover:bg-slate-800 text-slate-400'}
                                        `}
                                    >
                                        <div className={`absolute left-0 top-0 bottom-0 w-1 ${stage.color}`}></div>
                                        <div className="flex-1">
                                            <div className={`font-bold text-sm ${activeStageId === stage.id ? 'text-white' : ''}`}>{stage.name}</div>
                                            <div className="text-[10px] opacity-70">{stage.location}</div>
                                        </div>
                                        {activeStageId === stage.id && <Icon name="chevron-right" size={16} className="text-white"/>}
                                    </button>
                                ))}
                            </div>

                            {/* Summary Stats */}
                            <div className="bg-slate-800 p-4 rounded-xl border border-slate-700">
                                <div className="text-xs font-bold text-slate-500 uppercase mb-3">Total Yield (per Glucose)</div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="text-center p-2 bg-slate-900 rounded-lg border border-yellow-500/30">
                                        <div className="text-2xl font-black text-yellow-400 atp-counter">{TOTALS.atp}</div>
                                        <div className="text-[10px] text-yellow-200 font-bold">ATP</div>
                                    </div>
                                    <div className="text-center p-2 bg-slate-900 rounded-lg border border-blue-500/30">
                                        <div className="text-xl font-bold text-blue-400">{TOTALS.nadh}</div>
                                        <div className="text-[10px] text-blue-200">NADH</div>
                                    </div>
                                    <div className="text-center p-2 bg-slate-900 rounded-lg border border-purple-500/30">
                                        <div className="text-xl font-bold text-purple-400">{TOTALS.fadh2}</div>
                                        <div className="text-[10px] text-purple-200">FADH₂</div>
                                    </div>
                                    <div className="text-center p-2 bg-slate-900 rounded-lg border border-slate-500/30">
                                        <div className="text-xl font-bold text-slate-300">{TOTALS.co2}</div>
                                        <div className="text-[10px] text-slate-400">CO₂</div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    {/* Main Stage */}
                    <div className="flex-1 bg-[#020617] relative flex flex-col">
                        
                        {/* Map View */}
                        <div className="flex-1 relative overflow-hidden p-4 flex items-center justify-center">
                            <div className="w-full max-w-4xl aspect-video bg-slate-900 rounded-3xl border border-slate-800 shadow-2xl overflow-hidden relative">
                                <PathwayMap activeStage={activeStageId} onStageClick={setActiveStageId} />
                                
                                {/* Hover instructions */}
                                <div className="absolute top-4 left-4 text-xs text-slate-500 bg-black/40 backdrop-blur px-3 py-1 rounded-full border border-white/10">
                                    Click nodes to explore details
                                </div>
                            </div>
                        </div>

                        {/* Details Panel */}
                        <div className="h-auto min-h-48 bg-slate-800 border-t border-slate-700 p-6 shrink-0 flex flex-col md:flex-row gap-8 z-20 shadow-[0_-10px_40px_rgba(0,0,0,0.3)] overflow-y-auto">
                            <div className="flex-1">
                                <div className="flex items-center gap-2 mb-2">
                                    <div className={`px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-white/10 text-white border border-white/10`}>
                                        Step Details
                                    </div>
                                    <div className="text-xs text-emerald-400 font-bold uppercase flex items-center gap-1">
                                        <Icon name="map-pin" size={12}/> {currentStage.location}
                                    </div>
                                </div>
                                <h2 className="text-2xl font-black text-white mb-2">{currentStage.name}</h2>
                                <p className="text-sm text-slate-300 leading-relaxed max-w-2xl mb-4">
                                    {currentStage.desc}
                                </p>

                                {/* NEW: Breakdown for ETC */}
                                {currentStage.breakdown && (
                                    <div className="bg-slate-900/50 rounded-xl border border-slate-700 p-3 max-w-md">
                                        <div className="text-[10px] font-bold text-slate-500 uppercase mb-2 flex items-center gap-2">
                                            <Icon name="calculator" size={12}/> ATP Calculation Logic
                                        </div>
                                        <div className="space-y-1">
                                            {currentStage.breakdown.map((item, i) => (
                                                <div key={i} className={`flex justify-between text-xs ${item.highlight ? 'text-yellow-400 font-bold pt-1 mt-1 border-t border-slate-600' : 'text-slate-300'}`}>
                                                    <span>{item.type}:</span>
                                                    <span className="font-mono">{item.detail}</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                            
                            {/* Inputs / Outputs */}
                            <div className="w-full md:w-64 grid grid-cols-2 gap-4 border-l border-slate-700 pl-8">
                                <div>
                                    <div className="text-[10px] font-bold text-slate-500 uppercase mb-2 flex items-center gap-1">
                                        <Icon name="arrow-right-circle" size={12}/> Inputs
                                    </div>
                                    <ul className="space-y-1">
                                        {currentStage.inputs.map((item, i) => (
                                            <li key={i} className="text-xs text-slate-300 flex items-center gap-2">
                                                <div className="w-1 h-1 rounded-full bg-slate-500"></div> {item}
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                                <div>
                                    <div className="text-[10px] font-bold text-slate-500 uppercase mb-2 flex items-center gap-1">
                                        <Icon name="check-circle" size={12}/> Outputs
                                    </div>
                                    <ul className="space-y-1">
                                        {currentStage.outputs.map((item, i) => (
                                            <li key={i} className={`text-xs flex items-center gap-2 ${item.includes('ATP') ? 'text-yellow-400 font-bold' : 'text-emerald-300'}`}>
                                                <div className={`w-1 h-1 rounded-full ${item.includes('ATP') ? 'bg-yellow-400' : 'bg-emerald-500'}`}></div> {item}
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
