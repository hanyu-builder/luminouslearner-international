<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Element, Compound & Mixture Identifier - LuminousLearner International</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #e2e8f0; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        .particle-container {
            transition: all 0.3s ease;
        }
        
        @keyframes float {
            0% { transform: translate(0, 0); }
            25% { transform: translate(3px, 3px); }
            50% { transform: translate(-3px, 1px); }
            75% { transform: translate(2px, -3px); }
            100% { transform: translate(0, 0); }
        }
        .animate-float {
            animation: float 4s infinite ease-in-out;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="root" class="flex-grow flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Icon = ({ name, size = 20, className = "" }) => {
            const [svg, setSvg] = useState('');
            useEffect(() => {
                if (window.lucide) {
                    const iconNode = window.lucide.icons[name];
                    if (iconNode) {
                        const iconSvg = window.lucide.createElement(iconNode);
                        iconSvg.setAttribute('width', size);
                        iconSvg.setAttribute('height', size);
                        iconSvg.setAttribute('class', className);
                        setSvg(iconSvg.outerHTML);
                    }
                }
            }, [name, size, className]);
            return <span dangerouslySetInnerHTML={{ __html: svg }} className="flex items-center" />;
        };

        // Particle Types (Colors for Atom Visualization)
        const AtomTypes = [
            { color: 'bg-rose-500', border: 'border-rose-700' },    // Red Atom
            { color: 'bg-blue-500', border: 'border-blue-700' },    // Blue Atom
            { color: 'bg-emerald-500', border: 'border-emerald-700' }, // Green Atom
            { color: 'bg-yellow-400', border: 'border-yellow-600' } // Yellow Atom
        ];

        const App = () => {
            const [currentType, setCurrentType] = useState(null); // 'element', 'compound', 'mixture'
            const [particles, setParticles] = useState([]);
            const [score, setScore] = useState(0);
            const [streak, setStreak] = useState(0);
            const [feedback, setFeedback] = useState(null); // { type: 'success'/'error', msg: '', explanation: '' }
            const [showExplanation, setShowExplanation] = useState(false);

            // Generate a new question
            const generateQuestion = () => {
                const types = ['element', 'compound', 'mixture'];
                const type = types[Math.floor(Math.random() * types.length)];
                setCurrentType(type);
                setFeedback(null);
                setShowExplanation(false);

                const newParticles = [];
                const count = 6 + Math.floor(Math.random() * 4); // 6 to 9 particles

                // Helper to create molecule visual
                const createMolecule = (atoms, x, y) => ({ atoms, x, y, id: Math.random() });

                if (type === 'element') {
                    // Case 1: Monoatomic (e.g. Ne) OR Diatomic (e.g. O2) of SAME color
                    const atomType = AtomTypes[Math.floor(Math.random() * AtomTypes.length)];
                    const isDiatomic = Math.random() > 0.5;

                    for (let i = 0; i < count; i++) {
                        const x = Math.random() * 80 + 10;
                        const y = Math.random() * 80 + 10;
                        
                        if (isDiatomic) {
                            newParticles.push(createMolecule([atomType, atomType], x, y));
                        } else {
                            newParticles.push(createMolecule([atomType], x, y));
                        }
                    }
                } else if (type === 'compound') {
                    // Different atoms bonded together, ALL molecules must be IDENTICAL
                    // Pick 2 distinct atom types
                    const shuffled = [...AtomTypes].sort(() => 0.5 - Math.random());
                    const a = shuffled[0];
                    const b = shuffled[1];
                    
                    // Randomly choose ratio: AB or AB2
                    const isAB2 = Math.random() > 0.5;
                    const composition = isAB2 ? [a, b, b] : [a, b];

                    for (let i = 0; i < count; i++) {
                        const x = Math.random() * 80 + 10;
                        const y = Math.random() * 80 + 10;
                        newParticles.push(createMolecule(composition, x, y));
                    }
                } else { // mixture
                    // Mixture of Elements OR Compounds OR Both
                    const mixType = Math.random();
                    const shuffled = [...AtomTypes].sort(() => 0.5 - Math.random());
                    const a = shuffled[0];
                    const b = shuffled[1];
                    
                    for (let i = 0; i < count; i++) {
                        const x = Math.random() * 80 + 10;
                        const y = Math.random() * 80 + 10;
                        
                        // Randomly pick particle A or B for this position
                        if (Math.random() > 0.5) {
                            newParticles.push(createMolecule([a], x, y)); // Particle Type 1
                        } else {
                            // Particle Type 2 (Make it visibly different)
                            if (mixType > 0.5) {
                                newParticles.push(createMolecule([b, b], x, y)); // Element B (diatomic)
                            } else {
                                newParticles.push(createMolecule([a, b], x, y)); // Compound AB
                            }
                        }
                    }
                }
                setParticles(newParticles);
            };

            // Initial Load
            useEffect(() => {
                generateQuestion();
            }, []);

            const handleGuess = (guess) => {
                if (feedback) return; // Prevent double guessing

                if (guess === currentType) {
                    setScore(s => s + 10);
                    setStreak(s => s + 1);
                    setFeedback({ 
                        type: 'success', 
                        msg: 'Correct!', 
                        explanation: getExplanation(currentType)
                    });
                } else {
                    setStreak(0);
                    setFeedback({ 
                        type: 'error', 
                        msg: 'Incorrect...', 
                        explanation: `The correct answer is **${getTypeName(currentType)}**.\n${getExplanation(currentType)}` 
                    });
                }
                setShowExplanation(true);
            };

            const getTypeName = (type) => {
                if (type === 'element') return 'Element';
                if (type === 'compound') return 'Compound';
                return 'Mixture';
            };

            const getExplanation = (type) => {
                if (type === 'element') return 'Contains only **ONE** type of atom (or molecules made of the same atom).';
                if (type === 'compound') return 'Contains two or more different atoms chemically bonded in a **fixed ratio**. All molecules look identical.';
                return 'Contains **two or more** different substances (particles) that are NOT chemically bonded together.';
            };

            return (
                <div className="flex flex-col h-full container mx-auto px-4 py-6 max-w-5xl">
                    
                    {/* Header */}
                    <div className="flex justify-between items-center mb-6 border-b border-slate-800 pb-4">
                        <div>
                            <h1 className="text-2xl font-bold text-indigo-400 flex items-center gap-2">
                                <Icon name="Microscope" /> Matter Classifier
                            </h1>
                            <p className="text-slate-500 text-sm">Element, Compound, or Mixture?</p>
                        </div>
                        <div className="flex gap-4 text-xl font-mono font-bold">
                            <div className="text-indigo-400">Score: {score}</div>
                            <div className="text-orange-500">Streak: {streak} ðŸ”¥</div>
                        </div>
                    </div>

                    <div className="flex flex-col lg:flex-row gap-8 flex-grow">
                        
                        {/* Left: Microscope View (Rectangle Window) */}
                        <div className="w-full lg:w-3/5 bg-slate-900 rounded-3xl shadow-2xl border-8 border-slate-800 relative overflow-hidden flex items-center justify-center group min-h-[400px] lg:min-h-[500px]">
                            
                            {/* Screen Glare Effect */}
                            <div className="absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-white/5 to-transparent pointer-events-none z-10"></div>
                            
                            {/* Grid Background (Subtle) */}
                            <div className="absolute inset-0 opacity-10" 
                                 style={{backgroundImage: 'linear-gradient(#475569 1px, transparent 1px), linear-gradient(90deg, #475569 1px, transparent 1px)', backgroundSize: '40px 40px'}}>
                            </div>

                            {/* Particles Layer */}
                            <div className="relative w-full h-full p-8">
                                {particles.map((p, i) => (
                                    <div 
                                        key={p.id}
                                        className="absolute animate-float flex items-center justify-center"
                                        style={{ 
                                            left: `${p.x}%`, 
                                            top: `${p.y}%`, 
                                            animationDelay: `${i * 0.5}s`
                                        }}
                                    >
                                        {/* Render Atoms in a Molecule */}
                                        {p.atoms.map((atom, idx) => (
                                            <div 
                                                key={idx}
                                                className={`w-8 h-8 rounded-full border-2 shadow-lg ${atom.color} ${atom.border} ${idx > 0 ? '-ml-2' : ''}`}
                                            >
                                                <div className="w-2 h-2 bg-white/30 rounded-full absolute top-1 left-1"></div>
                                            </div>
                                        ))}
                                    </div>
                                ))}
                            </div>
                            
                            {/* Label */}
                            <div className="absolute bottom-4 left-4 bg-black/60 px-3 py-1 rounded text-xs text-slate-400 font-mono border border-slate-700">
                                MAGNIFICATION: 10,000,000x
                            </div>
                        </div>

                        {/* Right: Controls */}
                        <div className="w-full lg:w-2/5 flex flex-col gap-4 justify-center">
                            
                            <div className="bg-slate-800 p-6 rounded-2xl shadow-lg border border-slate-700">
                                <h3 className="text-lg font-bold mb-4 text-slate-300 flex items-center gap-2">
                                    <Icon name="Search" /> Identify the Substance:
                                </h3>
                                
                                <div className="space-y-3">
                                    <button 
                                        onClick={() => handleGuess('element')}
                                        disabled={showExplanation}
                                        className={`w-full p-4 rounded-xl border-2 font-bold text-lg transition-all flex items-center justify-center group
                                            ${showExplanation && currentType === 'element' 
                                                ? 'bg-emerald-900/30 border-emerald-500 text-emerald-400' 
                                                : 'bg-slate-700 border-slate-600 text-slate-300 hover:border-indigo-500 hover:text-indigo-400 hover:bg-slate-600'}
                                        `}
                                    >
                                        Element
                                    </button>

                                    <button 
                                        onClick={() => handleGuess('compound')}
                                        disabled={showExplanation}
                                        className={`w-full p-4 rounded-xl border-2 font-bold text-lg transition-all flex items-center justify-center group
                                            ${showExplanation && currentType === 'compound' 
                                                ? 'bg-emerald-900/30 border-emerald-500 text-emerald-400' 
                                                : 'bg-slate-700 border-slate-600 text-slate-300 hover:border-indigo-500 hover:text-indigo-400 hover:bg-slate-600'}
                                        `}
                                    >
                                        Compound
                                    </button>

                                    <button 
                                        onClick={() => handleGuess('mixture')}
                                        disabled={showExplanation}
                                        className={`w-full p-4 rounded-xl border-2 font-bold text-lg transition-all flex items-center justify-center group
                                            ${showExplanation && currentType === 'mixture' 
                                                ? 'bg-emerald-900/30 border-emerald-500 text-emerald-400' 
                                                : 'bg-slate-700 border-slate-600 text-slate-300 hover:border-indigo-500 hover:text-indigo-400 hover:bg-slate-600'}
                                        `}
                                    >
                                        Mixture
                                    </button>
                                </div>
                            </div>

                            {/* Feedback Section */}
                            {showExplanation && (
                                <div className={`p-5 rounded-xl border-l-4 animate-in slide-in-from-bottom-2 shadow-lg
                                    ${feedback.type === 'success' ? 'bg-emerald-900/20 border-emerald-500 text-emerald-400' : 'bg-rose-900/20 border-rose-500 text-rose-400'}
                                `}>
                                    <div className="font-bold text-lg mb-2 flex items-center gap-2">
                                        <Icon name={feedback.type === 'success' ? "CheckCircle" : "XCircle"} />
                                        {feedback.msg}
                                    </div>
                                    <div className="text-sm opacity-90 whitespace-pre-line leading-relaxed bg-slate-800/50 p-3 rounded-lg border border-slate-700/50 text-slate-300">
                                        <span dangerouslySetInnerHTML={{ __html: feedback.explanation }} />
                                    </div>
                                    
                                    <button 
                                        onClick={generateQuestion}
                                        className="mt-4 w-full py-3 bg-indigo-600 text-white font-bold rounded-lg shadow-lg hover:bg-indigo-500 transition-all flex items-center justify-center gap-2 active:scale-95"
                                    >
                                        <Icon name="RefreshCw" size={18} /> Next Question
                                    </button>
                                </div>
                            )}

                        </div>
                    </div>
                    
                    <div className="text-center text-slate-600 text-xs mt-12 border-t border-slate-800 pt-6">
                        Luminous Learner International | Science Foundation
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
