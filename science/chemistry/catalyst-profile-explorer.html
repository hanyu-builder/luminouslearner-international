<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalyst Profile Explorer</title>
    
    <!-- React & Tailwind -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Recharts Dependencies (Prop-types is often required for UMD) -->
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>
    
    <!-- Recharts -->
    <script src="https://unpkg.com/recharts@2.12.7/umd/Recharts.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #e2e8f0; margin: 0; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Custom Animations */
        .adsorb { animation: adsorb 2s infinite ease-in-out; }
        @keyframes adsorb {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(10px); }
        }
        
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // Ensure Recharts is loaded from window object
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, ReferenceLine, Area, ComposedChart } = window.Recharts;

        // Safe Icon Component
        const Icon = ({ name, className = "", size = 20 }) => {
            const [svgHtml, setSvgHtml] = useState('');
            useEffect(() => {
                if (window.lucide && window.lucide.icons) {
                    const pascalName = name.split('-').map(part => part.charAt(0).toUpperCase() + part.slice(1)).join('');
                    const iconData = window.lucide.icons[pascalName];
                    if (iconData && typeof window.lucide.createElement === 'function') {
                        const svgElement = window.lucide.createElement(iconData);
                        svgElement.setAttribute('class', className);
                        svgElement.setAttribute('width', size);
                        svgElement.setAttribute('height', size);
                        setSvgHtml(svgElement.outerHTML);
                    }
                }
            }, [name, className, size]);
            if (!svgHtml) return <span className={className} style={{ width: size, height: size, display: 'inline-block' }}></span>;
            return <span dangerouslySetInnerHTML={{ __html: svgHtml }} className="flex items-center justify-center" />;
        };

        // --- ENERGY PROFILE DATA ---
        const ENERGY_DATA = [
            { x: 0, uncatalyzed: 20, catalyzed: 20 },
            { x: 20, uncatalyzed: 20, catalyzed: 20 },
            { x: 40, uncatalyzed: 60, catalyzed: 40 }, // Transition State
            { x: 50, uncatalyzed: 80, catalyzed: 50 }, // Peak
            { x: 60, uncatalyzed: 60, catalyzed: 40 },
            { x: 80, uncatalyzed: 10, catalyzed: 10 },
            { x: 100, uncatalyzed: 10, catalyzed: 10 }
        ];

        // --- MAXWELL-BOLTZMANN DATA ---
        // Generating a curve that looks like Maxwell-Boltzmann distribution
        const MB_DATA = [];
        for (let i = 0; i <= 100; i+=2) {
            const y = Math.pow(i, 2) * Math.exp(-i / 15) * 100; // Simplified model
            MB_DATA.push({ energy: i, particles: y });
        }

        // --- HETEROGENEOUS ANIMATION (Canvas) ---
        const HeteroAnimation = ({ isPlaying }) => {
            const canvasRef = useRef(null);
            
            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                let animationFrameId;
                let step = 0;

                const draw = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    // 1. Catalyst Surface (Solid)
                    ctx.fillStyle = '#475569';
                    ctx.fillRect(50, 150, 300, 20);
                    ctx.fillStyle = '#94a3b8';
                    for(let i=0; i<6; i++) {
                        ctx.beginPath();
                        ctx.arc(75 + i*50, 150, 25, 0, Math.PI, true); // Surface atoms
                        ctx.fill();
                    }

                    // 2. Reactants (Adsorption -> Reaction -> Desorption)
                    // Molecule A (Red)
                    ctx.beginPath();
                    ctx.arc(100, 100 + (step < 100 ? step : 100) * 0.5, 10, 0, 2 * Math.PI);
                    ctx.fillStyle = '#ef4444';
                    ctx.fill();

                    // Molecule B (Blue)
                    ctx.beginPath();
                    ctx.arc(140, 100 + (step < 100 ? step : 100) * 0.5, 10, 0, 2 * Math.PI);
                    ctx.fillStyle = '#3b82f6';
                    ctx.fill();

                    // If reacted (step > 150), draw bond
                    if (step > 150) {
                        ctx.beginPath();
                        ctx.moveTo(100, 100 + 50 - (step > 200 ? (step-200)*0.5 : 0));
                        ctx.lineTo(140, 100 + 50 - (step > 200 ? (step-200)*0.5 : 0));
                        ctx.strokeStyle = '#22c55e';
                        ctx.lineWidth = 4;
                        ctx.stroke();
                    }

                    // Text Labels
                    ctx.fillStyle = 'white';
                    ctx.font = '12px Arial';
                    if (step < 100) ctx.fillText("1. Diffusion & Adsorption", 10, 30);
                    else if (step < 200) ctx.fillText("2. Reaction on Surface", 10, 30);
                    else ctx.fillText("3. Desorption", 10, 30);

                    if (isPlaying) {
                        step = (step + 1) % 300;
                        animationFrameId = requestAnimationFrame(draw);
                    }
                };
                
                if (isPlaying) draw();
                else {
                    // Static initial state
                    step = 0;
                    draw();
                }

                return () => cancelAnimationFrame(animationFrameId);
            }, [isPlaying]);

            return <canvas ref={canvasRef} width={400} height={200} className="w-full h-full bg-slate-800 rounded-xl" />;
        };

        // --- HOMOGENEOUS ANIMATION (Canvas) ---
        const HomoAnimation = ({ isPlaying }) => {
            const canvasRef = useRef(null);
            
            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                let animationFrameId;
                let step = 0;

                const draw = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    // Background (Solution)
                    // Clear makes it transparent, but we can add a slight tint if needed
                    // ctx.fillStyle = 'rgba(30, 41, 59, 0.5)';
                    // ctx.fillRect(0, 0, canvas.width, canvas.height);

                    const centerX = canvas.width / 2;
                    const centerY = canvas.height / 2;

                    // Initial Positions
                    let catX = centerX, catY = centerY + 50; // Catalyst (Purple)
                    let aX = centerX - 60, aY = centerY - 30; // Reactant A (Red)
                    let bX = centerX + 60, bY = centerY - 30; // Reactant B (Blue)

                    // Calculate positions based on step
                    if (step < 100) {
                        // Phase 1: Catalyst approaches A
                        const progress = step / 100;
                        catX = centerX - (progress * 30); 
                        catY = centerY + 50 - (progress * 40); 
                        aX = centerX - 60 + (progress * 30);
                        aY = centerY - 30 + (progress * 40);
                        bX = centerX + 60 + Math.sin(step * 0.1) * 5; // Idle hover
                    } else if (step < 200) {
                        // Phase 2: Intermediate AC moves to B
                        const progress = (step - 100) / 100;
                        const acX = centerX - 30 + (progress * 60);
                        const acY = centerY + 10 - (progress * 40);
                        catX = acX; catY = acY + 10;
                        aX = acX; aY = acY - 10;
                        bX = centerX + 60 - (progress * 30);
                        bY = centerY - 30;
                    } else {
                        // Phase 3: Product AB forms, Catalyst leaves
                        const progress = (step - 200) / 100;
                        catX = centerX + 30; 
                        catY = centerY - 30 + 60 * progress; // Drops down
                        
                        // Product moves up
                        aX = centerX + 20; aY = centerY - 30 - progress * 40;
                        bX = centerX + 40; bY = centerY - 30 - progress * 40;
                    }

                    // Draw Catalyst (C)
                    ctx.beginPath();
                    ctx.arc(catX, catY, 15, 0, 2 * Math.PI);
                    ctx.fillStyle = '#a855f7'; // Purple
                    ctx.fill();
                    ctx.fillStyle = 'white';
                    ctx.font = '10px Arial';
                    ctx.fillText("Cat", catX-8, catY+4);

                    // Draw Reactants/Product
                    if (step < 200) {
                        // A
                        ctx.beginPath();
                        ctx.arc(aX, aY, 12, 0, 2 * Math.PI);
                        ctx.fillStyle = '#ef4444'; // Red
                        ctx.fill();
                        ctx.fillStyle = 'white';
                        ctx.fillText("A", aX-4, aY+4);

                        // B
                        ctx.beginPath();
                        ctx.arc(bX, bY, 12, 0, 2 * Math.PI);
                        ctx.fillStyle = '#3b82f6'; // Blue
                        ctx.fill();
                        ctx.fillStyle = 'white';
                        ctx.fillText("B", bX-4, bY+4);
                        
                        // Intermediate Bond (A-C)
                        if (step >= 100) {
                            ctx.beginPath();
                            ctx.strokeStyle = 'white';
                            ctx.lineWidth = 2;
                            ctx.moveTo(aX, aY);
                            ctx.lineTo(catX, catY);
                            ctx.stroke();
                        }
                    } else {
                        // Product Bond (A-B)
                        ctx.beginPath();
                        ctx.strokeStyle = '#22c55e'; // Green bond
                        ctx.lineWidth = 4;
                        ctx.moveTo(aX, aY);
                        ctx.lineTo(bX, bY);
                        ctx.stroke();

                        // A
                        ctx.beginPath();
                        ctx.arc(aX, aY, 12, 0, 2 * Math.PI);
                        ctx.fillStyle = '#ef4444';
                        ctx.fill();
                        // B
                        ctx.beginPath();
                        ctx.arc(bX, bY, 12, 0, 2 * Math.PI);
                        ctx.fillStyle = '#3b82f6';
                        ctx.fill();
                    }

                    // Labels
                    ctx.fillStyle = 'white';
                    ctx.font = '12px Arial';
                    if (step < 100) ctx.fillText("1. Catalyst approaches Reactant A", 10, 30);
                    else if (step < 200) ctx.fillText("2. Intermediate Species Forms", 10, 30);
                    else ctx.fillText("3. Product Forms & Catalyst Regenerates", 10, 30);

                    if (isPlaying) {
                        step = (step + 1) % 300;
                        animationFrameId = requestAnimationFrame(draw);
                    }
                };
                
                if (isPlaying) draw();
                else {
                    step = 0;
                    draw();
                }

                return () => cancelAnimationFrame(animationFrameId);
            }, [isPlaying]);

            return <canvas ref={canvasRef} width={400} height={200} className="w-full h-full bg-slate-800 rounded-xl" />;
        };

        const App = () => {
            const [view, setView] = useState('energy'); // energy, boltzmann, mechanism
            const [showCatalyzed, setShowCatalyzed] = useState(true);
            const [mechanismType, setMechanismType] = useState('hetero'); // hetero, homo
            const [isPlaying, setIsPlaying] = useState(false);

            return (
                <div className="min-h-screen bg-[#0F172A] text-white flex flex-col md:flex-row overflow-hidden">
                    
                    {/* Sidebar */}
                    <div className="w-full md:w-80 bg-slate-900 border-r border-slate-800 flex flex-col z-10 shadow-xl h-screen shrink-0">
                        <div className="p-6 border-b border-slate-800">
                            <h1 className="text-xl font-bold flex items-center gap-2">
                                <Icon name="zap" className="text-yellow-400" /> Catalyst Profile
                            </h1>
                            <p className="text-xs text-slate-400 mt-1">Principles of Catalysis</p>
                        </div>

                        <div className="p-4 space-y-2">
                            <label className="text-xs font-bold text-slate-500 uppercase tracking-widest px-2 mb-2 block">Visualization Mode</label>
                            
                            <button 
                                onClick={() => setView('energy')}
                                className={`w-full text-left p-4 rounded-xl border transition-all flex items-center gap-3
                                    ${view === 'energy' ? 'bg-slate-800 border-emerald-500 ring-1 ring-emerald-500/50' : 'bg-slate-900/50 border-slate-700 hover:bg-slate-800'}
                                `}
                            >
                                <Icon name="activity" className="text-emerald-400" />
                                <div>
                                    <div className="text-sm font-bold text-white">Energy Profile</div>
                                    <div className="text-xs text-slate-400">Ea & Reaction Pathway</div>
                                </div>
                            </button>

                            <button 
                                onClick={() => setView('boltzmann')}
                                className={`w-full text-left p-4 rounded-xl border transition-all flex items-center gap-3
                                    ${view === 'boltzmann' ? 'bg-slate-800 border-blue-500 ring-1 ring-blue-500/50' : 'bg-slate-900/50 border-slate-700 hover:bg-slate-800'}
                                `}
                            >
                                <Icon name="bar-chart-2" className="text-blue-400" />
                                <div>
                                    <div className="text-sm font-bold text-white">Boltzmann Dist.</div>
                                    <div className="text-xs text-slate-400">Kinetic Energy & Rate</div>
                                </div>
                            </button>

                            <button 
                                onClick={() => setView('mechanism')}
                                className={`w-full text-left p-4 rounded-xl border transition-all flex items-center gap-3
                                    ${view === 'mechanism' ? 'bg-slate-800 border-purple-500 ring-1 ring-purple-500/50' : 'bg-slate-900/50 border-slate-700 hover:bg-slate-800'}
                                `}
                            >
                                <Icon name="settings" className="text-purple-400" />
                                <div>
                                    <div className="text-sm font-bold text-white">Mechanism</div>
                                    <div className="text-xs text-slate-400">Surface & Intermediate</div>
                                </div>
                            </button>
                        </div>

                        {/* Controls based on view */}
                        <div className="mt-auto p-6 border-t border-slate-800">
                            {view === 'energy' && (
                                <div className="space-y-4">
                                    <div className="flex items-center justify-between">
                                        <span className="text-sm font-bold text-slate-300">Show Catalyst Path</span>
                                        <button 
                                            onClick={() => setShowCatalyzed(!showCatalyzed)}
                                            className={`w-12 h-6 rounded-full transition-colors relative ${showCatalyzed ? 'bg-emerald-600' : 'bg-slate-700'}`}
                                        >
                                            <div className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-transform ${showCatalyzed ? 'left-7' : 'left-1'}`}></div>
                                        </button>
                                    </div>
                                    <p className="text-xs text-slate-500">Catalyst provides an alternative pathway with lower Activation Energy (Ea).</p>
                                </div>
                            )}

                            {view === 'boltzmann' && (
                                <div className="space-y-4">
                                    <div className="flex items-center justify-between">
                                        <span className="text-sm font-bold text-slate-300">Lower Ea Barrier</span>
                                        <button 
                                            onClick={() => setShowCatalyzed(!showCatalyzed)}
                                            className={`w-12 h-6 rounded-full transition-colors relative ${showCatalyzed ? 'bg-blue-600' : 'bg-slate-700'}`}
                                        >
                                            <div className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-transform ${showCatalyzed ? 'left-7' : 'left-1'}`}></div>
                                        </button>
                                    </div>
                                    <p className="text-xs text-slate-500">Catalyst shifts the Ea line to the left, increasing the shaded area (successful collisions).</p>
                                </div>
                            )}

                            {view === 'mechanism' && (
                                <div className="space-y-4">
                                    <div className="grid grid-cols-2 gap-2">
                                        <button 
                                            onClick={() => setMechanismType('hetero')}
                                            className={`py-2 text-xs font-bold rounded-lg transition-all ${mechanismType === 'hetero' ? 'bg-purple-600 text-white' : 'bg-slate-800 text-slate-400'}`}
                                        >
                                            Heterogeneous
                                        </button>
                                        <button 
                                            onClick={() => setMechanismType('homo')}
                                            className={`py-2 text-xs font-bold rounded-lg transition-all ${mechanismType === 'homo' ? 'bg-purple-600 text-white' : 'bg-slate-800 text-slate-400'}`}
                                        >
                                            Homogeneous
                                        </button>
                                    </div>
                                    <button 
                                        onClick={() => setIsPlaying(!isPlaying)}
                                        className="w-full py-3 bg-slate-700 hover:bg-slate-600 rounded-xl font-bold flex items-center justify-center gap-2 transition-colors"
                                    >
                                        <Icon name={isPlaying ? "pause" : "play"} size={16} /> {isPlaying ? 'Pause' : 'Play Animation'}
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>

                    {/* Main Stage */}
                    <div className="flex-1 bg-slate-900/50 p-4 md:p-12 flex flex-col justify-center items-center relative overflow-hidden">
                        <div className="absolute inset-0 opacity-10 pointer-events-none" 
                            style={{backgroundImage: 'linear-gradient(#334155 1px, transparent 1px), linear-gradient(90deg, #334155 1px, transparent 1px)', backgroundSize: '40px 40px'}}>
                        </div>

                        <div className="w-full max-w-4xl h-[500px] bg-slate-800/80 backdrop-blur rounded-3xl border border-slate-700 p-6 shadow-2xl relative z-10 flex flex-col fade-in">
                            
                            {/* View Content */}
                            {view === 'energy' && (
                                <div className="w-full h-full flex flex-col">
                                    <h2 className="text-lg font-bold text-white mb-4 flex items-center gap-2">
                                        <Icon name="trending-up" className="text-emerald-400"/> Energy Profile Diagram
                                    </h2>
                                    <ResponsiveContainer width="100%" height="100%">
                                        <LineChart data={ENERGY_DATA} margin={{ top: 20, right: 30, left: 0, bottom: 0 }}>
                                            <CartesianGrid strokeDasharray="3 3" stroke="#334155" />
                                            <XAxis dataKey="x" type="number" hide />
                                            <YAxis hide domain={[0, 100]} />
                                            <Tooltip contentStyle={{ backgroundColor: '#1e293b', border: '1px solid #475569' }} />
                                            
                                            {/* Uncatalyzed Path */}
                                            <Line type="monotone" dataKey="uncatalyzed" stroke="#ef4444" strokeWidth={3} dot={false} name="Uncatalyzed" />
                                            
                                            {/* Catalyzed Path */}
                                            {showCatalyzed && (
                                                <Line type="monotone" dataKey="catalyzed" stroke="#10b981" strokeWidth={3} strokeDasharray="5 5" dot={false} name="Catalyzed" />
                                            )}
                                        </LineChart>
                                    </ResponsiveContainer>
                                    <div className="flex justify-center gap-6 mt-4">
                                        <div className="flex items-center gap-2 text-sm text-red-400 font-bold">
                                            <div className="w-4 h-1 bg-red-500"></div> Uncatalyzed (High Ea)
                                        </div>
                                        {showCatalyzed && (
                                            <div className="flex items-center gap-2 text-sm text-emerald-400 font-bold">
                                                <div className="w-4 h-1 bg-emerald-500 border-b-2 border-dashed border-emerald-900"></div> Catalyzed (Lower Ea)
                                            </div>
                                        )}
                                    </div>
                                </div>
                            )}

                            {view === 'boltzmann' && (
                                <div className="w-full h-full flex flex-col">
                                    <h2 className="text-lg font-bold text-white mb-4 flex items-center gap-2">
                                        <Icon name="bar-chart" className="text-blue-400"/> Maxwell-Boltzmann Distribution
                                    </h2>
                                    <ResponsiveContainer width="100%" height="100%">
                                        <ComposedChart data={MB_DATA} margin={{ top: 20, right: 30, left: 0, bottom: 0 }}>
                                            <CartesianGrid strokeDasharray="3 3" stroke="#334155" />
                                            <XAxis dataKey="energy" label={{ value: 'Kinetic Energy', position: 'insideBottom', fill: '#94a3b8' }} />
                                            <YAxis label={{ value: 'Number of Particles', angle: -90, position: 'insideLeft', fill: '#94a3b8' }} />
                                            
                                            {/* The Curve */}
                                            <Area type="monotone" dataKey="particles" stroke="#60a5fa" fill="#3b82f6" fillOpacity={0.2} strokeWidth={2} />

                                            {/* Ea Line Uncatalyzed */}
                                            <ReferenceLine x={70} stroke="#ef4444" label={{ value: "Ea (Uncat)", fill: "#ef4444", position: 'top' }} />
                                            
                                            {/* Ea Line Catalyzed */}
                                            {showCatalyzed && (
                                                <ReferenceLine x={50} stroke="#10b981" strokeDasharray="5 5" label={{ value: "Ea (Cat)", fill: "#10b981", position: 'top' }} />
                                            )}
                                        </ComposedChart>
                                    </ResponsiveContainer>
                                    <div className="text-center text-sm text-slate-400 mt-4">
                                        Shaded area beyond Ea represents particles with sufficient energy to react. <br/>
                                        <span className="text-emerald-400 font-bold">Catalyst moves Ea to the left</span>, increasing this area.
                                    </div>
                                </div>
                            )}

                            {view === 'mechanism' && (
                                <div className="w-full h-full flex flex-col items-center justify-center">
                                    <h2 className="text-lg font-bold text-white mb-4 flex items-center gap-2 self-start">
                                        <Icon name="settings" className="text-purple-400"/> {mechanismType === 'hetero' ? 'Heterogeneous Catalysis' : 'Homogeneous Catalysis'}
                                    </h2>
                                    
                                    <div className="w-full max-w-lg aspect-video bg-slate-900 rounded-2xl border border-slate-700 overflow-hidden relative">
                                        {mechanismType === 'hetero' ? (
                                            <HeteroAnimation isPlaying={isPlaying} />
                                        ) : (
                                            <HomoAnimation isPlaying={isPlaying} />
                                        )}
                                    </div>

                                    <div className="mt-6 bg-slate-700/50 p-4 rounded-xl border border-slate-600 w-full">
                                        <h4 className="text-xs font-bold text-slate-400 uppercase mb-2">Key Concept</h4>
                                        <p className="text-sm text-white">
                                            {mechanismType === 'hetero' 
                                                ? "Adsorption weakens bonds in reactant molecules, making them easier to react. The product then desorbs from the surface." 
                                                : "Catalyst forms a temporary intermediate species with reactants, providing an alternative pathway with lower activation energy."}
                                        </p>
                                    </div>
                                </div>
                            )}

                        </div>
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
