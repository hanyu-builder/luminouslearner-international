<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electroplating Lab - LuminousLearner International</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #e2e8f0; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Beaker Liquid */
        .liquid { transition: background-color 0.5s; }
        
        /* Bubble Animation */
        @keyframes rise {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(-60px) scale(1.2); opacity: 0; }
        }
        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            animation: rise 2s infinite linear;
        }

        /* Ion Movement */
        @keyframes move-ion {
            0% { transform: translate(0, 0); opacity: 0; }
            10% { opacity: 1; }
            90% { transform: translate(var(--tx), var(--ty)); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)); opacity: 0; }
        }
        .ion-anim {
            animation: move-ion 2s infinite linear;
        }

        /* Plating Growth */
        .plating-layer {
            transition: opacity 0.2s;
        }

        /* Electron Flow Animation */
        @keyframes electron-flow {
            0% { stroke-dashoffset: 20; }
            100% { stroke-dashoffset: 0; }
        }
        .wire-active {
            stroke-dasharray: 5;
            animation: electron-flow 0.5s linear infinite;
        }
        
        /* Slider Styles */
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%;
            background: #ffffff; border: 2px solid currentColor; margin-top: -6px; cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="root" class="flex-grow flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const Metals = [
            { id: 'Cu', name: 'Copper (Cu)', ion: 'Cu²⁺', color: 'bg-orange-600', liquidColor: 'bg-blue-500/40', platingColor: 'rgba(249, 115, 22, 0.9)', atomicMass: 63.5, charge: 2 },
            { id: 'Ag', name: 'Silver (Ag)', ion: 'Ag⁺', color: 'bg-slate-400', liquidColor: 'bg-slate-500/40', platingColor: 'rgba(203, 213, 225, 0.9)', atomicMass: 107.9, charge: 1 },
            { id: 'Ni', name: 'Nickel (Ni)', ion: 'Ni²⁺', color: 'bg-emerald-600', liquidColor: 'bg-emerald-500/40', platingColor: 'rgba(22, 163, 74, 0.9)', atomicMass: 58.7, charge: 2 }
        ];

        const Objects = [
            { id: 'Key', name: 'Iron Key', icon: 'Key', baseColor: 'text-slate-500' },
            { id: 'Spoon', name: 'Iron Spoon', icon: 'Utensils', baseColor: 'text-slate-400' },
            { id: 'Coin', name: 'Coin', icon: 'Circle', baseColor: 'text-yellow-600' }
        ];

        const Icon = ({ name, size = 20, className = "" }) => {
            const [svg, setSvg] = useState('');
            useEffect(() => {
                if (window.lucide) {
                    const iconNode = window.lucide.icons[name];
                    if (iconNode) {
                        const iconSvg = window.lucide.createElement(iconNode);
                        iconSvg.setAttribute('width', size);
                        iconSvg.setAttribute('height', size);
                        iconSvg.setAttribute('class', className);
                        setSvg(iconSvg.outerHTML);
                    }
                }
            }, [name, size, className]);
            return <span dangerouslySetInnerHTML={{ __html: svg }} className="flex items-center" />;
        };

        const ObjectIcon = ({ type, className, style }) => {
            if (type === 'Key') return <svg viewBox="0 0 24 24" fill="currentColor" className={className} style={style}><path d="M21 2l-2 2m-7.6 7.6l6.5-6.5a2 2 0 0 0-2.8-2.8l-6.5 6.5a2 2 0 0 0-.6 1.5l-.4 1.4-2 2-2-2-2 2 2 2 2 2 2 2-2 2-1.4.4a2 2 0 0 0-1.5.6l-2.6 2.6a2 2 0 0 0 2.8 2.8l2.6-2.6"/></svg>;
            if (type === 'Spoon') return <svg viewBox="0 0 24 24" fill="currentColor" className={className} style={style}><path d="M12 2a4 4 0 0 1 4 4c0 2-1.5 3.5-3.5 4L12 22 9.5 10C7.5 9.5 6 8 6 6a4 4 0 0 1 6-4z"/></svg>; 
            if (type === 'Coin') return <svg viewBox="0 0 24 24" fill="currentColor" className={className} style={style}><circle cx="12" cy="12" r="10"/></svg>;
            return null;
        };

        const App = () => {
            // Settings
            const [platingMetal, setPlatingMetal] = useState(Metals[0]); // Copper
            const [targetObject, setTargetObject] = useState(Objects[0]); // Key
            const [current, setCurrent] = useState(1.0); // Amps
            const [time, setTime] = useState(0); // Seconds
            const [isRunning, setIsRunning] = useState(false);
            
            // Simulation State
            const [massDeposited, setMassDeposited] = useState(0);
            const [thickness, setThickness] = useState(0); // 0-100% visual opacity
            const [anodeMassLoss, setAnodeMassLoss] = useState(0);

            // Constants
            const FARADAY = 96500; // C/mol

            // Timer & Calculation Loop
            useEffect(() => {
                let interval;
                if (isRunning) {
                    interval = setInterval(() => {
                        setTime(prev => {
                            const newTime = prev + 1;
                            
                            // Calculate Mass: m = (I * t * M) / (z * F)
                            const m = (current * newTime * platingMetal.atomicMass) / (platingMetal.charge * FARADAY);
                            setMassDeposited(m);
                            
                            setAnodeMassLoss(m);

                            const visualScale = m * 100; 
                            setThickness(Math.min(100, visualScale));

                            return newTime;
                        });
                    }, 100); 
                }
                return () => clearInterval(interval);
            }, [isRunning, current, platingMetal]);

            const reset = () => {
                setIsRunning(false);
                setTime(0);
                setMassDeposited(0);
                setThickness(0);
                setAnodeMassLoss(0);
            };

            return (
                <div className="flex flex-col h-full container mx-auto px-4 py-6 max-w-5xl">
                    
                    {/* Header */}
                    <div className="flex justify-between items-center mb-6 border-b border-slate-800 pb-4">
                        <div>
                            <h1 className="text-2xl font-bold text-indigo-400 flex items-center gap-2">
                                <Icon name="Layers" /> Electroplating Lab
                            </h1>
                            <p className="text-slate-500 text-sm">Electrolysis Application: Plating Metals</p>
                        </div>
                        <button onClick={reset} className="px-4 py-2 bg-slate-800 text-slate-400 rounded-lg hover:bg-slate-700 hover:text-white font-bold text-sm flex items-center gap-2 transition-colors border border-slate-700">
                            <Icon name="RotateCcw" size={16} /> Reset
                        </button>
                    </div>

                    <div className="flex flex-col lg:flex-row gap-8 flex-grow">
                        
                        {/* Left: Controls */}
                        <div className="w-full lg:w-1/3 flex flex-col gap-6">
                            
                            <div className="bg-slate-900 p-6 rounded-2xl shadow-xl border border-slate-800">
                                <h3 className="text-sm font-bold text-slate-400 uppercase mb-4 flex items-center gap-2">
                                    <Icon name="Sliders" size={16}/> Parameters
                                </h3>

                                {/* Metal Selection */}
                                <div className="mb-6">
                                    <label className="text-xs font-bold text-indigo-400 block mb-2">Anode / Electrolyte</label>
                                    <div className="grid grid-cols-3 gap-2">
                                        {Metals.map(m => (
                                            <button 
                                                key={m.id}
                                                onClick={() => { setPlatingMetal(m); reset(); }}
                                                className={`p-2 rounded-lg border text-xs font-bold transition-all flex flex-col items-center gap-1
                                                    ${platingMetal.id === m.id ? 'bg-indigo-900/50 border-indigo-500 text-indigo-300' : 'bg-slate-800 border-slate-700 text-slate-500 hover:bg-slate-700'}
                                                `}
                                            >
                                                <div className={`w-4 h-4 rounded-full ${m.color}`}></div>
                                                {m.name.split(' ')[0]}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {/* Object Selection */}
                                <div className="mb-6">
                                    <label className="text-xs font-bold text-slate-400 block mb-2">Cathode (Object to Plate)</label>
                                    <div className="flex gap-2">
                                        {Objects.map(o => (
                                            <button 
                                                key={o.id}
                                                onClick={() => { setTargetObject(o); reset(); }}
                                                className={`flex-1 p-2 rounded-lg border text-xs font-bold transition-all
                                                    ${targetObject.id === o.id ? 'bg-slate-800 border-slate-500 text-slate-200' : 'bg-slate-900 border-slate-700 text-slate-500 hover:bg-slate-800'}
                                                `}
                                            >
                                                {o.name}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {/* Current Slider */}
                                <div className="mb-6">
                                    <div className="flex justify-between mb-2">
                                        <label className="text-xs font-bold text-slate-400">Current (I)</label>
                                        <span className="text-sm font-mono font-bold text-indigo-400">{current.toFixed(1)} A</span>
                                    </div>
                                    <input 
                                        type="range" 
                                        min="0.1" max="5.0" step="0.1" 
                                        value={current}
                                        onChange={(e) => setCurrent(parseFloat(e.target.value))}
                                        disabled={isRunning}
                                        className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-indigo-500"
                                    />
                                </div>

                                <button 
                                    onClick={() => setIsRunning(!isRunning)}
                                    className={`w-full py-3 rounded-xl font-bold text-white shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2
                                        ${isRunning ? 'bg-red-600 hover:bg-red-500' : 'bg-emerald-600 hover:bg-emerald-500'}
                                    `}
                                >
                                    {isRunning ? <Icon name="Pause" /> : <Icon name="Play" />}
                                    {isRunning ? 'Stop Plating' : 'Start Plating'}
                                </button>
                            </div>

                            {/* Real-time Data */}
                            <div className="bg-slate-900 p-5 rounded-2xl text-white shadow-lg border border-slate-800">
                                <h3 className="text-sm font-bold text-yellow-400 uppercase mb-3 flex items-center gap-2">
                                    <Icon name="Activity" size={16}/> Live Data
                                </h3>
                                <div className="space-y-3 font-mono text-sm">
                                    <div className="flex justify-between border-b border-slate-700 pb-1">
                                        <span className="text-slate-400">Time (t):</span>
                                        <span>{time.toFixed(0)} s</span>
                                    </div>
                                    <div className="flex justify-between border-b border-slate-700 pb-1">
                                        <span className="text-slate-400">Mass Deposited:</span>
                                        <span className="text-emerald-400 font-bold">{massDeposited.toFixed(4)} g</span>
                                    </div>
                                    <div className="flex justify-between border-b border-slate-700 pb-1">
                                        <span className="text-slate-400">Anode Mass Loss:</span>
                                        <span className="text-red-400">-{anodeMassLoss.toFixed(4)} g</span>
                                    </div>
                                </div>
                                <div className="mt-3 text-[10px] text-slate-500">
                                    Formula: m = (I × t × M) ÷ (z × F)
                                </div>
                            </div>

                        </div>

                        {/* Right: Visualization */}
                        <div className="w-full lg:w-2/3 flex flex-col gap-6 items-center justify-center bg-slate-900 rounded-3xl border-4 border-slate-800 relative overflow-hidden min-h-[500px] p-8">
                            
                            {/* Background Grid */}
                            <div className="absolute inset-0 opacity-5" style={{backgroundImage: 'radial-gradient(#fff 1px, transparent 1px)', backgroundSize: '20px 20px'}}></div>

                            {/* Circuit & Power Source */}
                            <div className="relative w-full max-w-md h-96 flex flex-col items-center justify-end">
                                
                                {/* Power Source & Wires (Top Section) */}
                                <div className="absolute top-0 w-full flex justify-center z-10">
                                    {/* Battery */}
                                    <div className="relative bg-slate-800 text-white px-6 py-3 rounded-lg shadow-lg border-2 border-slate-600 flex flex-col items-center">
                                        <div className="text-yellow-400 font-mono font-bold text-lg">DC {current.toFixed(1)}A</div>
                                        <div className="text-[10px] text-slate-400 uppercase font-bold">Power Source</div>
                                        <div className="absolute -bottom-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-slate-800 rotate-45 z-0"></div>
                                    </div>
                                    
                                    {/* Wires SVG */}
                                    <svg className="absolute top-8 w-full h-24 pointer-events-none overflow-visible" style={{zIndex: -1}}>
                                        {/* Left Wire (Anode, +) */}
                                        <path d="M 50% 10 H 15% V 100" fill="none" stroke="#ef4444" strokeWidth="4" className={isRunning ? 'wire-active' : ''} />
                                        {/* Right Wire (Cathode, -) */}
                                        <path d="M 50% 10 H 85% V 100" fill="none" stroke="#374151" strokeWidth="4" className={isRunning ? 'wire-active' : ''} />
                                        
                                        {/* Polarity Signs */}
                                        <text x="15%" y="90" fill="#ef4444" fontSize="24" fontWeight="bold" textAnchor="middle">+</text>
                                        <text x="85%" y="90" fill="#94a3b8" fontSize="24" fontWeight="bold" textAnchor="middle">-</text>
                                    </svg>
                                </div>

                                {/* Beaker */}
                                <div className="w-80 h-64 border-4 border-slate-600 border-t-0 rounded-b-3xl bg-white/5 backdrop-blur-sm relative overflow-hidden shadow-xl mt-16">
                                    {/* Electrolyte */}
                                    <div className={`absolute bottom-0 w-full h-[85%] ${platingMetal.liquidColor} liquid`}></div>
                                    
                                    {/* Anode (Metal Bar) - Left */}
                                    <div className="absolute left-12 top-0 w-12 h-full flex flex-col items-center">
                                         {/* Wire Connection Point */}
                                        <div className="w-1 h-4 bg-black absolute -top-4"></div>
                                        
                                        <div className={`w-8 h-48 ${platingMetal.color} border-2 border-slate-500 rounded-b-md shadow-md transition-all relative`}
                                             style={{ 
                                                 // Visualize erosion
                                                 clipPath: `polygon(0 0, 100% 0, 100% ${100 - anodeMassLoss*50}%, 80% 100%, 20% 100%, 0 ${100 - anodeMassLoss*50}%)`
                                             }}>
                                        </div>
                                        {/* Label */}
                                        <div className="absolute -top-8 bg-slate-800 px-2 py-0.5 rounded text-[10px] font-bold text-red-400 shadow-sm border border-red-900/50">Anode (+)</div>
                                        <div className="absolute top-2 text-[9px] font-bold text-white/90 pointer-events-none">{platingMetal.name.split(' ')[0]}</div>
                                    </div>

                                    {/* Cathode (Object) - Right */}
                                    <div className="absolute right-12 top-0 w-16 h-full flex flex-col items-center">
                                        {/* Wire Connection Point */}
                                        <div className="w-1 h-8 bg-black absolute -top-8"></div>
                                        
                                        {/* Label */}
                                        <div className="absolute -top-8 bg-slate-800 px-2 py-0.5 rounded text-[10px] font-bold text-slate-300 shadow-sm border border-slate-600">Cathode (-)</div>

                                        <div className="relative w-full h-40 flex justify-center mt-2">
                                            {/* Base Object */}
                                            <ObjectIcon type={targetObject.id} className={`w-16 h-32 ${targetObject.baseColor}`} />
                                            
                                            {/* Plating Layer Overlay */}
                                            <ObjectIcon 
                                                type={targetObject.id} 
                                                className="w-16 h-32 absolute inset-0 plating-layer" 
                                                style={{ 
                                                    color: platingMetal.platingColor, 
                                                    opacity: Math.min(1, thickness / 50), // Opacity builds up
                                                    filter: `drop-shadow(0 0 ${thickness/10}px ${platingMetal.platingColor})`
                                                }} 
                                            />
                                        </div>
                                    </div>

                                    {/* Ion Animation */}
                                    {isRunning && (
                                        <div className="absolute inset-0 pointer-events-none overflow-hidden">
                                            {/* Cations moving Anode -> Cathode */}
                                            {[...Array(5)].map((_, i) => (
                                                <div key={i} className="absolute w-4 h-4 bg-white/80 rounded-full flex items-center justify-center text-[8px] font-bold text-slate-700 border border-slate-400 shadow-sm ion-anim"
                                                     style={{
                                                         left: '20%', top: '40%',
                                                         '--tx': '180px', '--ty': `${(i-2)*20}px`,
                                                         animationDelay: `${i * 0.5}s`,
                                                         animationDuration: `${3 - current * 0.4}s` // Speed depends on current
                                                     }}>
                                                    {platingMetal.ion.replace(/\d+\+/, '+')}
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                </div>
                            </div>

                            {/* Legend */}
                            <div className="flex gap-6 text-xs text-slate-400 font-bold mt-4">
                                <div className="flex items-center gap-2">
                                    <div className={`w-3 h-3 rounded ${platingMetal.color}`}></div>
                                    <span>Anode: {platingMetal.name.split(' ')[0]} (Oxidation)</span>
                                </div>
                                <div className="flex items-center gap-2">
                                    <div className="w-3 h-3 rounded bg-slate-600"></div>
                                    <span>Cathode: {targetObject.name} (Reduction)</span>
                                </div>
                            </div>

                        </div>
                    </div>
                    
                    <div className="text-center text-slate-600 text-xs mt-8 border-t border-slate-800 pt-4">
                        Luminous Learner International | IB/A-Level Chemistry
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
