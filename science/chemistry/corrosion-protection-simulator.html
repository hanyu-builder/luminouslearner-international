<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corrosion Protection Lab</title>
    
    <!-- React & Tailwind -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #e2e8f0; margin: 0; overflow: hidden; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Cloud Animation for Indicators */
        .cloud {
            filter: blur(12px);
            opacity: 0.7;
            transition: width 0.5s ease-out, height 0.5s ease-out, opacity 0.5s;
        }
        
        .electron-flow {
            stroke-dasharray: 5;
            animation: dash 1s linear infinite;
        }
        
        @keyframes dash {
            to { stroke-dashoffset: -10; }
        }

        .petri-dish {
            box-shadow: inset 0 0 40px rgba(0,0,0,0.2), 0 10px 20px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const Icon = ({ name, className = "", size = 20 }) => {
            const [svgHtml, setSvgHtml] = useState('');
            useEffect(() => {
                if (window.lucide && window.lucide.icons) {
                    const pascalName = name.split('-').map(part => part.charAt(0).toUpperCase() + part.slice(1)).join('');
                    const iconData = window.lucide.icons[pascalName];
                    if (iconData && typeof window.lucide.createElement === 'function') {
                        try {
                            const svgElement = window.lucide.createElement(iconData);
                            svgElement.setAttribute('class', className);
                            svgElement.setAttribute('width', size);
                            svgElement.setAttribute('height', size);
                            setSvgHtml(svgElement.outerHTML);
                        } catch (e) {}
                    }
                }
            }, [name, className, size]);
            if (!svgHtml) return <span className={className} style={{ width: size, height: size, display: 'inline-block' }}></span>;
            return <span dangerouslySetInnerHTML={{ __html: svgHtml }} className="flex items-center justify-center" />;
        };

        // --- DATA (Translated) ---
        const CONDITIONS = {
            none: { name: 'Iron Nail Only', type: 'control', desc: 'Control experiment. Iron oxidizes to form Fe²⁺ ions (Blue) and OH⁻ ions (Pink).', status: 'Rusted' },
            mg: { name: 'Wrapped with Magnesium', type: 'sacrificial', desc: 'Mg is more reactive than Fe. Mg donates electrons to Fe, preventing rust.', status: 'Protected' },
            zn: { name: 'Wrapped with Zinc', type: 'sacrificial', desc: 'Zn is more reactive than Fe. Zn becomes the sacrificial anode.', status: 'Protected' },
            cu: { name: 'Wrapped with Copper', type: 'sacrificial', desc: 'Cu is less reactive. Iron gives electrons to Copper, speeding up rust!', status: 'Rusted' },
            cathode: { name: 'Connected to Negative (-)', type: 'impressed', desc: 'Cathodic Protection: Electrons are pumped into the iron, preventing oxidation.', status: 'Protected' },
            anode: { name: 'Connected to Positive (+)', type: 'impressed', desc: 'Iron forced to be the Anode. Oxidation happens rapidly.', status: 'Rusted' }
        };

        // Symbol map for the visualizer
        const SYMBOLS = {
            mg: 'Mg',
            zn: 'Zn',
            cu: 'Cu'
        };

        // --- VISUALIZER COMPONENT ---
        const PetriDish = ({ condition, progress }) => {
            // progress: 0 to 100%
            
            let blueIntensity = 0;
            let pinkIntensity = 0;
            
            switch (condition) {
                case 'none':
                    blueIntensity = progress * 0.8;
                    pinkIntensity = progress * 0.8;
                    break;
                    
                case 'mg':
                case 'zn':
                    blueIntensity = 0;
                    pinkIntensity = progress * 1.0;
                    break;
                    
                case 'cu':
                    blueIntensity = progress * 1.2;
                    pinkIntensity = progress * 0.8;
                    break;
                    
                case 'cathode':
                    blueIntensity = 0;
                    pinkIntensity = progress * 1.2;
                    break;
                    
                case 'anode':
                    blueIntensity = progress * 1.5;
                    pinkIntensity = 0; 
                    break;
                    
                default: break;
            }

            const blueSize = 30 + blueIntensity * 80;
            const pinkSize = 30 + pinkIntensity * 80;
            const currentStatus = CONDITIONS[condition].status;

            return (
                <div className="relative w-80 h-80 bg-[#E0F2FE] rounded-full petri-dish flex items-center justify-center overflow-hidden border-4 border-slate-300/50">
                    {/* Agar Gel Background Label */}
                    <div className="absolute top-6 bg-white/60 backdrop-blur-sm px-3 py-1 rounded-full text-slate-600 font-bold text-[10px] uppercase tracking-widest pointer-events-none shadow-sm border border-white/40">
                        Agar Gel + Ferroxyl Indicator
                    </div>

                    {/* --- CHEMICAL CLOUDS --- */}
                    
                    {/* Blue Clouds (Rust / Fe2+) */}
                    {(condition === 'none' || condition === 'cu' || condition === 'anode') && (
                        <>
                            <div className="absolute bg-blue-600 rounded-full cloud mix-blend-multiply" 
                                 style={{ width: blueSize, height: blueSize, left: '15%', top: '40%', opacity: Math.min(0.8, blueIntensity/100) }}></div>
                            <div className="absolute bg-blue-600 rounded-full cloud mix-blend-multiply" 
                                 style={{ width: blueSize, height: blueSize, right: '15%', top: '40%', opacity: Math.min(0.8, blueIntensity/100) }}></div>
                             {condition === 'anode' && (
                                 <div className="absolute bg-blue-600 rounded-full cloud mix-blend-multiply" 
                                 style={{ width: blueSize*1.5, height: blueSize, left: '30%', top: '40%', opacity: Math.min(0.8, blueIntensity/100) }}></div>
                             )}
                        </>
                    )}

                    {/* Pink Clouds (OH-) */}
                    {(condition === 'none' || condition === 'mg' || condition === 'zn' || condition === 'cathode' || condition === 'cu') && (
                        <>
                            <div className="absolute bg-pink-500 rounded-full cloud mix-blend-multiply" 
                                 style={{ 
                                     width: condition === 'cu' ? pinkSize * 0.6 : pinkSize * 1.2, 
                                     height: condition === 'cu' ? pinkSize * 0.6 : pinkSize, 
                                     left: '40%', top: '35%', 
                                     opacity: Math.min(0.8, pinkIntensity/100) 
                                 }}></div>
                        </>
                    )}

                    {/* --- THE IRON NAIL --- */}
                    <div className="relative z-10 w-48 h-4 bg-gradient-to-b from-slate-400 to-slate-600 rounded-r-full shadow-lg flex items-center justify-center">
                        {/* Nail Head */}
                        <div className="absolute -left-2 top-1/2 -translate-y-1/2 w-4 h-8 bg-gradient-to-b from-slate-500 to-slate-700 rounded-sm"></div>
                        
                        {/* Wrapped Metal Strip - Fixed Symbol */}
                        {(condition === 'mg' || condition === 'zn' || condition === 'cu') && (
                            <div className={`absolute left-1/2 -translate-x-1/2 w-8 h-6 rounded border border-black/20 shadow-sm flex items-center justify-center
                                ${condition === 'mg' ? 'bg-slate-200' : condition === 'zn' ? 'bg-slate-400' : 'bg-orange-400'}`}>
                                <span className="text-[10px] font-bold text-slate-800">
                                    {SYMBOLS[condition]}
                                </span>
                            </div>
                        )}

                        {/* Impressed Current Wires */}
                        {(condition === 'cathode' || condition === 'anode') && (
                            <svg className="absolute left-1/2 top-0 overflow-visible" width="100" height="100" style={{transform: 'translate(-50%, -50%)'}}>
                                <path d="M 50 20 L 50 -50" stroke="#333" strokeWidth="2" fill="none" />
                                <rect x="46" y="16" width="8" height="10" fill="#475569" />
                                <circle cx="50" cy="-60" r="15" fill={condition === 'cathode' ? '#22c55e' : '#ef4444'} />
                                <text x="50" y="-60" textAnchor="middle" dominantBaseline="middle" fill="white" fontWeight="bold" fontSize="16">
                                    {condition === 'cathode' ? '-' : '+'}
                                </text>
                            </svg>
                        )}
                    </div>

                    {/* Electrons Flow Animation */}
                    {progress > 0 && (condition !== 'none') && (
                        <div className="absolute top-20 text-xs font-bold text-slate-500 flex items-center gap-1 bg-white/80 px-2 py-1 rounded-full backdrop-blur shadow-sm">
                            <span className="text-yellow-500">e⁻</span> Flow: 
                            {condition === 'mg' || condition === 'zn' ? ' Metal → Iron' : 
                             condition === 'cu' ? ' Iron → Copper' :
                             condition === 'cathode' ? ' Battery → Iron' : ' Iron → Battery'}
                        </div>
                    )}

                    {/* Result Badge */}
                    {progress > 10 && (
                        <div className="absolute bottom-6 flex justify-center w-full pointer-events-none">
                            <div className={`px-4 py-1.5 rounded-full text-xs font-black shadow-lg border-2 flex items-center gap-2 backdrop-blur-md animate-[fadeIn_0.5s_ease-out_forwards]
                                ${currentStatus === 'Protected' 
                                    ? 'bg-emerald-500/90 border-emerald-400 text-white' 
                                    : 'bg-red-500/90 border-red-400 text-white'
                                }`}
                            >
                                <Icon name={currentStatus === 'Protected' ? 'shield-check' : 'alert-triangle'} size={16} className="text-white" />
                                {currentStatus.toUpperCase()}
                            </div>
                        </div>
                    )}

                </div>
            );
        };

        // --- MAIN APP ---
        const App = () => {
            const [condition, setCondition] = useState('none');
            const [progress, setProgress] = useState(0);
            const [isRunning, setIsRunning] = useState(false);

            const currentData = CONDITIONS[condition];

            // Simulation Loop
            useEffect(() => {
                let interval;
                if (isRunning) {
                    interval = setInterval(() => {
                        setProgress(p => {
                            if (p >= 100) {
                                setIsRunning(false);
                                return 100;
                            }
                            return p + 1;
                        });
                    }, 50);
                }
                return () => clearInterval(interval);
            }, [isRunning]);

            const handleStart = () => {
                setProgress(0);
                setIsRunning(true);
            };

            const handleReset = () => {
                setProgress(0);
                setIsRunning(false);
            };

            const handleSelect = (key) => {
                setCondition(key);
                handleReset();
            };

            return (
                <div className="min-h-screen bg-[#0F172A] text-white flex flex-col md:flex-row overflow-hidden">
                    
                    {/* Sidebar */}
                    <div className="w-full md:w-80 bg-slate-900 border-r border-slate-800 flex flex-col z-10 shadow-xl h-screen shrink-0">
                        <div className="p-6 border-b border-slate-800">
                            <h1 className="text-xl font-bold flex items-center gap-2">
                                <Icon name="shield-check" className="text-emerald-400" /> Corrosion Lab
                            </h1>
                            <p className="text-xs text-slate-400 mt-1">Protection Methods Simulator</p>
                        </div>

                        <div className="p-4 space-y-6 flex-1 overflow-y-auto">
                            
                            {/* Sacrificial */}
                            <div>
                                <label className="text-xs font-bold text-slate-500 uppercase tracking-widest px-1 mb-2 block">Sacrificial Protection</label>
                                <div className="space-y-2">
                                    {['none', 'mg', 'zn', 'cu'].map(key => {
                                        const data = CONDITIONS[key];
                                        return (
                                            <button 
                                                key={key}
                                                onClick={() => handleSelect(key)}
                                                className={`w-full text-left p-3 rounded-xl border transition-all flex items-center justify-between
                                                    ${condition === key 
                                                        ? 'bg-slate-800 border-emerald-500 text-white' 
                                                        : 'bg-slate-900/50 border-slate-700 text-slate-400 hover:bg-slate-800'}
                                                `}
                                            >
                                                <div className="flex items-center gap-3">
                                                    <div className={`w-3 h-3 rounded-full ${key === 'none' ? 'bg-slate-500' : key === 'mg' ? 'bg-slate-200' : key === 'zn' ? 'bg-slate-400' : 'bg-orange-400'}`}></div>
                                                    <span className="text-sm font-bold">{data.name}</span>
                                                </div>
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>

                            {/* Impressed Current */}
                            <div>
                                <label className="text-xs font-bold text-slate-500 uppercase tracking-widest px-1 mb-2 block">Impressed Current</label>
                                <div className="space-y-2">
                                    {['cathode', 'anode'].map(key => {
                                        const data = CONDITIONS[key];
                                        return (
                                            <button 
                                                key={key}
                                                onClick={() => handleSelect(key)}
                                                className={`w-full text-left p-3 rounded-xl border transition-all flex items-center justify-between
                                                    ${condition === key 
                                                        ? 'bg-slate-800 border-blue-500 text-white' 
                                                        : 'bg-slate-900/50 border-slate-700 text-slate-400 hover:bg-slate-800'}
                                                `}
                                            >
                                                <div className="flex items-center gap-3">
                                                    <Icon name={key === 'cathode' ? 'battery-charging' : 'battery-warning'} size={16} className={key === 'cathode' ? 'text-green-400' : 'text-red-400'}/>
                                                    <span className="text-sm font-bold">{data.name}</span>
                                                </div>
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>

                        </div>

                        {/* Legend */}
                        <div className="p-4 bg-slate-800 border-t border-slate-700">
                            <div className="text-xs font-bold text-slate-500 uppercase mb-2">Indicator Key</div>
                            <div className="flex gap-4">
                                <div className="flex items-center gap-2">
                                    <div className="w-3 h-3 rounded-full bg-blue-600"></div>
                                    <span className="text-xs text-blue-300">Rust (Fe²⁺)</span>
                                </div>
                                <div className="flex items-center gap-2">
                                    <div className="w-3 h-3 rounded-full bg-pink-500"></div>
                                    <span className="text-xs text-pink-300">Protected (OH⁻)</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Main Stage */}
                    <div className="flex-1 relative bg-[#020617] overflow-hidden flex flex-col">
                        
                        {/* Visualizer */}
                        <div className="flex-1 relative flex items-center justify-center p-8 bg-slate-900/50">
                            <PetriDish condition={condition} progress={progress} />
                        </div>

                        {/* Control Deck */}
                        <div className="bg-slate-800 border-t border-slate-700 p-6 md:p-8 flex flex-col md:flex-row gap-8 items-center z-20">
                            
                            {/* Progress Controls */}
                            <div className="flex items-center gap-4 w-full md:w-auto">
                                <button 
                                    onClick={isRunning ? () => setIsRunning(false) : handleStart}
                                    className={`w-14 h-14 rounded-full flex items-center justify-center shadow-lg transition-all hover:scale-105 active:scale-95 shrink-0 ${isRunning ? 'bg-yellow-600 text-white' : 'bg-emerald-600 text-white'}`}
                                >
                                    <Icon name={isRunning ? "pause" : "play"} size={24} fill="currentColor" />
                                </button>
                                
                                <div className="flex-1 md:w-64">
                                    <div className="flex justify-between text-xs font-bold text-slate-400 uppercase mb-2">
                                        <span>Start</span>
                                        <span>1 day later</span>
                                    </div>
                                    <div className="h-2 bg-slate-700 rounded-full overflow-hidden">
                                        <div className="h-full bg-emerald-500 transition-all duration-100 ease-linear" style={{width: `${progress}%`}}></div>
                                    </div>
                                </div>

                                <button 
                                    onClick={handleReset}
                                    className="p-3 rounded-xl hover:bg-slate-700 text-slate-400 hover:text-white transition-colors"
                                    title="Reset"
                                >
                                    <Icon name="rotate-ccw" size={20} />
                                </button>
                            </div>

                            {/* Result Info */}
                            <div className="flex-1 bg-slate-900/50 p-4 rounded-xl border border-slate-600 w-full">
                                <h3 className="text-sm font-bold text-white mb-2 flex items-center gap-2">
                                    <Icon name="microscope" size={16} className="text-blue-400" /> Observation
                                </h3>
                                <p className="text-sm text-slate-300 leading-relaxed">
                                    {currentData.desc}
                                </p>
                            </div>

                        </div>
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
