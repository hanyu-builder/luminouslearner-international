<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fractional Distillation of Liquid Air - LuminousLearner International</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #e2e8f0; }
        .font-mono { font-family: 'Roboto Mono', monospace; }
        
        /* Bubble Animation */
        @keyframes bubble {
            0% { transform: translateY(0) scale(1); opacity: 0.8; }
            50% { opacity: 1; }
            100% { transform: translateY(-150px) scale(1.2); opacity: 0; }
        }
        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            animation: bubble 2s infinite ease-in;
        }
        
        /* Liquid Wave */
        @keyframes liquid-wave {
            0% { transform: skewY(0deg); }
            25% { transform: skewY(1deg); }
            75% { transform: skewY(-1deg); }
            100% { transform: skewY(0deg); }
        }
        .liquid-surface {
            animation: liquid-wave 3s infinite ease-in-out;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="root" class="flex-grow flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const Icon = ({ name, size = 20, className = "" }) => {
            const [svg, setSvg] = useState('');
            useEffect(() => {
                if (window.lucide) {
                    const iconNode = window.lucide.icons[name];
                    if (iconNode) {
                        const iconSvg = window.lucide.createElement(iconNode);
                        iconSvg.setAttribute('width', size);
                        iconSvg.setAttribute('height', size);
                        iconSvg.setAttribute('class', className);
                        setSvg(iconSvg.outerHTML);
                    }
                }
            }, [name, size, className]);
            return <span dangerouslySetInnerHTML={{ __html: svg }} className="flex items-center" />;
        };

        const App = () => {
            const [stage, setStage] = useState('prep'); // prep, liquefy, distillation
            const [impuritiesRemoved, setImpuritiesRemoved] = useState({ dust: false, co2_water: false });
            const [temperature, setTemperature] = useState(-200);
            const [collectedGas, setCollectedGas] = useState({ nitrogen: 0, argon: 0, oxygen: 0 });
            const [isWarming, setIsWarming] = useState(false);
            
            // Gas Data (Internationalized)
            const Gases = {
                nitrogen: { name: 'Nitrogen', bp: -196, symbol: 'N₂', color: 'bg-blue-600', uses: 'Making Ammonia, Food Packaging, Liquid Nitrogen coolant' },
                argon: { name: 'Argon', bp: -186, symbol: 'Ar', color: 'bg-purple-600', uses: 'Light bulbs, Welding (Inert atmosphere)' },
                oxygen: { name: 'Oxygen', bp: -183, symbol: 'O₂', color: 'bg-green-600', uses: 'Medical breathing support, Steel making, Metal cutting' }
            };

            // Animation Loop for Distillation
            useEffect(() => {
                let interval;
                if (isWarming && stage === 'distillation') {
                    interval = setInterval(() => {
                        setTemperature(prev => {
                            if (prev >= -180) {
                                setIsWarming(false);
                                return -180;
                            }
                            return parseFloat((prev + 0.2).toFixed(1));
                        });
                    }, 50);
                }
                return () => clearInterval(interval);
            }, [isWarming, stage]);

            // Collection Logic
            useEffect(() => {
                if (stage === 'distillation') {
                    // Nitrogen boils at -196
                    if (temperature >= -196 && temperature < -186) {
                        setCollectedGas(prev => ({ ...prev, nitrogen: Math.min(100, prev.nitrogen + 1) }));
                    }
                    // Argon boils at -186
                    if (temperature >= -186 && temperature < -183) {
                        setCollectedGas(prev => ({ ...prev, argon: Math.min(100, prev.argon + 1) }));
                    }
                    // Oxygen boils at -183 (or stays liquid at bottom)
                    if (temperature >= -183) {
                        setCollectedGas(prev => ({ ...prev, oxygen: Math.min(100, prev.oxygen + 1) }));
                    }
                }
            }, [temperature, stage]);

            const resetSimulation = () => {
                setStage('prep');
                setImpuritiesRemoved({ dust: false, co2_water: false });
                setTemperature(-200);
                setCollectedGas({ nitrogen: 0, argon: 0, oxygen: 0 });
                setIsWarming(false);
            };

            const renderBubbles = () => {
                // Simple random bubbles
                return Array.from({ length: 5 }).map((_, i) => (
                    <div key={i} className="bubble" style={{
                        left: `${Math.random() * 80 + 10}%`,
                        bottom: `${Math.random() * 20}%`,
                        width: `${Math.random() * 10 + 5}px`,
                        height: `${Math.random() * 10 + 5}px`,
                        animationDelay: `${Math.random()}s`
                    }}></div>
                ));
            };

            return (
                <div className="flex flex-col h-full container mx-auto px-4 py-6 max-w-5xl">
                    
                    {/* Header */}
                    <div className="flex justify-between items-center mb-6 border-b border-slate-700 pb-4">
                        <div>
                            <h1 className="text-2xl font-bold text-sky-400 flex items-center gap-2">
                                <Icon name="Wind" /> Air Distillation Lab
                            </h1>
                            <p className="text-slate-400 text-sm">Separating Liquid Air</p>
                        </div>
                        <button onClick={resetSimulation} className="px-4 py-2 bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-lg flex items-center gap-2 transition-colors text-sm font-bold border border-slate-600">
                            <Icon name="RotateCcw" size={16} /> Reset
                        </button>
                    </div>

                    {/* Main Content Area */}
                    <div className="flex flex-col lg:flex-row gap-6 flex-grow">
                        
                        {/* Left Column: Simulation Visuals */}
                        <div className="lg:w-2/3 bg-slate-900 rounded-2xl border border-slate-700 shadow-xl overflow-hidden relative min-h-[500px] flex flex-col">
                            
                            {/* Stage 1: Preparation */}
                            {stage === 'prep' && (
                                <div className="flex-grow flex flex-col items-center justify-center p-8 text-center space-y-8 animate-in zoom-in duration-300">
                                    <div className="bg-sky-900/50 p-6 rounded-full mb-4 relative border border-sky-700">
                                        <Icon name="Filter" size={64} className="text-sky-400" />
                                        {impuritiesRemoved.dust && impuritiesRemoved.co2_water && (
                                            <div className="absolute -right-2 -top-2 bg-green-500 text-white p-1 rounded-full shadow-lg">
                                                <Icon name="Check" size={20} />
                                            </div>
                                        )}
                                    </div>
                                    
                                    <div>
                                        <h2 className="text-2xl font-bold text-white mb-2">Step 1: Purification</h2>
                                        <p className="text-slate-400 mb-6 max-w-md mx-auto text-sm">
                                            Before liquefaction, impurities must be removed. Otherwise, they will freeze and block the pipes at low temperatures.
                                        </p>
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-lg">
                                        <button 
                                            onClick={() => setImpuritiesRemoved(prev => ({ ...prev, dust: true }))}
                                            disabled={impuritiesRemoved.dust}
                                            className={`p-4 rounded-xl border-2 flex items-center gap-4 transition-all
                                                ${impuritiesRemoved.dust 
                                                    ? 'border-green-500 bg-green-900/30 text-green-400' 
                                                    : 'border-slate-700 bg-slate-800 hover:border-sky-500 hover:bg-slate-700 text-slate-300'}
                                            `}
                                        >
                                            <div className={`w-8 h-8 rounded-full border-2 flex items-center justify-center ${impuritiesRemoved.dust ? 'border-green-500 bg-green-600 text-white' : 'border-slate-500'}`}>
                                                {impuritiesRemoved.dust && <Icon name="Check" size={16} />}
                                            </div>
                                            <span className="font-bold">Remove Dust</span>
                                        </button>

                                        <button 
                                            onClick={() => setImpuritiesRemoved(prev => ({ ...prev, co2_water: true }))}
                                            disabled={impuritiesRemoved.co2_water}
                                            className={`p-4 rounded-xl border-2 flex items-center gap-4 transition-all
                                                ${impuritiesRemoved.co2_water 
                                                    ? 'border-green-500 bg-green-900/30 text-green-400' 
                                                    : 'border-slate-700 bg-slate-800 hover:border-sky-500 hover:bg-slate-700 text-slate-300'}
                                            `}
                                        >
                                            <div className={`w-8 h-8 rounded-full border-2 flex items-center justify-center ${impuritiesRemoved.co2_water ? 'border-green-500 bg-green-600 text-white' : 'border-slate-500'}`}>
                                                {impuritiesRemoved.co2_water && <Icon name="Check" size={16} />}
                                            </div>
                                            <div className="text-left">
                                                <span className="font-bold block">Remove CO₂ & H₂O</span>
                                                <span className="text-xs opacity-70">Prevent freezing blockages</span>
                                            </div>
                                        </button>
                                    </div>

                                    {impuritiesRemoved.dust && impuritiesRemoved.co2_water && (
                                        <button 
                                            onClick={() => setStage('liquefy')}
                                            className="mt-8 px-8 py-3 bg-sky-600 hover:bg-sky-500 text-white font-bold rounded-full shadow-lg shadow-sky-900/50 transition-all animate-bounce flex items-center gap-2"
                                        >
                                            Next: Liquefaction <Icon name="ArrowRight" size={20}/>
                                        </button>
                                    )}
                                </div>
                            )}

                            {/* Stage 2: Liquefaction */}
                            {stage === 'liquefy' && (
                                <div className="flex-grow flex flex-col items-center justify-center bg-sky-950 text-white p-8 text-center animate-in zoom-in duration-500 relative overflow-hidden">
                                    <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-sky-900 via-slate-900 to-slate-900 -z-10"></div>
                                    <Icon name="Snowflake" size={64} className="mb-6 text-sky-300 animate-spin-slow" />
                                    <h2 className="text-2xl font-bold mb-4 text-sky-200">Compression & Cooling</h2>
                                    <p className="max-w-md mb-8 text-slate-300 text-sm leading-relaxed">
                                        The air is repeatedly compressed and expanded. This process removes heat energy until the temperature drops to around <strong>-200°C</strong>.
                                        <br/><br/>
                                        The air turns into a pale blue liquid.
                                    </p>
                                    <button 
                                        onClick={() => setStage('distillation')}
                                        className="px-8 py-3 bg-white text-sky-900 font-bold rounded-full shadow-lg hover:bg-sky-50 transition-all flex items-center gap-2"
                                    >
                                        <Icon name="FlaskConical" size={20}/> Start Distillation
                                    </button>
                                </div>
                            )}

                            {/* Stage 3: Distillation Column */}
                            {stage === 'distillation' && (
                                <div className="flex-grow relative bg-slate-800 overflow-hidden flex flex-col animate-in fade-in">
                                    
                                    {/* Temperature Display Overlay */}
                                    <div className="absolute top-4 right-4 bg-slate-900/90 backdrop-blur p-4 rounded-xl shadow-lg border border-slate-600 z-20 w-48">
                                        <div className="text-xs text-slate-400 uppercase font-bold mb-1">Column Temp</div>
                                        <div className={`text-3xl font-mono font-bold transition-colors duration-300
                                            ${temperature > -190 ? 'text-red-400' : 'text-sky-400'}
                                        `}>
                                            {temperature.toFixed(1)}°C
                                        </div>
                                        <div className="w-full bg-slate-700 h-2 mt-2 rounded-full overflow-hidden">
                                            <div className="h-full bg-gradient-to-r from-sky-500 to-red-500 transition-all duration-300"
                                                 style={{ width: `${((temperature + 200) / 20) * 100}%` }}></div>
                                        </div>
                                        {isWarming && <div className="text-xs text-orange-400 mt-2 font-bold animate-pulse">Heating...</div>}
                                    </div>

                                    {/* The Column Visual */}
                                    <div className="flex-grow flex justify-center items-end pb-8 relative">
                                        
                                        {/* Column Body */}
                                        <div className="w-48 h-[400px] bg-gradient-to-b from-sky-100 via-sky-200 to-sky-300 border-x-4 border-slate-500 relative rounded-b-lg opacity-90">
                                            
                                            {/* Outlets */}
                                            <div className="absolute top-10 -right-8 w-12 h-4 bg-slate-500 border border-slate-600"></div>
                                            <div className={`absolute top-10 -right-32 w-24 bg-blue-600 text-white px-2 py-1 rounded text-xs font-bold shadow-lg transition-all ${temperature >= -196 ? 'opacity-100 translate-x-0' : 'opacity-50 translate-x-2'}`}>
                                                Nitrogen (N₂)
                                                <div className="text-[10px] font-mono opacity-80">-196°C</div>
                                            </div>

                                            <div className="absolute top-1/2 -right-8 w-12 h-4 bg-slate-500 border border-slate-600"></div>
                                            <div className={`absolute top-1/2 -right-32 w-24 bg-purple-600 text-white px-2 py-1 rounded text-xs font-bold shadow-lg transition-all ${temperature >= -186 ? 'opacity-100 translate-x-0' : 'opacity-50 translate-x-2'}`}>
                                                Argon (Ar)
                                                <div className="text-[10px] font-mono opacity-80">-186°C</div>
                                            </div>

                                            <div className="absolute bottom-10 -right-8 w-12 h-4 bg-slate-500 border border-slate-600"></div>
                                            <div className={`absolute bottom-10 -right-32 w-24 bg-green-600 text-white px-2 py-1 rounded text-xs font-bold shadow-lg transition-all ${temperature >= -183 ? 'opacity-100 translate-x-0' : 'opacity-50 translate-x-2'}`}>
                                                Oxygen (O₂)
                                                <div className="text-[10px] font-mono opacity-80">-183°C</div>
                                            </div>

                                            {/* Liquid/Gas Simulation */}
                                            <div className="absolute bottom-0 left-0 w-full transition-all duration-500 bg-sky-500 opacity-60 liquid-surface border-t-2 border-sky-300"
                                                 style={{ height: `${Math.max(10, 100 - ((temperature + 200) * 4))}%` }}>
                                                
                                                {/* Boiling Effect */}
                                                {isWarming && temperature >= -196 && (
                                                    <div className="absolute inset-0">
                                                        {renderBubbles()}
                                                    </div>
                                                )}
                                            </div>

                                            {/* Active Gas Indicators inside column */}
                                            {temperature >= -196 && temperature < -186 && (
                                                <div className="absolute top-16 left-1/2 -translate-x-1/2 animate-bounce">
                                                    <Icon name="ArrowUp" className="text-blue-600" />
                                                </div>
                                            )}
                                            {temperature >= -186 && temperature < -183 && (
                                                <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-bounce">
                                                    <Icon name="ArrowUp" className="text-purple-600" />
                                                </div>
                                            )}

                                        </div>
                                    </div>

                                    {/* Heat Source Control */}
                                    <div className="absolute bottom-0 w-full bg-slate-900 p-4 border-t border-slate-700 flex justify-center items-center gap-4 z-30">
                                        <button 
                                            onMouseDown={() => setIsWarming(true)}
                                            onMouseUp={() => setIsWarming(false)}
                                            onMouseLeave={() => setIsWarming(false)}
                                            onTouchStart={() => setIsWarming(true)}
                                            onTouchEnd={() => setIsWarming(false)}
                                            className={`px-8 py-3 rounded-xl font-bold text-white transition-all transform active:scale-95 select-none flex items-center gap-2 w-full max-w-xs justify-center shadow-lg
                                                ${isWarming ? 'bg-red-600 shadow-red-900/50 ring-2 ring-red-400' : 'bg-slate-700 hover:bg-slate-600'}
                                            `}
                                        >
                                            <Icon name="Flame" size={20} className={isWarming ? 'animate-pulse' : ''}/>
                                            {isWarming ? 'Warming Up...' : 'Hold to Warm'}
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Right Column: Info & Collection Status */}
                        <div className="lg:w-1/3 flex flex-col gap-4">
                            
                            {/* Concept Card */}
                            <div className="bg-slate-800 p-5 rounded-xl border border-slate-700 shadow-lg">
                                <h3 className="font-bold text-slate-200 flex items-center gap-2 mb-3">
                                    <Icon name="BookOpen" className="text-sky-400" /> Key Concept
                                </h3>
                                <p className="text-sm text-slate-400 leading-relaxed">
                                    Fractional distillation separates gases based on their <strong>Boiling Points</strong>.
                                    <br/><br/>
                                    The liquid air is warmed up slowly. The gas with the <strong>lowest boiling point</strong> (Nitrogen) boils off first and rises to the top.
                                </p>
                            </div>

                            {/* Collection Tanks */}
                            <div className="bg-slate-800 p-5 rounded-xl border border-slate-700 shadow-lg flex-grow">
                                <h3 className="font-bold text-slate-200 flex items-center gap-2 mb-4">
                                    <Icon name="Package" className="text-sky-400" /> Collection Tanks
                                </h3>

                                <div className="space-y-4">
                                    {/* Nitrogen */}
                                    <div className={`p-3 rounded-lg border transition-all ${collectedGas.nitrogen > 0 ? 'bg-blue-900/20 border-blue-500/50' : 'bg-slate-900/50 border-slate-700'}`}>
                                        <div className="flex justify-between items-center mb-2">
                                            <span className="font-bold text-blue-400">{Gases.nitrogen.name}</span>
                                            <span className="text-xs font-mono bg-slate-900 px-2 py-1 rounded border border-slate-600 text-slate-300">{Gases.nitrogen.bp}°C</span>
                                        </div>
                                        <div className="w-full bg-slate-700 h-2 rounded-full overflow-hidden mb-2">
                                            <div className="h-full bg-blue-500 transition-all duration-300" style={{width: `${collectedGas.nitrogen}%`}}></div>
                                        </div>
                                        {collectedGas.nitrogen > 0 && (
                                            <p className="text-xs text-slate-400 mt-1">Uses: {Gases.nitrogen.uses}</p>
                                        )}
                                    </div>

                                    {/* Argon */}
                                    <div className={`p-3 rounded-lg border transition-all ${collectedGas.argon > 0 ? 'bg-purple-900/20 border-purple-500/50' : 'bg-slate-900/50 border-slate-700'}`}>
                                        <div className="flex justify-between items-center mb-2">
                                            <span className="font-bold text-purple-400">{Gases.argon.name}</span>
                                            <span className="text-xs font-mono bg-slate-900 px-2 py-1 rounded border border-slate-600 text-slate-300">{Gases.argon.bp}°C</span>
                                        </div>
                                        <div className="w-full bg-slate-700 h-2 rounded-full overflow-hidden mb-2">
                                            <div className="h-full bg-purple-500 transition-all duration-300" style={{width: `${collectedGas.argon}%`}}></div>
                                        </div>
                                        {collectedGas.argon > 0 && (
                                            <p className="text-xs text-slate-400 mt-1">Uses: {Gases.argon.uses}</p>
                                        )}
                                    </div>

                                    {/* Oxygen */}
                                    <div className={`p-3 rounded-lg border transition-all ${collectedGas.oxygen > 0 ? 'bg-green-900/20 border-green-500/50' : 'bg-slate-900/50 border-slate-700'}`}>
                                        <div className="flex justify-between items-center mb-2">
                                            <span className="font-bold text-green-400">{Gases.oxygen.name}</span>
                                            <span className="text-xs font-mono bg-slate-900 px-2 py-1 rounded border border-slate-600 text-slate-300">{Gases.oxygen.bp}°C</span>
                                        </div>
                                        <div className="w-full bg-slate-700 h-2 rounded-full overflow-hidden mb-2">
                                            <div className="h-full bg-green-500 transition-all duration-300" style={{width: `${collectedGas.oxygen}%`}}></div>
                                        </div>
                                        {collectedGas.oxygen > 0 && (
                                            <p className="text-xs text-slate-400 mt-1">Uses: {Gases.oxygen.uses}</p>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div className="text-center text-slate-500 text-xs mt-8 border-t border-slate-800 pt-4">
                        Luminous Learner Science Tools
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
