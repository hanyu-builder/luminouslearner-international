<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metallic Bond Model - LuminousLearner International</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #e2e8f0; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Electron Animation */
        .electron {
            transition: transform 0.1s linear; /* Smooth movement */
        }
        
        /* Force Hit Animation */
        @keyframes hit {
            0% { transform: translateX(0); }
            50% { transform: translateX(10px) scale(0.9); }
            100% { transform: translateX(0); }
        }
        .atom-hit {
            animation: hit 0.3s ease-out;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="root" class="flex-grow flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Metal Types
        const Metals = [
            { id: 'Na', name: 'Sodium (Na)', symbol: 'Na', charge: 1, color: 'bg-gray-300', desc: 'Group 1: +1 Cation, 1 delocalized e⁻' },
            { id: 'Mg', name: 'Magnesium (Mg)', symbol: 'Mg', charge: 2, color: 'bg-gray-400', desc: 'Group 2: +2 Cation, 2 delocalized e⁻' },
            { id: 'Al', name: 'Aluminium (Al)', symbol: 'Al', charge: 3, color: 'bg-gray-500', desc: 'Group 3: +3 Cation, 3 delocalized e⁻' }
        ];

        const Icon = ({ name, size = 20, className = "" }) => {
            const [svg, setSvg] = useState('');
            useEffect(() => {
                if (window.lucide) {
                    const iconNode = window.lucide.icons[name];
                    if (iconNode) {
                        const iconSvg = window.lucide.createElement(iconNode);
                        iconSvg.setAttribute('width', size);
                        iconSvg.setAttribute('height', size);
                        iconSvg.setAttribute('class', className);
                        setSvg(iconSvg.outerHTML);
                    }
                }
            }, [name, size, className]);
            return <span dangerouslySetInnerHTML={{ __html: svg }} className="flex items-center" />;
        };

        const App = () => {
            const [currentMetal, setCurrentMetal] = useState(Metals[0]);
            const [mode, setMode] = useState('structure'); // structure, force, conduct
            const [isHammering, setIsHammering] = useState(false);
            const [isConducting, setIsConducting] = useState(false);
            
            // Simulation State
            const [cations, setCations] = useState([]);
            const [electrons, setElectrons] = useState([]);
            const containerRef = useRef(null);
            const requestRef = useRef();

            // Initialize Lattice
            useEffect(() => {
                // Create a simple grid of cations
                const rows = 3;
                const cols = 5;
                const newCations = [];
                const newElectrons = [];
                
                const spacingX = 80;
                const spacingY = 80;
                const offsetX = 50;
                const offsetY = 60;

                for (let r = 0; r < rows; r++) {
                    for (let c = 0; c < cols; c++) {
                        newCations.push({
                            id: `cat-${r}-${c}`,
                            r, c,
                            x: c * spacingX + offsetX,
                            y: r * spacingY + offsetY,
                            isShifted: false // For malleability demo
                        });

                        // Add delocalized electrons based on charge
                        for (let e = 0; e < currentMetal.charge; e++) {
                            newElectrons.push({
                                id: `elec-${r}-${c}-${e}`,
                                x: c * spacingX + offsetX + (Math.random() * 60 - 30),
                                y: r * spacingY + offsetY + (Math.random() * 60 - 30),
                                vx: Math.random() * 2 - 1,
                                vy: Math.random() * 2 - 1
                            });
                        }
                    }
                }
                setCations(newCations);
                setElectrons(newElectrons);
                setIsHammering(false); // Reset hammer state
            }, [currentMetal]);

            // Animation Loop for Electrons
            const animate = () => {
                setElectrons(prevElectrons => {
                    return prevElectrons.map(e => {
                        let nx = e.x + e.vx;
                        let ny = e.y + e.vy;

                        // Mode: Conductivity (Flow Right)
                        if (isConducting) {
                            nx += 3; // Add drift velocity
                        } else {
                            // Random movement (The "Sea")
                            // Boundary check (Bounce)
                            if (nx < 0 || nx > 450) e.vx *= -1;
                            if (ny < 0 || ny > 250) e.vy *= -1;
                        }

                        // Wrap around for conductivity
                        if (isConducting && nx > 450) nx = 0;

                        return { ...e, x: nx, y: ny };
                    });
                });
                requestRef.current = requestAnimationFrame(animate);
            };

            useEffect(() => {
                requestRef.current = requestAnimationFrame(animate);
                return () => cancelAnimationFrame(requestRef.current);
            }, [isConducting]); // Re-bind when conducting state changes

            // Handle Hammer Hit
            const handleHammer = () => {
                if (isHammering) return; // Prevent double click
                setIsHammering(true);
                
                // Shift top row
                setTimeout(() => {
                    setCations(prev => prev.map(cat => {
                        if (cat.r === 0) return { ...cat, x: cat.x + 40, isShifted: true };
                        return cat;
                    }));
                }, 300);

                // Reset
                setTimeout(() => {
                    setCations(prev => prev.map(cat => {
                        if (cat.r === 0) return { ...cat, x: cat.c * 80 + 50, isShifted: false };
                        return cat;
                    }));
                    setIsHammering(false);
                }, 2000);
            };

            const toggleConductivity = () => {
                setIsConducting(!isConducting);
            };

            return (
                <div className="flex flex-col h-full container mx-auto px-4 py-6 max-w-6xl">
                    
                    {/* Header */}
                    <div className="flex justify-between items-center mb-6 border-b border-slate-700 pb-4">
                        <div>
                            <h1 className="text-2xl font-bold text-gray-300 flex items-center gap-2">
                                <Icon name="Layers" /> Metallic Bond Simulator
                            </h1>
                            <p className="text-slate-500 text-sm">Electron Sea Model</p>
                        </div>
                        
                        <div className="flex gap-2">
                            {Metals.map(m => (
                                <button
                                    key={m.id}
                                    onClick={() => { setCurrentMetal(m); setIsConducting(false); }}
                                    className={`px-3 py-1 rounded border text-sm font-bold transition-colors
                                        ${currentMetal.id === m.id 
                                            ? 'bg-gray-200 text-slate-900 border-white' 
                                            : 'bg-slate-800 text-slate-400 border-slate-700 hover:bg-slate-700'}
                                    `}
                                >
                                    {m.name.split(' ')[0]}
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Main Stage */}
                    <div className="flex-grow flex flex-col lg:flex-row gap-8">
                        
                        {/* Visualization Area */}
                        <div className="w-full lg:w-2/3 bg-slate-800 rounded-3xl border-4 border-slate-700 relative flex flex-col items-center justify-center min-h-[500px] shadow-2xl overflow-hidden p-8" ref={containerRef}>
                            
                            {/* Background Grid */}
                            <div className="absolute inset-0 opacity-10" 
                                 style={{backgroundImage: 'radial-gradient(#94a3b8 1px, transparent 1px)', backgroundSize: '20px 20px'}}></div>

                            {/* Title Overlay */}
                            <div className="absolute top-4 left-4 bg-slate-900/80 px-3 py-1 rounded text-xs text-gray-400 border border-slate-600 z-20">
                                {isConducting ? 'Conductivity Mode' : isHammering ? 'Malleability Mode' : 'Structure Mode'}
                            </div>

                            {/* Simulation Container */}
                            <div className="relative w-[450px] h-[250px] bg-slate-900/50 rounded-xl border border-slate-600 overflow-hidden">
                                
                                {/* Electrons (The Sea) */}
                                {electrons.map(e => (
                                    <div key={e.id} 
                                         className="electron absolute w-2 h-2 bg-yellow-400 rounded-full shadow-[0_0_5px_yellow] z-10"
                                         style={{ left: e.x, top: e.y }}>
                                    </div>
                                ))}

                                {/* Cations */}
                                {cations.map(cat => (
                                    <div key={cat.id} 
                                         className={`absolute w-14 h-14 rounded-full flex items-center justify-center text-slate-900 font-bold border-2 border-white/50 z-20 transition-all duration-500 ${currentMetal.color}
                                            ${isHammering && cat.isShifted ? 'atom-hit' : ''}
                                         `}
                                         style={{ left: cat.x - 28, top: cat.y - 28 }}>
                                        {currentMetal.symbol}<sup>{currentMetal.charge}+</sup>
                                    </div>
                                ))}

                                {/* Hammer Visual */}
                                <div className={`absolute -left-20 top-0 transition-transform duration-300 z-30 ${isHammering ? 'translate-x-24 rotate-[-45deg]' : ''}`}>
                                    <Icon name="Hammer" size={64} className="text-slate-400 fill-slate-600" />
                                </div>

                                {/* Voltage Source (Conductivity) */}
                                {isConducting && (
                                    <>
                                        <div className="absolute left-0 top-0 bottom-0 w-2 bg-red-500/50 z-0 flex items-center justify-center text-white font-bold opacity-50">-</div>
                                        <div className="absolute right-0 top-0 bottom-0 w-2 bg-blue-500/50 z-0 flex items-center justify-center text-white font-bold opacity-50">+</div>
                                    </>
                                )}

                            </div>

                            {/* Interaction Controls */}
                            <div className="mt-8 flex gap-4 z-20">
                                <button 
                                    onClick={handleHammer}
                                    disabled={isConducting || isHammering}
                                    className="px-6 py-3 bg-slate-600 hover:bg-slate-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold rounded-xl shadow-lg flex items-center gap-2 transition-all active:scale-95"
                                >
                                    <Icon name="Hammer" /> Apply Force (Hit)
                                </button>
                                
                                <button 
                                    onClick={toggleConductivity}
                                    disabled={isHammering}
                                    className={`px-6 py-3 font-bold rounded-xl shadow-lg flex items-center gap-2 transition-all active:scale-95
                                        ${isConducting ? 'bg-yellow-600 text-white ring-2 ring-yellow-400' : 'bg-slate-600 hover:bg-slate-500 text-white'}
                                    `}
                                >
                                    <Icon name="Zap" className={isConducting ? 'fill-white' : ''} /> 
                                    {isConducting ? 'Power OFF' : 'Power ON'}
                                </button>
                            </div>

                        </div>

                        {/* Right: Info Panel */}
                        <div className="w-full lg:w-1/3 flex flex-col gap-6">
                            
                            <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700 shadow-lg flex-grow">
                                <h3 className="text-lg font-bold mb-4 text-white flex items-center gap-2">
                                    <Icon name="BookOpen" /> Chemistry Concepts
                                </h3>
                                
                                <div className="space-y-4 text-sm text-slate-300 leading-relaxed">
                                    
                                    {/* Concept 1: Structure */}
                                    <div className={`p-3 rounded-lg border-l-4 transition-all ${!isHammering && !isConducting ? 'bg-slate-700 border-blue-400' : 'bg-slate-900/50 border-slate-600'}`}>
                                        <strong className="text-white block mb-1">1. Electron Sea Model</strong>
                                        Metal atoms lose their valence electrons to become <span className="text-white font-bold">Cations</span>. These electrons become <span className="text-yellow-400 font-bold">Delocalized e⁻</span>, forming a "sea" that surrounds the cations.
                                    </div>
                                    
                                    {/* Concept 2: Malleability */}
                                    <div className={`p-3 rounded-lg border-l-4 transition-all ${isHammering ? 'bg-slate-700 border-orange-400' : 'bg-slate-900/50 border-slate-600'}`}>
                                        <strong className="text-white block mb-1">2. Malleability</strong>
                                        When a force is applied, layers of cations can <span className="text-orange-400 font-bold">Slide</span> over each other. Because the delocalized electrons maintain the attraction, the metal does not break.
                                    </div>

                                    {/* Concept 3: Conductivity */}
                                    <div className={`p-3 rounded-lg border-l-4 transition-all ${isConducting ? 'bg-slate-700 border-yellow-400' : 'bg-slate-900/50 border-slate-600'}`}>
                                        <strong className="text-white block mb-1">3. Conductivity</strong>
                                        Delocalized electrons are <span className="text-yellow-400 font-bold">Mobile</span>. When a voltage is applied, they flow towards the positive terminal, creating an electric current.
                                    </div>
                                    
                                    {/* Concept 4: Melting Point */}
                                    <div className="p-3 bg-slate-900/50 rounded-lg border-l-4 border-green-500 mt-4">
                                        <strong className="text-white block mb-1">4. Bond Strength</strong>
                                        Higher charge density (e.g. Al<sup>3+</sup> vs Na<sup>+</sup>) creates stronger attraction, leading to higher melting points.
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    
                    <div className="text-center text-slate-600 text-xs mt-8 border-t border-slate-800 pt-4">
                        Luminous Learner International | IB/A-Level Chemistry
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
