<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Isotope Builder Lab | Luminous Learner</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@0.263.1"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #e2e8f0; }
        .particle { transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .isotope-grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 2px; }
        .cell { width: 100%; aspect-ratio: 1; border-radius: 2px; }
    </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect, useRef, useMemo } = React;

    // --- Data ---
    const ELEMENTS = [
        { z: 0, sym: 'n', name: 'Neutron' },
        { z: 1, sym: 'H', name: 'Hydrogen' },
        { z: 2, sym: 'He', name: 'Helium' },
        { z: 3, sym: 'Li', name: 'Lithium' },
        { z: 4, sym: 'Be', name: 'Beryllium' },
        { z: 5, sym: 'B', name: 'Boron' },
        { z: 6, sym: 'C', name: 'Carbon' },
        { z: 7, sym: 'N', name: 'Nitrogen' },
        { z: 8, sym: 'O', name: 'Oxygen' },
        { z: 9, sym: 'F', name: 'Fluorine' },
        { z: 10, sym: 'Ne', name: 'Neon' }
    ];

    const STABILITY_MAP = {
        '1-0': true, '1-1': true, '1-2': false, 
        '2-1': true, '2-2': true, '2-4': false, 
        '3-3': true, '3-4': true, 
        '4-5': true, 
        '5-5': true, '5-6': true, 
        '6-6': true, '6-7': true, '6-8': false, 
        '7-7': true, '7-8': true, 
        '8-8': true, '8-9': true, '8-10': true, 
        '9-10': true, 
        '10-10': true, '10-11': true, '10-12': true 
    };

    const App = () => {
        // --- State ---
        const [protons, setProtons] = useState(3);
        const [neutrons, setNeutrons] = useState(4);
        const [particles, setParticles] = useState([]); 

        const canvasRef = useRef(null);

        // --- Logic ---
        const element = ELEMENTS[protons] || { sym: '?', name: 'Unknown' };
        const massNumber = protons + neutrons;
        const stabilityKey = `${protons}-${neutrons}`;
        const isStable = STABILITY_MAP[stabilityKey];
        
        let stabilityText = "Radioactive";
        let stabilityColor = "text-amber-500 border-amber-500/50 bg-amber-500/10";
        
        if (isStable === true) {
            stabilityText = "Stable";
            stabilityColor = "text-emerald-400 border-emerald-500/50 bg-emerald-500/10";
        } else if (isStable === undefined) {
             stabilityText = "Unstable";
             stabilityColor = "text-slate-400 border-slate-500/50 bg-slate-500/10";
        }

        // --- Visual Simulation ---
        useEffect(() => {
            const newParticles = [];
            const total = protons + neutrons;
            let pCount = 0;
            let nCount = 0;
            const phi = Math.PI * (3 - Math.sqrt(5)); 
            
            for (let i = 0; i < total; i++) {
                let type = 'n';
                if (pCount < protons && (nCount >= neutrons || Math.random() > 0.5)) {
                    type = 'p';
                    pCount++;
                } else {
                    nCount++;
                }
                
                const r = 12 * Math.sqrt(i); 
                const theta = i * phi;
                
                const x = r * Math.cos(theta);
                const y = r * Math.sin(theta);
                
                newParticles.push({
                    id: i,
                    type: type,
                    targetX: x,
                    targetY: y,
                    x: Math.random() * 20 - 10,
                    y: Math.random() * 20 - 10
                });
            }
            setParticles(newParticles);
        }, [protons, neutrons]);

        // --- Rendering ---
        const draw = () => {
            const ctx = canvasRef.current?.getContext('2d');
            if (!ctx) return;

            const w = 400;
            const h = 400;
            const cx = w / 2;
            const cy = h / 2;

            ctx.clearRect(0, 0, w, h);
            
            // Electron Cloud Hint
            const cloudRadius = 60 + (protons * 10);
            const grad = ctx.createRadialGradient(cx, cy, 20, cx, cy, cloudRadius);
            grad.addColorStop(0, 'rgba(59, 130, 246, 0.0)');
            grad.addColorStop(0.5, 'rgba(59, 130, 246, 0.05)');
            grad.addColorStop(1, 'rgba(59, 130, 246, 0.0)');
            ctx.fillStyle = grad;
            ctx.beginPath(); ctx.arc(cx, cy, cloudRadius, 0, Math.PI*2); ctx.fill();

            // Particles
            particles.forEach(p => {
                p.x += (p.targetX - p.x) * 0.1;
                p.y += (p.targetY - p.y) * 0.1;
                
                const screenX = cx + p.x;
                const screenY = cy + p.y;
                
                ctx.beginPath();
                ctx.arc(screenX, screenY, 10, 0, Math.PI*2);
                
                const pGrad = ctx.createRadialGradient(screenX - 3, screenY - 3, 2, screenX, screenY, 10);
                if (p.type === 'p') {
                    pGrad.addColorStop(0, '#f87171');
                    pGrad.addColorStop(1, '#dc2626');
                } else {
                    pGrad.addColorStop(0, '#9ca3af');
                    pGrad.addColorStop(1, '#4b5563');
                }
                
                ctx.fillStyle = pGrad;
                ctx.fill();
                ctx.strokeStyle = 'rgba(0,0,0,0.3)';
                ctx.lineWidth = 1;
                ctx.stroke();
                
                ctx.fillStyle = 'rgba(255,255,255,0.8)';
                ctx.font = '10px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(p.type === 'p' ? '+' : '', screenX, screenY + 1);
            });
            
            requestAnimationFrame(draw);
        };

        useEffect(() => {
            const anim = requestAnimationFrame(draw);
            return () => cancelAnimationFrame(anim);
        }, [particles]);

        useEffect(() => {
            if (window.lucide) window.lucide.createIcons();
        });

        // Chart Renderer
        const renderGrid = () => {
            const grid = [];
            for (let z = 10; z >= 0; z--) {
                const row = [];
                for (let n = 0; n <= 12; n++) {
                    const key = `${z}-${n}`;
                    const stable = STABILITY_MAP[key];
                    let color = 'bg-slate-800';
                    if (stable === true) color = 'bg-emerald-500';
                    else if (stable === false) color = 'bg-amber-500';
                    
                    const isCurrent = z === protons && n === neutrons;
                    const border = isCurrent ? 'border-2 border-white ring-2 ring-indigo-500 z-10 scale-125' : 'border border-slate-700/50 hover:bg-slate-700';

                    row.push(
                        <div 
                            key={key} 
                            onClick={() => { setProtons(z); setNeutrons(n); }}
                            className={`w-5 h-5 rounded-sm cursor-pointer transition-transform ${color} ${border}`}
                            title={`Z=${z}, N=${n}`}
                        ></div>
                    );
                }
                grid.push(<div key={z} className="flex gap-1">{row}</div>);
            }
            return grid;
        };

        return (
            <div className="min-h-screen bg-slate-900 text-slate-200 font-sans pb-12">
                <nav className="bg-slate-800 border-b border-slate-700 px-6 py-4 flex items-center justify-between sticky top-0 z-10">
                    <div className="flex items-center space-x-3">
                        <div className="bg-indigo-500/20 p-2 rounded-lg">
                            <i data-lucide="atom" className="w-6 h-6 text-indigo-400"></i>
                        </div>
                        <h1 className="text-xl font-bold text-white tracking-wide">Isotope Builder</h1>
                    </div>
                    <div className="text-xs text-slate-400 font-mono bg-slate-900 px-3 py-1 rounded-full border border-slate-700">
                        Topic: Atomic Physics
                    </div>
                </nav>

                <main className="max-w-6xl mx-auto p-4 md:p-6 grid grid-cols-1 lg:grid-cols-12 gap-8">
                    
                    {/* Left Column: Chart & Controls (Wider) */}
                    <div className="lg:col-span-7 flex flex-col gap-6">
                        
                        {/* 1. Chart of Nuclides */}
                        <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700">
                            <div className="flex justify-between items-center mb-4">
                                <h3 className="text-white font-bold flex items-center">
                                    <i data-lucide="grid" className="w-5 h-5 mr-2 text-indigo-400"></i>
                                    Chart of Nuclides (Z vs N)
                                </h3>
                                <div className="flex gap-4 text-xs">
                                    <div className="flex items-center gap-1.5"><div className="w-3 h-3 bg-emerald-500 rounded-sm"></div> Stable</div>
                                    <div className="flex items-center gap-1.5"><div className="w-3 h-3 bg-amber-500 rounded-sm"></div> Radioactive</div>
                                </div>
                            </div>
                            
                            <div className="bg-slate-900 p-6 rounded-xl border border-slate-700 overflow-x-auto flex justify-center">
                                <div className="flex flex-col gap-1">
                                    {renderGrid()}
                                </div>
                            </div>
                        </div>

                        {/* 2. Controls */}
                        <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700 space-y-6">
                            {/* Protons */}
                            <div className="flex items-center justify-between">
                                <div>
                                    <div className="text-xs font-bold text-red-400 uppercase">PROTONS (Z)</div>
                                    <div className="text-xs text-slate-500">Determines Element</div>
                                </div>
                                <div className="flex items-center gap-4 bg-slate-900 p-1.5 rounded-lg border border-slate-700">
                                    <button onClick={() => setProtons(Math.max(1, protons-1))} className="w-8 h-8 flex items-center justify-center bg-slate-800 rounded hover:bg-slate-700 transition-colors"><i data-lucide="minus" className="w-4 h-4"></i></button>
                                    <span className="text-2xl font-mono font-bold w-8 text-center">{protons}</span>
                                    <button onClick={() => setProtons(Math.min(10, protons+1))} className="w-8 h-8 flex items-center justify-center bg-slate-800 rounded hover:bg-slate-700 transition-colors"><i data-lucide="plus" className="w-4 h-4"></i></button>
                                </div>
                            </div>

                            {/* Neutrons */}
                            <div className="flex items-center justify-between">
                                <div>
                                    <div className="text-xs font-bold text-slate-300 uppercase">NEUTRONS (N)</div>
                                    <div className="text-xs text-slate-500">Determines Isotope</div>
                                </div>
                                <div className="flex items-center gap-4 bg-slate-900 p-1.5 rounded-lg border border-slate-700">
                                    <button onClick={() => setNeutrons(Math.max(0, neutrons-1))} className="w-8 h-8 flex items-center justify-center bg-slate-800 rounded hover:bg-slate-700 transition-colors"><i data-lucide="minus" className="w-4 h-4"></i></button>
                                    <span className="text-2xl font-mono font-bold w-8 text-center">{neutrons}</span>
                                    <button onClick={() => setNeutrons(Math.min(15, neutrons+1))} className="w-8 h-8 flex items-center justify-center bg-slate-800 rounded hover:bg-slate-700 transition-colors"><i data-lucide="plus" className="w-4 h-4"></i></button>
                                </div>
                            </div>
                        </div>

                    </div>

                    {/* Right Column: Visualizer & Info (Narrower) */}
                    <div className="lg:col-span-5 flex flex-col gap-6">
                        
                        {/* 3. Atom Visualizer */}
                        <div className="bg-slate-950 rounded-2xl border border-slate-700 p-1 shadow-2xl relative overflow-hidden flex justify-center aspect-square">
                            <canvas 
                                ref={canvasRef} 
                                width={400} 
                                height={400}
                                className="w-full h-full object-contain rounded-xl"
                            />
                            
                            <div className="absolute top-4 left-4 flex flex-col gap-2">
                                <div className="flex items-center gap-2 bg-slate-900/80 px-3 py-1.5 rounded border border-slate-700/50 backdrop-blur-sm">
                                    <span className="w-3 h-3 rounded-full bg-red-500 shadow-sm shadow-red-500/50"></span>
                                    <span className="text-xs font-bold text-slate-200">Proton (+1)</span>
                                </div>
                                <div className="flex items-center gap-2 bg-slate-900/80 px-3 py-1.5 rounded border border-slate-700/50 backdrop-blur-sm">
                                    <span className="w-3 h-3 rounded-full bg-slate-500"></span>
                                    <span className="text-xs font-bold text-slate-200">Neutron (0)</span>
                                </div>
                            </div>
                        </div>

                        {/* 4. Info Card */}
                        <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700 relative overflow-hidden flex-1">
                            <div className="absolute top-[-10px] right-[-10px] text-[10rem] font-bold font-serif opacity-5 select-none pointer-events-none text-white">
                                {element.sym}
                            </div>
                            
                            <div className="flex flex-col h-full justify-between gap-4">
                                <div className="flex items-start gap-5">
                                    <div className="bg-white text-slate-900 w-24 h-24 flex flex-col items-center justify-center rounded-lg shadow-xl relative shrink-0">
                                        <span className="absolute top-1 left-2 text-[10px] font-bold">{massNumber}</span>
                                        <span className="absolute bottom-1 left-2 text-[10px] font-bold">{protons}</span>
                                        <span className="text-4xl font-bold font-serif">{element.sym}</span>
                                    </div>
                                    <div>
                                        <h2 className="text-2xl font-bold text-white">{element.name}-{massNumber}</h2>
                                        <div className={`inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-bold border mt-2 ${stabilityColor}`}>
                                            {isStable === true ? <i data-lucide="check-circle" className="w-3 h-3"></i> : <i data-lucide="radio" className="w-3 h-3"></i>}
                                            {stabilityText}
                                        </div>
                                    </div>
                                </div>

                                <div className="grid grid-cols-2 gap-3 mt-2">
                                    <div className="bg-slate-900/50 p-3 rounded-lg border border-slate-700/50">
                                        <div className="text-slate-500 text-[10px] uppercase font-bold mb-1">Mass Number (A)</div>
                                        <div className="text-white font-mono text-lg">{massNumber}</div>
                                    </div>
                                    <div className="bg-slate-900/50 p-3 rounded-lg border border-slate-700/50">
                                        <div className="text-slate-500 text-[10px] uppercase font-bold mb-1">Net Charge</div>
                                        <div className="text-red-400 font-mono text-lg">+{protons}</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                </main>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>
</body>
</html>
