<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kepler's Third Law Lab | Luminous Learner</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@0.263.1"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #e2e8f0; }
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none; width: 20px; height: 20px;
            border-radius: 50%; background: #3b82f6; cursor: pointer; border: 3px solid #ffffff;
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
        }
        .stars-bg {
            background-image: 
                radial-gradient(1px 1px at 20px 30px, #eee, rgba(0,0,0,0)),
                radial-gradient(1px 1px at 40px 70px, #fff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 50px 160px, #ddd, rgba(0,0,0,0));
            background-size: 250px 250px;
        }
        .orbit-line {
            border: 1px dashed rgba(148, 163, 184, 0.15);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
        }
    </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect, useRef, useMemo } = React;

    const PIXELS_PER_AU = 120;
    const CANVAS_SIZE = 500;

    const App = () => {
        // --- State ---
        const [radius, setRadius] = useState(1.0); // AU
        const [timeScale, setTimeScale] = useState(1.0);
        const [angle, setAngle] = useState(0);
        const [isRunning, setIsRunning] = useState(true);
        const [dataPoints, setDataPoints] = useState([]);

        // Refs for Animation
        const requestRef = useRef();
        const lastTimeRef = useRef(Date.now());
        const paramsRef = useRef({ radius, timeScale, isRunning });

        // Sync Refs
        useEffect(() => {
            paramsRef.current = { radius, timeScale, isRunning };
        }, [radius, timeScale, isRunning]);

        // --- Physics Calculations ---
        // T^2 = r^3 => T = r^(3/2)
        const period = useMemo(() => Math.sqrt(Math.pow(radius, 3)), [radius]);
        const rCubed = useMemo(() => Math.pow(radius, 3), [radius]);
        const tSquared = useMemo(() => Math.pow(period, 2), [period]);

        // --- Animation Loop ---
        const loop = () => {
            const { radius: r, timeScale: ts, isRunning: active } = paramsRef.current;
            
            if (active) {
                const now = Date.now();
                const dt = (now - lastTimeRef.current) / 1000;
                lastTimeRef.current = now;

                // T is years. Let's say 1 second = 1 year at 1x speed
                // Angular velocity w = 2PI / T
                const currentPeriod = Math.sqrt(Math.pow(r, 3));
                const omega = (2 * Math.PI) / currentPeriod;
                
                setAngle(prev => (prev + omega * dt * ts) % (2 * Math.PI));
            } else {
                lastTimeRef.current = Date.now();
            }
            requestRef.current = requestAnimationFrame(loop);
        };

        useEffect(() => {
            requestRef.current = requestAnimationFrame(loop);
            return () => cancelAnimationFrame(requestRef.current);
        }, []);

        // --- Handlers ---
        const recordPoint = () => {
            const newPoint = { r: radius, t: period, r3: rCubed, t2: tSquared };
            // Avoid duplicate radius entries
            if (!dataPoints.find(p => p.r === radius)) {
                setDataPoints(prev => [...prev, newPoint].sort((a, b) => a.r - b.r));
            }
        };

        const clearData = () => setDataPoints([]);

        useEffect(() => {
            if (window.lucide) window.lucide.createIcons();
        });

        return (
            <div className="min-h-screen bg-slate-950 text-slate-200 font-sans pb-12 selection:bg-blue-500/30">
                {/* Navbar */}
                <nav className="bg-slate-900/80 backdrop-blur-md border-b border-slate-800 px-6 py-4 flex items-center justify-between sticky top-0 z-50">
                    <div className="flex items-center space-x-3">
                        <div className="bg-blue-600 p-2 rounded-lg shadow-lg shadow-blue-600/20">
                            <i data-lucide="orbit" className="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h1 className="text-xl font-bold text-white tracking-tight">Kepler's Third Law Lab</h1>
                            <p className="text-[10px] text-slate-400 font-mono uppercase tracking-widest">Planetary Motion Simulator</p>
                        </div>
                    </div>
                    <div className="hidden md:block text-xs text-slate-400 font-mono bg-slate-800 px-3 py-1 rounded-full border border-slate-700">
                        Topic: Celestial Mechanics
                    </div>
                </nav>

                <main className="max-w-7xl mx-auto p-4 md:p-6 grid grid-cols-1 lg:grid-cols-12 gap-8">
                    
                    {/* Left: Interactive Orrery */}
                    <div className="lg:col-span-7 flex flex-col gap-6">
                        <div className="bg-slate-900 rounded-3xl border border-slate-800 p-1 shadow-2xl relative overflow-hidden aspect-square stars-bg flex items-center justify-center">
                            
                            {/* Sun */}
                            <div className="w-14 h-14 bg-yellow-400 rounded-full shadow-[0_0_60px_rgba(250,204,21,0.5)] z-10 border-4 border-yellow-200/20 flex items-center justify-center">
                                <div className="w-full h-full rounded-full animate-pulse bg-yellow-500/30"></div>
                            </div>

                            {/* Orbit Path */}
                            <div 
                                className="orbit-line" 
                                style={{ width: radius * 2 * PIXELS_PER_AU, height: radius * 2 * PIXELS_PER_AU }}
                            ></div>

                            {/* Planet */}
                            <div 
                                className="absolute pointer-events-none"
                                style={{
                                    left: `calc(50% + ${Math.cos(angle) * radius * PIXELS_PER_AU}px)`,
                                    top: `calc(50% - ${Math.sin(angle) * radius * PIXELS_PER_AU}px)`,
                                    transform: 'translate(-50%, -50%)'
                                }}
                            >
                                <div className="w-7 h-7 bg-blue-500 rounded-full shadow-[0_0_20px_rgba(59,130,246,0.6)] border-2 border-white/20"></div>
                                <div className="absolute top-10 left-1/2 -translate-x-1/2 whitespace-nowrap bg-slate-900/80 px-2 py-0.5 rounded text-[10px] font-mono border border-white/10 text-blue-300">
                                    r = {radius.toFixed(2)} AU
                                </div>
                            </div>

                            {/* Scale Indicator */}
                            <div className="absolute bottom-6 left-6 flex items-center gap-3 text-[10px] text-slate-500 font-mono">
                                <div className="w-12 h-0.5 bg-slate-700 relative">
                                    <div className="absolute top-0 left-0 w-0.5 h-2 bg-slate-700 -translate-y-1/2"></div>
                                    <div className="absolute top-0 right-0 w-0.5 h-2 bg-slate-700 -translate-y-1/2"></div>
                                </div>
                                0.5 AU
                            </div>
                        </div>

                        {/* Controls Container */}
                        <div className="bg-slate-800/50 backdrop-blur-xl p-8 rounded-3xl border border-slate-700 shadow-xl space-y-8">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                                {/* Radius Slider */}
                                <div className="space-y-4">
                                    <div className="flex justify-between items-center">
                                        <label className="text-xs font-bold text-blue-400 uppercase tracking-widest">Orbital Radius (r)</label>
                                        <span className="text-2xl font-mono font-bold text-white">{radius.toFixed(2)} <span className="text-sm text-slate-500">AU</span></span>
                                    </div>
                                    <input 
                                        type="range" min="0.4" max="2.0" step="0.01" 
                                        value={radius} onChange={(e) => setRadius(Number(e.target.value))}
                                        className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer slider-thumb"
                                    />
                                    <div className="flex justify-between text-[10px] text-slate-500 font-mono">
                                        <span>Mercury</span>
                                        <span>Earth</span>
                                        <span>Mars+</span>
                                    </div>
                                </div>

                                {/* Speed Slider */}
                                <div className="space-y-4">
                                    <div className="flex justify-between items-center">
                                        <label className="text-xs font-bold text-emerald-400 uppercase tracking-widest">Simulation Speed</label>
                                        <span className="text-xl font-mono font-bold text-white">{timeScale.toFixed(1)}x</span>
                                    </div>
                                    <input 
                                        type="range" min="0.1" max="5.0" step="0.1" 
                                        value={timeScale} onChange={(e) => setTimeScale(Number(e.target.value))}
                                        className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer slider-thumb"
                                    />
                                </div>
                            </div>

                            <div className="flex gap-4">
                                <button 
                                    onClick={() => setIsRunning(!isRunning)}
                                    className={`flex-1 py-4 rounded-2xl font-bold text-lg flex items-center justify-center gap-3 transition-all ${isRunning ? 'bg-slate-700 text-slate-300' : 'bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-600/30'}`}
                                >
                                    <i data-lucide={isRunning ? "pause" : "play"}></i>
                                    {isRunning ? "Pause" : "Resume"}
                                </button>
                                <button 
                                    onClick={recordPoint}
                                    className="px-10 py-4 bg-emerald-600 hover:bg-emerald-500 text-white rounded-2xl font-bold flex items-center justify-center gap-2 transition-all shadow-lg shadow-emerald-600/30"
                                >
                                    <i data-lucide="plus-circle"></i>
                                    Record
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Right: Scientific Analysis */}
                    <div className="lg:col-span-5 space-y-6">
                        
                        {/* Live Telemetry Card */}
                        <div className="bg-slate-800 p-6 rounded-3xl border border-slate-700 shadow-xl overflow-hidden relative">
                            <div className="absolute top-0 right-0 p-4 opacity-5 pointer-events-none">
                                <i data-lucide="calculator" className="w-32 h-32 text-white"></i>
                            </div>
                            
                            <h2 className="text-white font-bold mb-6 flex items-center text-lg">
                                <i data-lucide="activity" className="w-5 h-5 mr-3 text-indigo-400"></i>
                                Live Telemetry
                            </h2>
                            
                            <div className="grid grid-cols-2 gap-4">
                                <div className="bg-slate-900/80 p-4 rounded-2xl border border-slate-700">
                                    <div className="text-[10px] text-slate-500 uppercase font-bold mb-1">Period (T)</div>
                                    <div className="text-2xl font-mono font-bold text-blue-400">{period.toFixed(2)} <span className="text-xs">yrs</span></div>
                                </div>
                                <div className="bg-slate-900/80 p-4 rounded-2xl border border-slate-700">
                                    <div className="text-[10px] text-slate-500 uppercase font-bold mb-1">Ratio (T² / r³)</div>
                                    <div className="text-2xl font-mono font-bold text-emerald-400">{(tSquared / rCubed).toFixed(3)}</div>
                                </div>
                            </div>
                            
                            <div className="mt-6 flex flex-col gap-3">
                                <div className="flex justify-between text-xs px-2">
                                    <span className="text-slate-400">Radius Cubed ($r^3$)</span>
                                    <span className="text-white font-mono">{rCubed.toFixed(3)}</span>
                                </div>
                                <div className="flex justify-between text-xs px-2">
                                    <span className="text-slate-400">Period Squared ($T^2$)</span>
                                    <span className="text-white font-mono">{tSquared.toFixed(3)}</span>
                                </div>
                                <div className="h-px bg-slate-700 my-1"></div>
                                <p className="text-[10px] text-slate-500 italic leading-relaxed">
                                    Observe how T² and r³ remain nearly identical. This confirms that T² ∝ r³.
                                </p>
                            </div>
                        </div>

                        {/* Data Table */}
                        <div className="bg-slate-800 p-6 rounded-3xl border border-slate-700 shadow-xl flex flex-col h-fit">
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-white font-bold flex items-center">
                                    <i data-lucide="table" className="w-5 h-5 mr-3 text-emerald-400"></i>
                                    Experimental Data
                                </h2>
                                <button onClick={clearData} className="text-[10px] text-slate-500 hover:text-red-400 font-bold flex items-center gap-1 transition-colors">
                                    <i data-lucide="trash-2" className="w-3 h-3"></i> Clear
                                </button>
                            </div>
                            
                            <div className="overflow-hidden rounded-xl border border-slate-700">
                                <table className="w-full text-xs font-mono text-left">
                                    <thead className="bg-slate-900 text-slate-400">
                                        <tr>
                                            <th className="p-3">r (AU)</th>
                                            <th className="p-3">T (yrs)</th>
                                            <th className="p-3 text-blue-400">r³</th>
                                            <th className="p-3 text-emerald-400">T²</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-slate-700">
                                        {dataPoints.map((pt, i) => (
                                            <tr key={i} className="hover:bg-slate-700/30 transition-colors">
                                                <td className="p-3 text-slate-300">{pt.r.toFixed(2)}</td>
                                                <td className="p-3 text-slate-300">{pt.t.toFixed(2)}</td>
                                                <td className="p-3 text-blue-300/80 font-bold">{pt.r3.toFixed(3)}</td>
                                                <td className="p-3 text-emerald-400/80 font-bold">{pt.t2.toFixed(3)}</td>
                                            </tr>
                                        ))}
                                        {dataPoints.length === 0 && (
                                            <tr>
                                                <td colSpan="4" className="p-8 text-center text-slate-600 italic">No points recorded. Tap "Record" to log data.</td>
                                            </tr>
                                        )}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        {/* Concept Guide */}
                        <div className="bg-gradient-to-br from-indigo-900/20 to-slate-900 p-6 rounded-3xl border border-indigo-500/20">
                            <h3 className="text-indigo-300 font-bold text-sm mb-3 flex items-center">
                                <i data-lucide="lightbulb" className="w-4 h-4 mr-2"></i> Key Insight
                            </h3>
                            <ul className="text-xs text-slate-400 space-y-4 list-disc pl-4 leading-relaxed">
                                <li>
                                    <strong className="text-slate-200">Orbital Speed:</strong> Notice that planets further from the Sun move much <strong>slower</strong> than those closer in.
                                </li>
                                <li>
                                    <strong className="text-slate-200">Harmonic Law:</strong> Kepler's 3rd law proves that planetary orbits are not random but governed by a strict mathematical harmony.
                                </li>
                                <li>
                                    <strong className="text-slate-200">Universal Scaling:</strong> If you increase radius by 4x, the time to orbit increases by 8x ($\sqrt{4^3}$).
                                </li>
                            </ul>
                        </div>
                    </div>
                </main>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>
</body>
</html>
