<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wave Motion Lab | Luminous Learner</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@0.263.1"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #e2e8f0; }
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none; width: 16px; height: 16px;
            border-radius: 50%; cursor: pointer; border: 2px solid #ffffff;
        }
        .thumb-indigo::-webkit-slider-thumb { background: #6366f1; }
        .thumb-rose::-webkit-slider-thumb { background: #f43f5e; }
    </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const CANVAS_WIDTH = 800;
    const CANVAS_HEIGHT = 200; // Height per canvas
    const PARTICLE_COUNT = 60;
    const SPACING = CANVAS_WIDTH / PARTICLE_COUNT;

    const App = () => {
        // --- State ---
        const [frequency, setFrequency] = useState(1.0); // Hz
        const [amplitude, setAmplitude] = useState(40); // Pixels
        const [isRunning, setIsRunning] = useState(false);
        const [showHighlight, setShowHighlight] = useState(true);

        const tCanvasRef = useRef(null); // Transverse
        const lCanvasRef = useRef(null); // Longitudinal
        const requestRef = useRef();
        const timeRef = useRef(0);

        // --- Logic ---
        const resetSim = () => {
            setIsRunning(false);
            cancelAnimationFrame(requestRef.current);
            timeRef.current = 0;
            draw(0);
        };

        const toggleSim = () => {
            if (isRunning) {
                setIsRunning(false);
                cancelAnimationFrame(requestRef.current);
            } else {
                setIsRunning(true);
                loop();
            }
        };

        const loop = () => {
            timeRef.current += 0.02; // Time step
            draw(timeRef.current);
            requestRef.current = requestAnimationFrame(loop);
        };

        // --- Rendering ---
        const draw = (t) => {
            drawTransverse(t);
            drawLongitudinal(t);
        };

        const drawTransverse = (t) => {
            const ctx = tCanvasRef.current?.getContext('2d');
            if (!ctx) return;

            ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
            
            // Background Line
            ctx.strokeStyle = '#334155';
            ctx.beginPath();
            ctx.moveTo(0, CANVAS_HEIGHT/2);
            ctx.lineTo(CANVAS_WIDTH, CANVAS_HEIGHT/2);
            ctx.stroke();

            // Particles
            // y = A sin(kx - wt)
            // k = 2PI / lambda. Let's fix lambda visually relative to width.
            const k = (2 * Math.PI) / 400; 
            const w = 2 * Math.PI * frequency;

            for (let i = 0; i < PARTICLE_COUNT; i++) {
                const x0 = i * SPACING + SPACING/2;
                const phase = k * x0 - w * t;
                const y = CANVAS_HEIGHT/2 + amplitude * Math.sin(phase);
                
                const isHighlight = showHighlight && i === 15; // Highlight ~1/4 way in

                ctx.beginPath();
                ctx.arc(x0, y, isHighlight ? 8 : 4, 0, Math.PI * 2);
                ctx.fillStyle = isHighlight ? '#ef4444' : '#6366f1';
                ctx.fill();

                // Draw connecting line for wave look
                if (i > 0) {
                   // Optional: draw line between particles for "string" effect
                }
            }
            
            // Draw Sine Wave Line
            ctx.beginPath();
            ctx.strokeStyle = 'rgba(99, 102, 241, 0.3)';
            ctx.lineWidth = 2;
            for(let x=0; x<CANVAS_WIDTH; x+=5) {
                const phase = k * x - w * t;
                const y = CANVAS_HEIGHT/2 + amplitude * Math.sin(phase);
                if(x===0) ctx.moveTo(x,y);
                else ctx.lineTo(x,y);
            }
            ctx.stroke();

            // Labels
            if (isRunning || t > 0) {
                 ctx.fillStyle = '#94a3b8';
                 ctx.font = '12px Inter';
                 ctx.fillText("Crest", 100 + (t*50)%400, 20); // Moving label approximation
            }
        };

        const drawLongitudinal = (t) => {
            const ctx = lCanvasRef.current?.getContext('2d');
            if (!ctx) return;

            ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

            // Particles
            // x = x0 + A sin(kx - wt)
            // Use same k and w for comparison
            const k = (2 * Math.PI) / 400; 
            const w = 2 * Math.PI * frequency;
            
            // Draw "Spring" lines or just particles? Particles is clearer for density
            // Let's draw vertical bars to represent layers of air
            
            for (let i = 0; i < PARTICLE_COUNT; i++) {
                const x0 = i * SPACING + SPACING/2;
                const phase = k * x0 - w * t;
                const displacement = amplitude * Math.sin(phase);
                const x = x0 + displacement;
                const y = CANVAS_HEIGHT/2;

                const isHighlight = showHighlight && i === 15;

                // Draw Particle
                ctx.beginPath();
                ctx.arc(x, y, isHighlight ? 8 : 4, 0, Math.PI * 2);
                ctx.fillStyle = isHighlight ? '#ef4444' : '#10b981';
                ctx.fill();

                // Draw "Air Column" effect
                ctx.fillStyle = isHighlight ? 'rgba(239, 68, 68, 0.1)' : 'rgba(16, 185, 129, 0.1)';
                ctx.fillRect(x - 2, 40, 4, CANVAS_HEIGHT - 80);
            }
        };

        useEffect(() => {
            draw(0);
            return () => cancelAnimationFrame(requestRef.current);
        }, [frequency, amplitude, showHighlight]);

        useEffect(() => {
            if (window.lucide) window.lucide.createIcons();
        });

        return (
            <div className="min-h-screen bg-slate-900 text-slate-200 font-sans pb-12">
                <nav className="bg-slate-800 border-b border-slate-700 px-6 py-4 flex items-center justify-between sticky top-0 z-10">
                    <div className="flex items-center space-x-3">
                        <div className="bg-indigo-500/20 p-2 rounded-lg">
                            <i data-lucide="waves" className="w-6 h-6 text-indigo-400"></i>
                        </div>
                        <h1 className="text-xl font-bold text-white tracking-wide">Wave Motion Lab</h1>
                    </div>
                    <div className="text-xs text-slate-400 font-mono bg-slate-900 px-3 py-1 rounded-full border border-slate-700">
                        Topic: Waves
                    </div>
                </nav>

                <main className="max-w-6xl mx-auto p-4 md:p-6 grid grid-cols-1 lg:grid-cols-12 gap-8">
                    
                    {/* Left: Simulation Canvas */}
                    <div className="lg:col-span-8 flex flex-col gap-6">
                        
                        {/* Transverse */}
                        <div className="bg-slate-800 rounded-2xl border border-slate-700 p-1 shadow-xl relative">
                            <div className="absolute top-4 left-4 bg-slate-900/80 px-3 py-1 rounded border border-slate-700 text-xs font-bold text-indigo-300">
                                Transverse Wave (e.g. Light, String)
                            </div>
                            <canvas 
                                ref={tCanvasRef} 
                                width={CANVAS_WIDTH} 
                                height={CANVAS_HEIGHT}
                                className="w-full h-auto bg-slate-950 rounded-xl border border-slate-900/50"
                            />
                            {/* Direction Indicator */}
                            <div className="absolute right-4 bottom-4 flex flex-col items-center gap-1">
                                <div className="h-8 w-px bg-indigo-500/50 relative">
                                    <div className="absolute -top-1 -left-1 w-2 h-2 border-t-2 border-l-2 border-indigo-500 rotate-45"></div>
                                    <div className="absolute -bottom-1 -left-1 w-2 h-2 border-b-2 border-r-2 border-indigo-500 rotate-45"></div>
                                </div>
                                <span className="text-[10px] text-indigo-400">Vibration</span>
                            </div>
                        </div>

                        {/* Longitudinal */}
                        <div className="bg-slate-800 rounded-2xl border border-slate-700 p-1 shadow-xl relative">
                            <div className="absolute top-4 left-4 bg-slate-900/80 px-3 py-1 rounded border border-slate-700 text-xs font-bold text-emerald-300">
                                Longitudinal Wave (e.g. Sound)
                            </div>
                            <canvas 
                                ref={lCanvasRef} 
                                width={CANVAS_WIDTH} 
                                height={CANVAS_HEIGHT}
                                className="w-full h-auto bg-slate-950 rounded-xl border border-slate-900/50"
                            />
                            {/* Direction Indicator */}
                            <div className="absolute right-4 bottom-4 flex flex-col items-center gap-1">
                                <div className="w-8 h-px bg-emerald-500/50 relative">
                                    <div className="absolute -top-1 -left-1 w-2 h-2 border-l-2 border-b-2 border-emerald-500 rotate-45"></div>
                                    <div className="absolute -top-1 -right-1 w-2 h-2 border-r-2 border-t-2 border-emerald-500 rotate-45"></div>
                                </div>
                                <span className="text-[10px] text-emerald-400">Vibration</span>
                            </div>
                        </div>

                    </div>

                    {/* Right: Controls & Guide */}
                    <div className="lg:col-span-4 space-y-6">
                        
                        <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700 space-y-6">
                            <h2 className="text-white font-bold text-sm flex items-center">
                                <i data-lucide="settings-2" className="w-4 h-4 mr-2 text-indigo-400"></i>
                                Wave Generator
                            </h2>

                            {/* Frequency */}
                            <div>
                                <label className="flex justify-between text-xs text-indigo-300 mb-2 font-bold">
                                    Frequency (f) <span className="text-white">{frequency.toFixed(1)} Hz</span>
                                </label>
                                <input 
                                    type="range" min="0.5" max="3.0" step="0.1" 
                                    value={frequency} 
                                    onChange={(e) => setFrequency(Number(e.target.value))}
                                    className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer slider-thumb thumb-indigo" 
                                />
                            </div>

                            {/* Amplitude */}
                            <div>
                                <label className="flex justify-between text-xs text-rose-300 mb-2 font-bold">
                                    Amplitude (A) <span className="text-white">{amplitude} px</span>
                                </label>
                                <input 
                                    type="range" min="10" max="80" step="5" 
                                    value={amplitude} 
                                    onChange={(e) => setAmplitude(Number(e.target.value))}
                                    className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer slider-thumb thumb-rose" 
                                />
                            </div>

                            <label className="flex items-center gap-3 cursor-pointer p-3 rounded-lg bg-slate-700/30 border border-slate-600 hover:bg-slate-700 transition-colors">
                                <input 
                                    type="checkbox" 
                                    checked={showHighlight}
                                    onChange={() => setShowHighlight(!showHighlight)}
                                    className="w-5 h-5 rounded text-indigo-600 bg-slate-800 border-slate-600 focus:ring-0"
                                />
                                <span className="text-sm font-bold text-slate-300">Highlight Single Particle</span>
                            </label>

                            <div className="grid grid-cols-2 gap-3 pt-2">
                                <button 
                                    onClick={toggleSim}
                                    className={`py-3 rounded-xl font-bold flex items-center justify-center transition-all ${isRunning ? 'bg-slate-700 text-slate-300' : 'bg-indigo-600 hover:bg-indigo-500 text-white shadow-lg'}`}
                                >
                                    <i data-lucide={isRunning ? "pause" : "play"} className="w-5 h-5 mr-2"></i>
                                    {isRunning ? 'Pause' : 'Start'}
                                </button>
                                <button 
                                    onClick={resetSim}
                                    className="py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold flex items-center justify-center transition-colors"
                                >
                                    <i data-lucide="rotate-ccw" className="w-5 h-5 mr-2"></i>
                                    Reset
                                </button>
                            </div>
                        </div>

                        {/* Analysis Box */}
                        <div className="bg-indigo-900/10 border border-indigo-500/20 p-5 rounded-2xl">
                            <h3 className="text-indigo-300 font-bold text-sm mb-3 flex items-center">
                                <i data-lucide="microscope" className="w-4 h-4 mr-2"></i> Observation
                            </h3>
                            <div className="space-y-3 text-xs text-slate-300 leading-relaxed">
                                <p>
                                    Focus on the <strong className="text-red-400">Red Particle</strong>.
                                </p>
                                <ul className="list-disc pl-4 space-y-1">
                                    <li>In the <strong>Transverse</strong> wave, it moves Up and Down.</li>
                                    <li>In the <strong>Longitudinal</strong> wave, it moves Left and Right.</li>
                                </ul>
                                <p className="pt-2 border-t border-indigo-500/30 mt-2 text-indigo-200">
                                    <strong>Key Concept:</strong> In both cases, the particle stays in the same average position. It does NOT travel with the wave!
                                </p>
                            </div>
                        </div>

                    </div>

                </main>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>
</body>
</html>
